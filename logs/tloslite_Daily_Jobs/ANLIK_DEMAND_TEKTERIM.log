NOTE: Log file opened at  Tue, 3 Nov 2020 09:00:00.603
1                                                          The SAS System                            09:00 Tuesday, November 3, 2020

ERROR: The SAS System is executing on a processor (CPU) whose model name, 
       model number, and serial number are not included in the setinit data 
       used to initialize the SAS System library in use. This is permitted if 
       this processor is a designated backup processor for a licensed CPU.
For this site, the SAS system is licensed for the following CPU serial 
numbers:
Model  **EEDPA0* Serial Number +4
ERROR: The requested node name EEDPA0 does not match the actual node name 
ERSDPA0.
NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M6) 
      Licensed to ENERJISA -TOROSLAR - DATA MANAGEMENT ADV PROD., Site 70166440.
NOTE: This session is executing on the AIX 7.2 (AIX 64) platform.



NOTE: Analytical products:
      
      SAS/STAT 15.1
      SAS/ETS 15.1

ERROR: The SAS System is executing on a processor (CPU) whose model name, model number, and serial number are not included in the 
       setinit data used to initialize the SAS System library in use. This is permitted if this processor is a designated backup 
       processor for a licensed CPU.
For this site, the SAS system is licensed for the following CPU serial numbers:

Model  **EEDPA0* Serial Number +4
ERROR: The requested node name EEDPA0 does not match the actual node name ERSDPA0.

NOTE: Additional host information:

IBM AIX AIX 64 2 7 00C9C0374C00 

You are running SAS 9. Some SAS 8 files will be automatically converted 
by the V9 engine; others are incompatible.  Please see 
http://support.sas.com/rnd/migration/planning/platform/64bit.html

PROC MIGRATE will preserve current SAS file attributes and is 
recommended for converting all your SAS libraries from any 
SAS 8 release to SAS 9.  For details and examples, please see
http://support.sas.com/rnd/migration/index.html


This message is contained in the SAS news file, and is presented upon
initialization.  Edit the file "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.




NOTE: SAS initialization used:
      real time           0.06 seconds
      cpu time            0.02 seconds
      
NOTE: This is a SPD 5.4  Engine 
      executing SAS (r) 9.4 (TS1M6) on the AIX platform.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
2                                                          The SAS System                            09:00 Tuesday, November 3, 2020

NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
3                                                          The SAS System                            09:00 Tuesday, November 3, 2020

NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
4                                                          The SAS System                            09:00 Tuesday, November 3, 2020

NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: Libref SASDATA successfully assigned from logical server.
NOTE: Libref STPSAMP successfully assigned from logical server.
NOTE: Libref MIGLIB successfully assigned from logical server.
NOTE: Libref TRNLIB2 successfully assigned from logical server.
NOTE: Libref TRNLIB successfully assigned from logical server.
NOTE: Libref NEDLIB successfully assigned from logical server.
NOTE: Libref PILIB successfully assigned from logical server.
NOTE: Libref DMLIB successfully assigned from logical server.
NOTE: Libref TMPLIB3 successfully assigned from logical server.
NOTE: Libref TMPLIB4 successfully assigned from logical server.
NOTE: Libref ODSLIB successfully assigned from logical server.
NOTE: Libref ODSLIB2 successfully assigned from logical server.
NOTE: Libref ODSLIB3 successfully assigned from logical server.
NOTE: Libref PODSLIB1 successfully assigned from logical server.
NOTE: Libref PODSLIB2 successfully assigned from logical server.
NOTE: Libref PODSLIB3 successfully assigned from logical server.
NOTE: Libref DASHLIBD successfully assigned from logical server.
NOTE: Libref QLIKLIB successfully assigned from logical server.
NOTE: Libref SQLKODA successfully assigned from logical server.
NOTE: Libref RISU successfully assigned from logical server.
NOTE: Libref DQ_ORCL successfully assigned from logical server.
NOTE: Library ZGRLIB does not exist.
NOTE: Libref HANARWP successfully assigned from logical server.
NOTE: Libref BFLIB successfully assigned from logical server.
NOTE: Libref PILIB2 successfully assigned from logical server.
NOTE: Libref TMPLIB2 successfully assigned from logical server.
NOTE: Libref DMLIB2 successfully assigned from logical server.
NOTE: Libref ARCLIB successfully assigned from logical server.
NOTE: Libref IADM successfully assigned from logical server.
NOTE: Libref IATMP successfully assigned from logical server.
NOTE: Libref AUTODIAL successfully assigned from logical server.
NOTE: Libref BCSDM successfully assigned from logical server.
NOTE: Libref BLDM successfully assigned from logical server.
NOTE: Libref BLTMP successfully assigned from logical server.
NOTE: Libref BADM successfully assigned from logical server.
NOTE: Libref BATMP successfully assigned from logical server.
NOTE: Libref CCDM successfully assigned from logical server.
NOTE: Libref CCDM2 successfully assigned from logical server.
NOTE: Libref CMPDM successfully assigned from logical server.
NOTE: Libref CPSFRC successfully assigned from logical server.
NOTE: Libref CPSHRLY successfully assigned from logical server.
NOTE: Libref CPSREG successfully assigned from logical server.
NOTE: Libref CPSUST successfully assigned from logical server.
NOTE: Libref CXDM successfully assigned from logical server.
NOTE: Libref DBALIB successfully assigned from logical server.
NOTE: Libref DSTDM successfully assigned from logical server.
NOTE: Libref DSTTMP successfully assigned from logical server.
NOTE: Libref DYMDM successfully assigned from logical server.
NOTE: Libref DYMTMP successfully assigned from logical server.
NOTE: Libref EAP_ETY successfully assigned from logical server.
NOTE: Libref EAP_PAY successfully assigned from logical server.
NOTE: Libref EAP_PR successfully assigned from logical server.
NOTE: Libref EPYDM successfully assigned from logical server.
NOTE: Libref EPYTMP successfully assigned from logical server.
5                                                          The SAS System                            09:00 Tuesday, November 3, 2020

NOTE: Libref ETSDM successfully assigned from logical server.
NOTE: Libref FADM successfully assigned from logical server.
NOTE: Libref FPCLIB successfully assigned from logical server.
NOTE: Libref FPCTMP successfully assigned from logical server.
NOTE: Libref HRDM successfully assigned from logical server.
NOTE: Libref KMHMDM successfully assigned from logical server.
NOTE: Libref CSSLIB successfully assigned from logical server.
NOTE: Libref MDLIB successfully assigned from logical server.
NOTE: Libref MHMAYEDS successfully assigned from logical server.
NOTE: Libref MHMDM successfully assigned from logical server.
NOTE: Libref MIGLIB2 successfully assigned from logical server.
NOTE: Libref MSADM successfully assigned from logical server.
NOTE: Libref MSATMP successfully assigned from logical server.
NOTE: Libref MTHEO successfully assigned from logical server.
NOTE: Libref MTHKA successfully assigned from logical server.
NOTE: Libref MTHMA successfully assigned from logical server.
NOTE: Libref MTHSO successfully assigned from logical server.
NOTE: Libref MTHTMP successfully assigned from logical server.
NOTE: Libref D2DLIB successfully assigned from logical server.
NOTE: Libref OKMDM successfully assigned from logical server.
NOTE: Libref OKMTMP successfully assigned from logical server.
NOTE: Libref PMDM successfully assigned from logical server.
NOTE: Libref CNPRCDM successfully assigned from logical server.
NOTE: Libref CNPRCTMP successfully assigned from logical server.
NOTE: Libref EDULIB successfully assigned from logical server.
NOTE: Libref PRCDM successfully assigned from logical server.
NOTE: Libref PRCDM2 successfully assigned from logical server.
NOTE: Libref PRCTMP successfully assigned from logical server.
NOTE: Libref PRFTBLIB successfully assigned from logical server.
NOTE: Libref TMPLIB successfully assigned from logical server.
NOTE: Libref FRCARC successfully assigned from logical server.
NOTE: Libref FRCPRD successfully assigned from logical server.
NOTE: Libref PRCHARC successfully assigned from logical server.
NOTE: Libref PRCHPRD successfully assigned from logical server.
NOTE: Libref PRICARC successfully assigned from logical server.
NOTE: Libref PRICPRD successfully assigned from logical server.
NOTE: Libref QL_SALES successfully assigned from logical server.
NOTE: Libref RAPOUT successfully assigned from logical server.
NOTE: Libref RAPREF successfully assigned from logical server.
NOTE: Libref RAPTEST successfully assigned from logical server.
NOTE: Libref RAPTMP successfully assigned from logical server.
NOTE: Libref RAPVAS successfully assigned from logical server.
NOTE: Libref REFCPS successfully assigned from logical server.
NOTE: Libref RMCDM successfully assigned from logical server.
NOTE: Libref RMCTMP successfully assigned from logical server.
NOTE: Libref SDLIB successfully assigned from logical server.
NOTE: Libref SOMLIB successfully assigned from logical server.
NOTE: Libref SHFDM successfully assigned from logical server.
NOTE: Libref SODM successfully assigned from logical server.
NOTE: Libref SOPDM successfully assigned from logical server.
NOTE: Libref SOSUF successfully assigned from logical server.
NOTE: Libref SOTMP successfully assigned from logical server.
NOTE: Libref SPDM successfully assigned from logical server.
NOTE: Libref SSIMDM successfully assigned from logical server.
NOTE: Libref STLF successfully assigned from logical server.
NOTE: Libref SMDM successfully assigned from logical server.
NOTE: Libref SMTMP successfully assigned from logical server.
NOTE: Libref TALDM successfully assigned from logical server.
6                                                          The SAS System                            09:00 Tuesday, November 3, 2020

NOTE: Libref TKDM successfully assigned from logical server.
NOTE: Libref TSDM successfully assigned from logical server.
NOTE: Libref QVYDM successfully assigned from logical server.
NOTE: Libref STJVYDM successfully assigned from logical server.
NOTE: Libref VYDM successfully assigned from logical server.
NOTE: Libref VYDMKVKK successfully assigned from logical server.
NOTE: Libref OGMDM successfully assigned from logical server.
NOTE: Libref OGMTMP successfully assigned from logical server.
NOTE: Libref CRLIB successfully assigned from logical server.
NOTE: Libref RASTMP successfully assigned from logical server.
NOTE: Libref SOSEC successfully assigned from logical server.
NOTE: Libref STATLIB successfully assigned from logical server.
ERROR: Libref SMARTHMP failed to assign from logical server.
ERROR: ORACLE connection error: ORA-12514: TNS: Dinleyici þu anda baðlantý açýklayýcýsýnda belirtilen hizmeti tanýmýyor..
ERROR: Libref SMARTHMT failed to assign from logical server.
ERROR: ORACLE connection error: ORA-12514: TNS: Dinleyici þu anda baðlantý açýklayýcýsýnda belirtilen hizmeti tanýmýyor..
ERROR: Libref SMSPRD failed to assign from logical server.
ERROR: ORACLE connection error: ORA-12170: TNS: Baðlantý zaman aþýmý oluþtu.
NOTE: Libref RAPARCH successfully assigned from logical server.
NOTE: Libref SAHOL successfully assigned from logical server.
NOTE: Libref MKVR successfully assigned from logical server.
NOTE: Libref RODQLIK successfully assigned from logical server.
NOTE: Libref UTFLIB successfully assigned from logical server.

NOTE: AUTOEXEC processing beginning; file is /sas/config/Lev1/SASApp/BatchServer/autoexec.sas.


NOTE: AUTOEXEC processing completed.

1          /****************************************************************************
2           * Job:             Extract RISU ANLIK_CEKIS              A57BXQB4.BT00006S *
3           * Description:                                                             *
4           *                                                                          *
5           * Metadata Server: ersupa0.enerjisa.local                                  *
6           * Port:            8561                                                    *
7           * Location:        /Data Integration/Jobs/9. Extraction_Tr/10. Master      *
8           *                   Data - RISU                                            *
9           *                                                                          *
10          * Server:          SASApp                                A57BXQB4.AS000002 *
11          *                                                                          *
12          * Source Tables:   ANLIK_DEMAND_CIFTTERIM_2016 -         A57BXQB4.BE0001H5 *
13          *                   RISU.ANLIK_DEMAND_CIFTTERIM_2016                       *
14          *                  ANLIK_DEMAND_CIFTTERIM_2017 -         A57BXQB4.BE0001H7 *
15          *                   RISU.ANLIK_DEMAND_CIFTTERIM_2017                       *
16          *                  ANLIK_DEMAND_CIFTTERIM_2018 -         A57BXQB4.BE0001H9 *
17          *                   RISU.ANLIK_DEMAND_CIFTTERIM_2018                       *
18          *                  ANLIK_DEMAND_CIFTTERIM_2019 -         A57BXQB4.BE0001HB *
19          *                   RISU.ANLIK_DEMAND_CIFTTERIM_2019                       *
20          *                  ANLIK_DEMAND_TEKTERIM_2016 -          A57BXQB4.BE0001HD *
21          *                   RISU.ANLIK_DEMAND_TEKTERIM_2016                        *
22          *                  ANLIK_DEMAND_TEKTERIM_2017 -          A57BXQB4.BE0001HF *
23          *                   RISU.ANLIK_DEMAND_TEKTERIM_2017                        *
24          *                  ANLIK_DEMAND_TEKTERIM_2018 -          A57BXQB4.BE0001HH *
25          *                   RISU.ANLIK_DEMAND_TEKTERIM_2018                        *
26          *                  ANLIK_DEMAND_TEKTERIM_2019 -          A57BXQB4.BE0001HJ *
27          *                   RISU.ANLIK_DEMAND_TEKTERIM_2019                        *
28          *                  ANLIK_DEMAND_CIFTTERIM_2019 -         A57BXQB4.BE0001HC *
29          *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019                    *
7                                                          The SAS System                            09:00 Tuesday, November 3, 2020

30          *                  ANLIK_DEMAND_CIFTTERIM_2017 -         A57BXQB4.BE0001H8 *
31          *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017                    *
32          *                  ANLIK_DEMAND_CIFTTERIM_2016 -         A57BXQB4.BE0001H6 *
33          *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016                    *
34          *                  ANLIK_DEMAND_CIFTTERIM_2018 -         A57BXQB4.BE0001HA *
35          *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018                    *
36          *                  ANLIK_DEMAND_CIFTTERIM_2020 -         A57BXQB4.BE000588 *
37          *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020                    *
38          *                  ANLIK_DEMAND_TEKTERIM_2017 -          A57BXQB4.BE0001HG *
39          *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017                     *
40          *                  ANLIK_DEMAND_TEKTERIM_2018 -          A57BXQB4.BE0001HI *
41          *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018                     *
42          *                  ANLIK_DEMAND_TEKTERIM_2019 -          A57BXQB4.BE0001HK *
43          *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019                     *
44          *                  ANLIK_DEMAND_TEKTERIM_2016 -          A57BXQB4.BE0001HE *
45          *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016                     *
46          *                  ANLIK_DEMAND_TEKTERIM_2020 -          A57BXQB4.BE000587 *
47          *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020                     *
48          *                  ANLIK_DEMAND_TEKTERIM_2020 -          A57BXQB4.BE000586 *
49          *                   RISU.ANLIK_DEMAND_TEKTERIM_2020                        *
50          *                  ANLIK_DEMAND_CIFTTERIM_2020 -         A57BXQB4.BE000585 *
51          *                   RISU.ANLIK_DEMAND_CIFTTERIM_2020                       *
52          * Target Tables:   ANLIK_DEMAND_CIFTTERIM_2016 -         A57BXQB4.BE0001H6 *
53          *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016                    *
54          *                  ANLIK_DEMAND_CIFTTERIM_2017 -         A57BXQB4.BE0001H8 *
55          *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017                    *
56          *                  ANLIK_DEMAND_CIFTTERIM_2018 -         A57BXQB4.BE0001HA *
57          *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018                    *
58          *                  ANLIK_DEMAND_CIFTTERIM_2019 -         A57BXQB4.BE0001HC *
59          *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019                    *
60          *                  ANLIK_DEMAND_TEKTERIM_2016 -          A57BXQB4.BE0001HE *
61          *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016                     *
62          *                  ANLIK_DEMAND_TEKTERIM_2017 -          A57BXQB4.BE0001HG *
63          *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017                     *
64          *                  ANLIK_DEMAND_TEKTERIM_2018 -          A57BXQB4.BE0001HI *
65          *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018                     *
66          *                  ANLIK_DEMAND_TEKTERIM_2019 -          A57BXQB4.BE0001HK *
67          *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019                     *
68          *                  ANLIK_DEMAND_TEKTERIM_2020 -          A57BXQB4.BE000587 *
69          *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020                     *
70          *                  ANLIK_DEMAND_CIFTTERIM_2020 -         A57BXQB4.BE000588 *
71          *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020                    *
72          *                                                                          *
73          * Generated on:    Tuesday, September 15, 2020 10:58:17 AM EET             *
74          * Generated by:    sas                                                     *
75          * Version:         SAS Data Integration Studio 4.904                       *
76          ****************************************************************************/
77         
78         /* Generate the process id for job  */
79         %put Process ID: &SYSJOBID;
Process ID: 1639330
80         
81         /* General macro variables  */
82         %let jobID = %quote(A57BXQB4.BT00006S);
83         %let etls_jobName = %nrquote(Extract RISU ANLIK_CEKIS);
84         %let etls_userID = %nrquote(sas);
85         
86         /* Setup to capture return codes  */
8                                                          The SAS System                            09:00 Tuesday, November 3, 2020

87         %global job_rc trans_rc sqlrc;
88         %let sysrc = 0;
89         %let job_rc = 0;
90         %let trans_rc = 0;
91         %let sqlrc = 0;
92         %global etls_stepStartTime;
93         /* initialize syserr to 0 */
94         data _null_; run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

95         
96         %macro rcSet(error);
97            %if (&error gt &trans_rc) %then
98               %let trans_rc = &error;
99            %if (&error gt &job_rc) %then
100              %let job_rc = &error;
101        %mend rcSet;
102        
103        %macro rcSetDS(error);
104           if &error gt input(symget('trans_rc'),12.) then
105              call symput('trans_rc',trim(left(put(&error,12.))));
106           if &error gt input(symget('job_rc'),12.) then
107              call symput('job_rc',trim(left(put(&error,12.))));
108        %mend rcSetDS;
109        
110        /* Create metadata macro variables */
111        %let IOMServer      = %nrquote(SASApp);
112        %let metaPort       = %nrquote(8561);
113        %let metaServer     = %nrquote(ersupa0.enerjisa.local);
114        
115        /* Setup for capturing job status  */
116        %let etls_startTime = %sysfunc(datetime(),datetime.);
117        %let etls_recordsBefore = 0;
118        %let etls_recordsAfter = 0;
119        %let etls_lib = 0;
120        %let etls_table = 0;
121        
122        %global etls_debug;
123        %macro etls_setDebug;
124           %if %str(&etls_debug) ne 0 %then
125              OPTIONS MPRINT%str(;);
126        %mend;
127        %etls_setDebug;
128        
129        /*==========================================================================*
130         * Step:            Table Loader                          A57BXQB4.BV0000VI *
131         * Transform:       Table Loader (Version 2.1)                              *
132         * Description:                                                             *
133         *                                                                          *
134         * Source Table:    ANLIK_DEMAND_CIFTTERIM_2016 -         A57BXQB4.BE0001H5 *
135         *                   RISU.ANLIK_DEMAND_CIFTTERIM_2016                       *
136         * Target Table:    ANLIK_DEMAND_CIFTTERIM_2016 -         A57BXQB4.BE0001H6 *
137         *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016                    *
138         *                                                                          *
9                                                          The SAS System                            09:00 Tuesday, November 3, 2020

139         * Warnings:                                                                *
140         * Mapping of the target column DAGITIM_BOLGESI is too short for the        *
141         *  specified source column DAGITIM_BOLGESI.  Values will be truncated.     *
142         * Mapping of the target column TAKVIM_AY_YIL is too short for the specified *
143         *  source column TAKVIM_AY_YIL.  Values will be truncated.                 *
144         * Mapping of the target column TESISAT is too short for the specified      *
145         *  source column TESISAT.  Values will be truncated.                       *
146         *==========================================================================*/
147        
148        %let transformID = %quote(A57BXQB4.BV0000VI);
149        %let trans_rc = 0;
150        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
151        
152        %let SYSLAST = %nrquote(RISU.ANLIK_DEMAND_CIFTTERIM_2016);
153        
154        %global etls_sql_pushDown;
155        %let etls_sql_pushDown = -1;
156        option DBIDIRECTEXEC;
157        
158        %global etls_tableExist;
159        %global etls_numIndex;
160        %global etls_lastTable;
161        %let etls_tableExist = -1;
162        %let etls_numIndex = -1;
163        %let etls_lastTable = &SYSLAST;
164        
165        /*---- Define load data macro  ----*/
166        
167        /* --------------------------------------------------------------
168           Load Technique Selection: Replace - EntireTable
169           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
170           Additional options selections...
171              Set unmapped to missing on updates: false
172           -------------------------------------------------------------- */
173        %macro etls_loader;
174        
175           %let etls_tableOptions = ;
176        
177           /*---- Map the columns  ----*/
178           proc datasets lib = work nolist nowarn memtype = (data view);
179              delete WJVDEZ0D;
180           quit;
181        
182           data _null_;
183              put "WARNING%QUOTE(:) Mapping of the target column TESISAT is too short"
184                   " for the specified source column TESISAT.  Values will be truncated.";
185           run;
186        
187           data _null_;
188              put "WARNING%QUOTE(:) Mapping of the target column DAGITIM_BOLGESI is too"
189                   " short for the specified source column DAGITIM_BOLGESI.  Values will"
190                   " be truncated.";
191           run;
192        
193           data _null_;
194              put "WARNING%QUOTE(:) Mapping of the target column TAKVIM_AY_YIL is too"
195                   " short for the specified source column TAKVIM_AY_YIL.  Values will"
196                   " be truncated.";
10                                                         The SAS System                            09:00 Tuesday, November 3, 2020

197           run;
198        
199           %put %str(NOTE: Mapping columns ...);
200           proc sql;
201              create view work.WJVDEZ0D as
202                 select
203                    TESISAT length = 10
204                       format = $10.,
205                    DAGITIM_BOLGESI length = 10,
206                    TAKVIM_AY_YIL length = 10,
207                    TUKETIM_P,
208                    SAYAC_CARPANI,
209                    ANLIK_DEMAND
210              from &etls_lastTable
211              ;
212           quit;
213        
214           %let SYSLAST = work.WJVDEZ0D;
215        
216           %let etls_lastTable = &SYSLAST;
217           %let etls_tableOptions = ;
218        
219           /* Determine if the target table exists  */
220           %let etls_tableExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016, DATA)) or
221                 %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016, VIEW)));
222        
223           %if &etls_tableExist %then
224           %do;/* table exists  */
225              %let etls_hasPreExistingConstraint=0;
226        
227              proc datasets lib = work nolist nowarn memtype = (data view);
228                 delete etls_commands etls_commands_F;
229              quit;
230        
231              %let etls_otherTablesReferToThisTable=0;
232        
233              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
234                 %put NOTE: Building table listing Constraints and Indexes for: &table;
235                 proc datasets lib=work nolist; delete &workTableOut; quit;
236                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
237        
238                 data &workTableOut;
239                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
240                    name = '';
241                    type = '';
242                    icown = '';
243                    idxUnique = '';
244                    idxNoMiss = '';
245                    recreate = '';
246                    set &workTableOut;
247                    ref = '';
248                    type=upcase(type);
249                    if type eq 'REFERENTIAL' then
250                    do;
251                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
252                            " another table: " ref;
253                       call symput('etls_otherTablesReferToThisTable','1');
254                       delete;
11                                                         The SAS System                            09:00 Tuesday, November 3, 2020

255                    end;
256                    if type='INDEX' and ICOwn eq 'YES' then delete;
257                 run;
258                 %rcSet(&syserr);
259        
260              %mend etls_CIContents;
261        
262              %etls_CIContents(table=TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016, workTableOut=etls_commands, inDSOptions=);
263        
264              %if &etls_otherTablesReferToThisTable %then
265                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
265      ! constraints.;
266              %else
267              %do; /* okay - remove foreign keys  */
268        
269                 data etls_commands_F;
270                    set etls_commands;
271                    if upcase(type)="FOREIGN KEY" then
272                    do;
273                       command='ic delete '||trim(name)||';';
274                       output etls_commands_F;
275                    end;
276                 run;
277        
278                 %put %str(NOTE: Removing foreign keys before dropping table...);
279                 data _null_;
280                    set etls_commands_F end=eof;
281                    if _n_=1 then
282                       call execute('proc datasets nolist lib=TMPLIB3;modify ANLIK_DEMAND_CIFTTERIM_2016;');
283                    call execute(command);
284                    if eof then call execute('; quit;');
285                 run;
286                 %rcSet(&syserr);
287        
288           %end; /* okay - remove foreign keys  */
289        
290           proc datasets lib = work nolist nowarn memtype = (data view);
291              delete etls_commands etls_commands_F;
292           quit;
293        
294           /*---- Drop a table  ----*/
295           %put %str(NOTE: Dropping table ...);
296           proc datasets lib = TMPLIB3 nolist nowarn memtype = (data view);
297              delete ANLIK_DEMAND_CIFTTERIM_2016;
298           quit;
299        
300           %rcSet(&syserr);
301        
302           %let etls_tableExist = 0;
303        
304        %end; /* table exists  */
305        
306        /*---- Create a new table  ----*/
307        %if (&etls_tableExist eq 0) %then
308        %do;  /* if table does not exist  */
309        
310           %put %str(NOTE: Creating table ...);
311        
12                                                         The SAS System                            09:00 Tuesday, November 3, 2020

312           data TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016
313                   (COMPRESS = YES);
314              attrib TESISAT length = $10
315                 format = $10.
316                 label = 'TESISAT';
317              attrib DAGITIM_BOLGESI length = $10
318                 format = $20.
319                 informat = $20.
320                 label = 'DAGITIM_BOLGESI';
321              attrib TAKVIM_AY_YIL length = $10
322                 format = $10000.
323                 informat = $10000.
324                 label = 'TAKVIM_AY_YIL';
325              attrib TUKETIM_P length = 8
326                 label = 'TUKETIM_P';
327              attrib SAYAC_CARPANI length = 8
328                 format = 14.5
329                 informat = 14.5
330                 label = 'SAYAC_CARPANI';
331              attrib ANLIK_DEMAND length = 8
332                 label = 'ANLIK_DEMAND';
333              call missing(of _all_);
334              stop;
335           run;
336        
337           %rcSet(&syserr);
338        
339        %end;  /* if table does not exist  */
340        
341        /*---- Append  ----*/
342        %put %str(NOTE: Appending data ...);
343        
344        proc append base = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016(COMPRESS = YES)
345           data = &etls_lastTable (&etls_tableOptions)  force ;
346         run;
347        
348        %rcSet(&syserr);
349        
350        proc datasets lib = work nolist nowarn memtype = (data view);
351           delete WJVDEZ0D;
352        quit;
353        
354        %mend etls_loader;
355        %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZ0D;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TESISAT is too short" " for the specified source column TESISAT.  
Values will be truncated.";
MPRINT(ETLS_LOADER):   run;

13                                                         The SAS System                            09:00 Tuesday, November 3, 2020

WARNING: Mapping of the target column TESISAT is too short for the specified source column TESISAT.  Values will be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column DAGITIM_BOLGESI is too" " short for the specified source column 
DAGITIM_BOLGESI.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column DAGITIM_BOLGESI is too short for the specified source column DAGITIM_BOLGESI.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TAKVIM_AY_YIL is too" " short for the specified source column 
TAKVIM_AY_YIL.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TAKVIM_AY_YIL is too short for the specified source column TAKVIM_AY_YIL.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Mapping columns ...
MPRINT(ETLS_LOADER):   proc sql;
MPRINT(ETLS_LOADER):   create view work.WJVDEZ0D as select TESISAT length = 10 format = $10., DAGITIM_BOLGESI length = 10, 
TAKVIM_AY_YIL length = 10, TUKETIM_P, SAYAC_CARPANI, ANLIK_DEMAND from RISU.ANLIK_DEMAND_CIFTTERIM_2016 ;
NOTE: SQL view WORK.WJVDEZ0D has been defined.
MPRINT(ETLS_LOADER):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016 (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib TESISAT length = $10 format = $10. label = 'TESISAT';
MPRINT(ETLS_LOADER):   attrib DAGITIM_BOLGESI length = $10 format = $20. informat = $20. label = 'DAGITIM_BOLGESI';
MPRINT(ETLS_LOADER):   attrib TAKVIM_AY_YIL length = $10 format = $10000. informat = $10000. label = 'TAKVIM_AY_YIL';
MPRINT(ETLS_LOADER):   attrib TUKETIM_P length = 8 label = 'TUKETIM_P';
MPRINT(ETLS_LOADER):   attrib SAYAC_CARPANI length = 8 format = 14.5 informat = 14.5 label = 'SAYAC_CARPANI';
MPRINT(ETLS_LOADER):   attrib ANLIK_DEMAND length = 8 label = 'ANLIK_DEMAND';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016 has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
14                                                         The SAS System                            09:00 Tuesday, November 3, 2020


MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016(COMPRESS = YES) data = WORK.WJVDEZ0D () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending WORK.WJVDEZ0D to TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016.
NOTE: There were 1865 observations read from the data set WORK.WJVDEZ0D.
NOTE: 1865 observations added.
NOTE: The data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016 has 1865 observations and 6 variables.
NOTE: Compressing data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016 decreased size by 13.32 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           11.04 seconds
      cpu time            0.03 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZ0D;
MPRINT(ETLS_LOADER):   quit;
NOTE: Deleting WORK.WJVDEZ0D (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

356        
357        %let etls_recCheckExist = 0;
358        %let etls_recnt = 0;
359        %macro etls_recordCheck;
360           %let etls_recCheckExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016, DATA)) or
361                 %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016, VIEW)));
362        
363           %if (&etls_recCheckExist) %then
364           %do;
365              %local etls_syntaxcheck;
366              %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
367              /* Turn off syntaxcheck option to perform following steps  */
368              options nosyntaxcheck;
369        
370              proc contents data = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016 out = work.etls_contents(keep = nobs) noprint;
371              run;
372        
373              data _null_;
374                 set work.etls_contents (obs = 1);
375                 call symput("etls_recnt", left(put(nobs,32.)));
376              run;
377        
378              proc datasets lib = work nolist nowarn memtype = (data view);
379                 delete etls_contents;
380              quit;
381        
382              /* Reset syntaxcheck option to previous setting  */
383              options &etls_syntaxcheck;
384           %end;
385        %mend etls_recordCheck;
386        %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
15                                                         The SAS System                            09:00 Tuesday, November 3, 2020

MPRINT(ETLS_RECORDCHECK):   proc contents data = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016 out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
387        
388        
389        
390        /** Step end Table Loader **/
391        
392        /*==========================================================================*
393         * Step:            Table Loader                          A57BXQB4.BV0000VJ *
394         * Transform:       Table Loader (Version 2.1)                              *
395         * Description:                                                             *
396         *                                                                          *
397         * Source Table:    ANLIK_DEMAND_CIFTTERIM_2017 -         A57BXQB4.BE0001H7 *
398         *                   RISU.ANLIK_DEMAND_CIFTTERIM_2017                       *
399         * Target Table:    ANLIK_DEMAND_CIFTTERIM_2017 -         A57BXQB4.BE0001H8 *
400         *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017                    *
401         *                                                                          *
402         * Warnings:                                                                *
403         * Mapping of the target column TESISAT is too short for the specified      *
404         *  source column TESISAT.  Values will be truncated.                       *
405         * Mapping of the target column DAGITIM_BOLGESI is too short for the        *
406         *  specified source column DAGITIM_BOLGESI.  Values will be truncated.     *
407         * Mapping of the target column TAKVIM_AY_YIL is too short for the specified *
408         *  source column TAKVIM_AY_YIL.  Values will be truncated.                 *
409         *==========================================================================*/
410        
411        %let transformID = %quote(A57BXQB4.BV0000VJ);
412        %let trans_rc = 0;
413        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
16                                                         The SAS System                            09:00 Tuesday, November 3, 2020

414        
415        %let SYSLAST = %nrquote(RISU.ANLIK_DEMAND_CIFTTERIM_2017);
416        
417        %global etls_sql_pushDown;
418        %let etls_sql_pushDown = -1;
419        option DBIDIRECTEXEC;
420        
421        %global etls_tableExist;
422        %global etls_numIndex;
423        %global etls_lastTable;
424        %let etls_tableExist = -1;
425        %let etls_numIndex = -1;
426        %let etls_lastTable = &SYSLAST;
427        
428        /*---- Define load data macro  ----*/
429        
430        /* --------------------------------------------------------------
431           Load Technique Selection: Replace - EntireTable
432           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
433           Additional options selections...
434              Set unmapped to missing on updates: false
435           -------------------------------------------------------------- */
436        %macro etls_loader;
437        
438           %let etls_tableOptions = ;
439        
440           /*---- Map the columns  ----*/
441           proc datasets lib = work nolist nowarn memtype = (data view);
442              delete WJVDEZ2D;
443           quit;
444        
445           data _null_;
446              put "WARNING%QUOTE(:) Mapping of the target column TESISAT is too short"
447                   " for the specified source column TESISAT.  Values will be truncated.";
448           run;
449        
450           data _null_;
451              put "WARNING%QUOTE(:) Mapping of the target column DAGITIM_BOLGESI is too"
452                   " short for the specified source column DAGITIM_BOLGESI.  Values will"
453                   " be truncated.";
454           run;
455        
456           data _null_;
457              put "WARNING%QUOTE(:) Mapping of the target column TAKVIM_AY_YIL is too"
458                   " short for the specified source column TAKVIM_AY_YIL.  Values will"
459                   " be truncated.";
460           run;
461        
462           %put %str(NOTE: Mapping columns ...);
463           proc sql;
464              create view work.WJVDEZ2D as
465                 select
466                    TESISAT length = 10
467                       format = $10.,
468                    DAGITIM_BOLGESI length = 10
469                       format = $10.,
470                    TAKVIM_AY_YIL length = 10
471                       format = $10.,
17                                                         The SAS System                            09:00 Tuesday, November 3, 2020

472                    TUKETIM_P,
473                    SAYAC_CARPANI,
474                    ANLIK_DEMAND
475              from &etls_lastTable
476              ;
477           quit;
478        
479           %let SYSLAST = work.WJVDEZ2D;
480        
481           %let etls_lastTable = &SYSLAST;
482           %let etls_tableOptions = ;
483        
484           /* Determine if the target table exists  */
485           %let etls_tableExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017, DATA)) or
486                 %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017, VIEW)));
487        
488           %if &etls_tableExist %then
489           %do;/* table exists  */
490              %let etls_hasPreExistingConstraint=0;
491        
492              proc datasets lib = work nolist nowarn memtype = (data view);
493                 delete etls_commands etls_commands_F;
494              quit;
495        
496              %let etls_otherTablesReferToThisTable=0;
497        
498              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
499                 %put NOTE: Building table listing Constraints and Indexes for: &table;
500                 proc datasets lib=work nolist; delete &workTableOut; quit;
501                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
502        
503                 data &workTableOut;
504                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
505                    name = '';
506                    type = '';
507                    icown = '';
508                    idxUnique = '';
509                    idxNoMiss = '';
510                    recreate = '';
511                    set &workTableOut;
512                    ref = '';
513                    type=upcase(type);
514                    if type eq 'REFERENTIAL' then
515                    do;
516                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
517                            " another table: " ref;
518                       call symput('etls_otherTablesReferToThisTable','1');
519                       delete;
520                    end;
521                    if type='INDEX' and ICOwn eq 'YES' then delete;
522                 run;
523                 %rcSet(&syserr);
524        
525              %mend etls_CIContents;
526        
527              %etls_CIContents(table=TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017, workTableOut=etls_commands, inDSOptions=);
528        
529              %if &etls_otherTablesReferToThisTable %then
18                                                         The SAS System                            09:00 Tuesday, November 3, 2020

530                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
530      ! constraints.;
531              %else
532              %do; /* okay - remove foreign keys  */
533        
534                 data etls_commands_F;
535                    set etls_commands;
536                    if upcase(type)="FOREIGN KEY" then
537                    do;
538                       command='ic delete '||trim(name)||';';
539                       output etls_commands_F;
540                    end;
541                 run;
542        
543                 %put %str(NOTE: Removing foreign keys before dropping table...);
544                 data _null_;
545                    set etls_commands_F end=eof;
546                    if _n_=1 then
547                       call execute('proc datasets nolist lib=TMPLIB3;modify ANLIK_DEMAND_CIFTTERIM_2017;');
548                    call execute(command);
549                    if eof then call execute('; quit;');
550                 run;
551                 %rcSet(&syserr);
552        
553           %end; /* okay - remove foreign keys  */
554        
555           proc datasets lib = work nolist nowarn memtype = (data view);
556              delete etls_commands etls_commands_F;
557           quit;
558        
559           /*---- Drop a table  ----*/
560           %put %str(NOTE: Dropping table ...);
561           proc datasets lib = TMPLIB3 nolist nowarn memtype = (data view);
562              delete ANLIK_DEMAND_CIFTTERIM_2017;
563           quit;
564        
565           %rcSet(&syserr);
566        
567           %let etls_tableExist = 0;
568        
569        %end; /* table exists  */
570        
571        /*---- Create a new table  ----*/
572        %if (&etls_tableExist eq 0) %then
573        %do;  /* if table does not exist  */
574        
575           %put %str(NOTE: Creating table ...);
576        
577           data TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017
578                   (COMPRESS = YES);
579              attrib TESISAT length = $10
580                 format = $10.
581                 label = 'TESISAT';
582              attrib DAGITIM_BOLGESI length = $10
583                 format = $10.
584                 label = 'DAGITIM_BOLGESI';
585              attrib TAKVIM_AY_YIL length = $10
586                 format = $10.
19                                                         The SAS System                            09:00 Tuesday, November 3, 2020

587                 label = 'TAKVIM_AY_YIL';
588              attrib TUKETIM_P length = 8
589                 label = 'TUKETIM_P';
590              attrib SAYAC_CARPANI length = 8
591                 format = 14.5
592                 informat = 14.5
593                 label = 'SAYAC_CARPANI';
594              attrib ANLIK_DEMAND length = 8
595                 label = 'ANLIK_DEMAND';
596              call missing(of _all_);
597              stop;
598           run;
599        
600           %rcSet(&syserr);
601        
602        %end;  /* if table does not exist  */
603        
604        /*---- Append  ----*/
605        %put %str(NOTE: Appending data ...);
606        
607        proc append base = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017(COMPRESS = YES)
608           data = &etls_lastTable (&etls_tableOptions)  force ;
609         run;
610        
611        %rcSet(&syserr);
612        
613        proc datasets lib = work nolist nowarn memtype = (data view);
614           delete WJVDEZ2D;
615        quit;
616        
617        %mend etls_loader;
618        %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZ2D;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TESISAT is too short" " for the specified source column TESISAT.  
Values will be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TESISAT is too short for the specified source column TESISAT.  Values will be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column DAGITIM_BOLGESI is too" " short for the specified source column 
DAGITIM_BOLGESI.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column DAGITIM_BOLGESI is too short for the specified source column DAGITIM_BOLGESI.  Values will
20                                                         The SAS System                            09:00 Tuesday, November 3, 2020

 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TAKVIM_AY_YIL is too" " short for the specified source column 
TAKVIM_AY_YIL.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TAKVIM_AY_YIL is too short for the specified source column TAKVIM_AY_YIL.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Mapping columns ...
MPRINT(ETLS_LOADER):   proc sql;
MPRINT(ETLS_LOADER):   create view work.WJVDEZ2D as select TESISAT length = 10 format = $10., DAGITIM_BOLGESI length = 10 format = 
$10., TAKVIM_AY_YIL length = 10 format = $10., TUKETIM_P, SAYAC_CARPANI, ANLIK_DEMAND from RISU.ANLIK_DEMAND_CIFTTERIM_2017 ;
NOTE: SQL view WORK.WJVDEZ2D has been defined.
MPRINT(ETLS_LOADER):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017 (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib TESISAT length = $10 format = $10. label = 'TESISAT';
MPRINT(ETLS_LOADER):   attrib DAGITIM_BOLGESI length = $10 format = $10. label = 'DAGITIM_BOLGESI';
MPRINT(ETLS_LOADER):   attrib TAKVIM_AY_YIL length = $10 format = $10. label = 'TAKVIM_AY_YIL';
MPRINT(ETLS_LOADER):   attrib TUKETIM_P length = 8 label = 'TUKETIM_P';
MPRINT(ETLS_LOADER):   attrib SAYAC_CARPANI length = 8 format = 14.5 informat = 14.5 label = 'SAYAC_CARPANI';
MPRINT(ETLS_LOADER):   attrib ANLIK_DEMAND length = 8 label = 'ANLIK_DEMAND';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017 has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017(COMPRESS = YES) data = WORK.WJVDEZ2D () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending WORK.WJVDEZ2D to TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017.
NOTE: There were 1673 observations read from the data set WORK.WJVDEZ2D.
NOTE: 1673 observations added.
NOTE: The data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017 has 1673 observations and 6 variables.
NOTE: Compressing data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017 decreased size by 12.20 percent.
NOTE: PROCEDURE APPEND used (Total process time):
21                                                         The SAS System                            09:00 Tuesday, November 3, 2020

      real time           10.05 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZ2D;
MPRINT(ETLS_LOADER):   quit;
NOTE: Deleting WORK.WJVDEZ2D (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

619        
620        %let etls_recCheckExist = 0;
621        %let etls_recnt = 0;
622        %macro etls_recordCheck;
623           %let etls_recCheckExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017, DATA)) or
624                 %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017, VIEW)));
625        
626           %if (&etls_recCheckExist) %then
627           %do;
628              %local etls_syntaxcheck;
629              %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
630              /* Turn off syntaxcheck option to perform following steps  */
631              options nosyntaxcheck;
632        
633              proc contents data = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017 out = work.etls_contents(keep = nobs) noprint;
634              run;
635        
636              data _null_;
637                 set work.etls_contents (obs = 1);
638                 call symput("etls_recnt", left(put(nobs,32.)));
639              run;
640        
641              proc datasets lib = work nolist nowarn memtype = (data view);
642                 delete etls_contents;
643              quit;
644        
645              /* Reset syntaxcheck option to previous setting  */
646              options &etls_syntaxcheck;
647           %end;
648        %mend etls_recordCheck;
649        %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017 out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
22                                                         The SAS System                            09:00 Tuesday, November 3, 2020

MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
650        
651        
652        
653        /** Step end Table Loader **/
654        
655        /*==========================================================================*
656         * Step:            Table Loader                          A57BXQB4.BV0000VK *
657         * Transform:       Table Loader (Version 2.1)                              *
658         * Description:                                                             *
659         *                                                                          *
660         * Source Table:    ANLIK_DEMAND_CIFTTERIM_2018 -         A57BXQB4.BE0001H9 *
661         *                   RISU.ANLIK_DEMAND_CIFTTERIM_2018                       *
662         * Target Table:    ANLIK_DEMAND_CIFTTERIM_2018 -         A57BXQB4.BE0001HA *
663         *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018                    *
664         *                                                                          *
665         * Warnings:                                                                *
666         * Mapping of the target column TESISAT is too short for the specified      *
667         *  source column TESISAT.  Values will be truncated.                       *
668         * Mapping of the target column DAGITIM_BOLGESI is too short for the        *
669         *  specified source column DAGITIM_BOLGESI.  Values will be truncated.     *
670         * Mapping of the target column TAKVIM_AY_YIL is too short for the specified *
671         *  source column TAKVIM_AY_YIL.  Values will be truncated.                 *
672         *==========================================================================*/
673        
674        %let transformID = %quote(A57BXQB4.BV0000VK);
675        %let trans_rc = 0;
676        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
677        
678        %let SYSLAST = %nrquote(RISU.ANLIK_DEMAND_CIFTTERIM_2018);
679        
680        %global etls_sql_pushDown;
681        %let etls_sql_pushDown = -1;
682        option DBIDIRECTEXEC;
683        
684        %global etls_tableExist;
685        %global etls_numIndex;
686        %global etls_lastTable;
687        %let etls_tableExist = -1;
688        %let etls_numIndex = -1;
23                                                         The SAS System                            09:00 Tuesday, November 3, 2020

689        %let etls_lastTable = &SYSLAST;
690        
691        /*---- Define load data macro  ----*/
692        
693        /* --------------------------------------------------------------
694           Load Technique Selection: Replace - EntireTable
695           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
696           Additional options selections...
697              Set unmapped to missing on updates: false
698           -------------------------------------------------------------- */
699        %macro etls_loader;
700        
701           %let etls_tableOptions = ;
702        
703           /*---- Map the columns  ----*/
704           proc datasets lib = work nolist nowarn memtype = (data view);
705              delete WJVDEZ3Q;
706           quit;
707        
708           data _null_;
709              put "WARNING%QUOTE(:) Mapping of the target column TESISAT is too short"
710                   " for the specified source column TESISAT.  Values will be truncated.";
711           run;
712        
713           data _null_;
714              put "WARNING%QUOTE(:) Mapping of the target column DAGITIM_BOLGESI is too"
715                   " short for the specified source column DAGITIM_BOLGESI.  Values will"
716                   " be truncated.";
717           run;
718        
719           data _null_;
720              put "WARNING%QUOTE(:) Mapping of the target column TAKVIM_AY_YIL is too"
721                   " short for the specified source column TAKVIM_AY_YIL.  Values will"
722                   " be truncated.";
723           run;
724        
725           %put %str(NOTE: Mapping columns ...);
726           proc sql;
727              create view work.WJVDEZ3Q as
728                 select
729                    TESISAT length = 10
730                       format = $10.,
731                    DAGITIM_BOLGESI length = 10
732                       format = $10.,
733                    TAKVIM_AY_YIL length = 10
734                       format = $10.,
735                    TUKETIM_P,
736                    SAYAC_CARPANI,
737                    ANLIK_DEMAND
738              from &etls_lastTable
739              ;
740           quit;
741        
742           %let SYSLAST = work.WJVDEZ3Q;
743        
744           %let etls_lastTable = &SYSLAST;
745           %let etls_tableOptions = ;
746        
24                                                         The SAS System                            09:00 Tuesday, November 3, 2020

747           /* Determine if the target table exists  */
748           %let etls_tableExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018, DATA)) or
749                 %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018, VIEW)));
750        
751           %if &etls_tableExist %then
752           %do;/* table exists  */
753              %let etls_hasPreExistingConstraint=0;
754        
755              proc datasets lib = work nolist nowarn memtype = (data view);
756                 delete etls_commands etls_commands_F;
757              quit;
758        
759              %let etls_otherTablesReferToThisTable=0;
760        
761              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
762                 %put NOTE: Building table listing Constraints and Indexes for: &table;
763                 proc datasets lib=work nolist; delete &workTableOut; quit;
764                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
765        
766                 data &workTableOut;
767                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
768                    name = '';
769                    type = '';
770                    icown = '';
771                    idxUnique = '';
772                    idxNoMiss = '';
773                    recreate = '';
774                    set &workTableOut;
775                    ref = '';
776                    type=upcase(type);
777                    if type eq 'REFERENTIAL' then
778                    do;
779                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
780                            " another table: " ref;
781                       call symput('etls_otherTablesReferToThisTable','1');
782                       delete;
783                    end;
784                    if type='INDEX' and ICOwn eq 'YES' then delete;
785                 run;
786                 %rcSet(&syserr);
787        
788              %mend etls_CIContents;
789        
790              %etls_CIContents(table=TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018, workTableOut=etls_commands, inDSOptions=);
791        
792              %if &etls_otherTablesReferToThisTable %then
793                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
793      ! constraints.;
794              %else
795              %do; /* okay - remove foreign keys  */
796        
797                 data etls_commands_F;
798                    set etls_commands;
799                    if upcase(type)="FOREIGN KEY" then
800                    do;
801                       command='ic delete '||trim(name)||';';
802                       output etls_commands_F;
803                    end;
25                                                         The SAS System                            09:00 Tuesday, November 3, 2020

804                 run;
805        
806                 %put %str(NOTE: Removing foreign keys before dropping table...);
807                 data _null_;
808                    set etls_commands_F end=eof;
809                    if _n_=1 then
810                       call execute('proc datasets nolist lib=TMPLIB3;modify ANLIK_DEMAND_CIFTTERIM_2018;');
811                    call execute(command);
812                    if eof then call execute('; quit;');
813                 run;
814                 %rcSet(&syserr);
815        
816           %end; /* okay - remove foreign keys  */
817        
818           proc datasets lib = work nolist nowarn memtype = (data view);
819              delete etls_commands etls_commands_F;
820           quit;
821        
822           /*---- Drop a table  ----*/
823           %put %str(NOTE: Dropping table ...);
824           proc datasets lib = TMPLIB3 nolist nowarn memtype = (data view);
825              delete ANLIK_DEMAND_CIFTTERIM_2018;
826           quit;
827        
828           %rcSet(&syserr);
829        
830           %let etls_tableExist = 0;
831        
832        %end; /* table exists  */
833        
834        /*---- Create a new table  ----*/
835        %if (&etls_tableExist eq 0) %then
836        %do;  /* if table does not exist  */
837        
838           %put %str(NOTE: Creating table ...);
839        
840           data TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018
841                   (COMPRESS = YES);
842              attrib TESISAT length = $10
843                 format = $10.
844                 label = 'TESISAT';
845              attrib DAGITIM_BOLGESI length = $10
846                 format = $10.
847                 label = 'DAGITIM_BOLGESI';
848              attrib TAKVIM_AY_YIL length = $10
849                 format = $10.
850                 label = 'TAKVIM_AY_YIL';
851              attrib TUKETIM_P length = 8
852                 label = 'TUKETIM_P';
853              attrib SAYAC_CARPANI length = 8
854                 format = 14.5
855                 informat = 14.5
856                 label = 'SAYAC_CARPANI';
857              attrib ANLIK_DEMAND length = 8
858                 label = 'ANLIK_DEMAND';
859              call missing(of _all_);
860              stop;
861           run;
26                                                         The SAS System                            09:00 Tuesday, November 3, 2020

862        
863           %rcSet(&syserr);
864        
865        %end;  /* if table does not exist  */
866        
867        /*---- Append  ----*/
868        %put %str(NOTE: Appending data ...);
869        
870        proc append base = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018(COMPRESS = YES)
871           data = &etls_lastTable (&etls_tableOptions)  force ;
872         run;
873        
874        %rcSet(&syserr);
875        
876        proc datasets lib = work nolist nowarn memtype = (data view);
877           delete WJVDEZ3Q;
878        quit;
879        
880        %mend etls_loader;
881        %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZ3Q;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TESISAT is too short" " for the specified source column TESISAT.  
Values will be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TESISAT is too short for the specified source column TESISAT.  Values will be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column DAGITIM_BOLGESI is too" " short for the specified source column 
DAGITIM_BOLGESI.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column DAGITIM_BOLGESI is too short for the specified source column DAGITIM_BOLGESI.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TAKVIM_AY_YIL is too" " short for the specified source column 
TAKVIM_AY_YIL.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TAKVIM_AY_YIL is too short for the specified source column TAKVIM_AY_YIL.  Values will
27                                                         The SAS System                            09:00 Tuesday, November 3, 2020

 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Mapping columns ...
MPRINT(ETLS_LOADER):   proc sql;
MPRINT(ETLS_LOADER):   create view work.WJVDEZ3Q as select TESISAT length = 10 format = $10., DAGITIM_BOLGESI length = 10 format = 
$10., TAKVIM_AY_YIL length = 10 format = $10., TUKETIM_P, SAYAC_CARPANI, ANLIK_DEMAND from RISU.ANLIK_DEMAND_CIFTTERIM_2018 ;
NOTE: SQL view WORK.WJVDEZ3Q has been defined.
MPRINT(ETLS_LOADER):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018 (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib TESISAT length = $10 format = $10. label = 'TESISAT';
MPRINT(ETLS_LOADER):   attrib DAGITIM_BOLGESI length = $10 format = $10. label = 'DAGITIM_BOLGESI';
MPRINT(ETLS_LOADER):   attrib TAKVIM_AY_YIL length = $10 format = $10. label = 'TAKVIM_AY_YIL';
MPRINT(ETLS_LOADER):   attrib TUKETIM_P length = 8 label = 'TUKETIM_P';
MPRINT(ETLS_LOADER):   attrib SAYAC_CARPANI length = 8 format = 14.5 informat = 14.5 label = 'SAYAC_CARPANI';
MPRINT(ETLS_LOADER):   attrib ANLIK_DEMAND length = 8 label = 'ANLIK_DEMAND';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018 has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018(COMPRESS = YES) data = WORK.WJVDEZ3Q () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending WORK.WJVDEZ3Q to TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018.
NOTE: There were 3116 observations read from the data set WORK.WJVDEZ3Q.
NOTE: 3116 observations added.
NOTE: The data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018 has 3116 observations and 6 variables.
NOTE: Compressing data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018 decreased size by 11.93 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           10.87 seconds
      cpu time            0.03 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZ3Q;
MPRINT(ETLS_LOADER):   quit;
NOTE: Deleting WORK.WJVDEZ3Q (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
28                                                         The SAS System                            09:00 Tuesday, November 3, 2020

      

882        
883        %let etls_recCheckExist = 0;
884        %let etls_recnt = 0;
885        %macro etls_recordCheck;
886           %let etls_recCheckExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018, DATA)) or
887                 %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018, VIEW)));
888        
889           %if (&etls_recCheckExist) %then
890           %do;
891              %local etls_syntaxcheck;
892              %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
893              /* Turn off syntaxcheck option to perform following steps  */
894              options nosyntaxcheck;
895        
896              proc contents data = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018 out = work.etls_contents(keep = nobs) noprint;
897              run;
898        
899              data _null_;
900                 set work.etls_contents (obs = 1);
901                 call symput("etls_recnt", left(put(nobs,32.)));
902              run;
903        
904              proc datasets lib = work nolist nowarn memtype = (data view);
905                 delete etls_contents;
906              quit;
907        
908              /* Reset syntaxcheck option to previous setting  */
909              options &etls_syntaxcheck;
910           %end;
911        %mend etls_recordCheck;
912        %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018 out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

29                                                         The SAS System                            09:00 Tuesday, November 3, 2020

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
913        
914        
915        
916        /** Step end Table Loader **/
917        
918        /*==========================================================================*
919         * Step:            Table Loader                          A57BXQB4.BV0000VL *
920         * Transform:       Table Loader (Version 2.1)                              *
921         * Description:                                                             *
922         *                                                                          *
923         * Source Table:    ANLIK_DEMAND_CIFTTERIM_2019 -         A57BXQB4.BE0001HB *
924         *                   RISU.ANLIK_DEMAND_CIFTTERIM_2019                       *
925         * Target Table:    ANLIK_DEMAND_CIFTTERIM_2019 -         A57BXQB4.BE0001HC *
926         *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019                    *
927         *                                                                          *
928         * Warnings:                                                                *
929         * Mapping of the target column TESISAT is too short for the specified      *
930         *  source column TESISAT.  Values will be truncated.                       *
931         * Mapping of the target column DAGITIM_BOLGESI is too short for the        *
932         *  specified source column DAGITIM_BOLGESI.  Values will be truncated.     *
933         * Mapping of the target column TAKVIM_AY_YIL is too short for the specified *
934         *  source column TAKVIM_AY_YIL.  Values will be truncated.                 *
935         *==========================================================================*/
936        
937        %let transformID = %quote(A57BXQB4.BV0000VL);
938        %let trans_rc = 0;
939        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
940        
941        %let SYSLAST = %nrquote(RISU.ANLIK_DEMAND_CIFTTERIM_2019);
942        
943        %global etls_sql_pushDown;
944        %let etls_sql_pushDown = -1;
945        option DBIDIRECTEXEC;
946        
947        %global etls_tableExist;
948        %global etls_numIndex;
949        %global etls_lastTable;
950        %let etls_tableExist = -1;
951        %let etls_numIndex = -1;
952        %let etls_lastTable = &SYSLAST;
953        
954        /*---- Define load data macro  ----*/
955        
956        /* --------------------------------------------------------------
957           Load Technique Selection: Replace - EntireTable
958           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
959           Additional options selections...
960              Set unmapped to missing on updates: false
961           -------------------------------------------------------------- */
962        %macro etls_loader;
963        
30                                                         The SAS System                            09:00 Tuesday, November 3, 2020

964           %let etls_tableOptions = ;
965        
966           /*---- Map the columns  ----*/
967           proc datasets lib = work nolist nowarn memtype = (data view);
968              delete WJVDEZ52;
969           quit;
970        
971           data _null_;
972              put "WARNING%QUOTE(:) Mapping of the target column TESISAT is too short"
973                   " for the specified source column TESISAT.  Values will be truncated.";
974           run;
975        
976           data _null_;
977              put "WARNING%QUOTE(:) Mapping of the target column DAGITIM_BOLGESI is too"
978                   " short for the specified source column DAGITIM_BOLGESI.  Values will"
979                   " be truncated.";
980           run;
981        
982           data _null_;
983              put "WARNING%QUOTE(:) Mapping of the target column TAKVIM_AY_YIL is too"
984                   " short for the specified source column TAKVIM_AY_YIL.  Values will"
985                   " be truncated.";
986           run;
987        
988           %put %str(NOTE: Mapping columns ...);
989           proc sql;
990              create view work.WJVDEZ52 as
991                 select
992                    TESISAT length = 10
993                       format = $10.,
994                    DAGITIM_BOLGESI length = 10
995                       format = $10.,
996                    TAKVIM_AY_YIL length = 10
997                       format = $10.,
998                    TUKETIM_P,
999                    SAYAC_CARPANI,
1000                   ANLIK_DEMAND
1001             from &etls_lastTable
1002             ;
1003          quit;
1004       
1005          %let SYSLAST = work.WJVDEZ52;
1006       
1007          %let etls_lastTable = &SYSLAST;
1008          %let etls_tableOptions = ;
1009       
1010          /* Determine if the target table exists  */
1011          %let etls_tableExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019, DATA)) or
1012                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019, VIEW)));
1013       
1014          %if &etls_tableExist %then
1015          %do;/* table exists  */
1016             %let etls_hasPreExistingConstraint=0;
1017       
1018             proc datasets lib = work nolist nowarn memtype = (data view);
1019                delete etls_commands etls_commands_F;
1020             quit;
1021       
31                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1022             %let etls_otherTablesReferToThisTable=0;
1023       
1024             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1025                %put NOTE: Building table listing Constraints and Indexes for: &table;
1026                proc datasets lib=work nolist; delete &workTableOut; quit;
1027                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1028       
1029                data &workTableOut;
1030                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1031                   name = '';
1032                   type = '';
1033                   icown = '';
1034                   idxUnique = '';
1035                   idxNoMiss = '';
1036                   recreate = '';
1037                   set &workTableOut;
1038                   ref = '';
1039                   type=upcase(type);
1040                   if type eq 'REFERENTIAL' then
1041                   do;
1042                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1043                           " another table: " ref;
1044                      call symput('etls_otherTablesReferToThisTable','1');
1045                      delete;
1046                   end;
1047                   if type='INDEX' and ICOwn eq 'YES' then delete;
1048                run;
1049                %rcSet(&syserr);
1050       
1051             %mend etls_CIContents;
1052       
1053             %etls_CIContents(table=TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019, workTableOut=etls_commands, inDSOptions=);
1054       
1055             %if &etls_otherTablesReferToThisTable %then
1056                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1056     ! constraints.;
1057             %else
1058             %do; /* okay - remove foreign keys  */
1059       
1060                data etls_commands_F;
1061                   set etls_commands;
1062                   if upcase(type)="FOREIGN KEY" then
1063                   do;
1064                      command='ic delete '||trim(name)||';';
1065                      output etls_commands_F;
1066                   end;
1067                run;
1068       
1069                %put %str(NOTE: Removing foreign keys before dropping table...);
1070                data _null_;
1071                   set etls_commands_F end=eof;
1072                   if _n_=1 then
1073                      call execute('proc datasets nolist lib=TMPLIB3;modify ANLIK_DEMAND_CIFTTERIM_2019;');
1074                   call execute(command);
1075                   if eof then call execute('; quit;');
1076                run;
1077                %rcSet(&syserr);
1078       
32                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1079          %end; /* okay - remove foreign keys  */
1080       
1081          proc datasets lib = work nolist nowarn memtype = (data view);
1082             delete etls_commands etls_commands_F;
1083          quit;
1084       
1085          /*---- Drop a table  ----*/
1086          %put %str(NOTE: Dropping table ...);
1087          proc datasets lib = TMPLIB3 nolist nowarn memtype = (data view);
1088             delete ANLIK_DEMAND_CIFTTERIM_2019;
1089          quit;
1090       
1091          %rcSet(&syserr);
1092       
1093          %let etls_tableExist = 0;
1094       
1095       %end; /* table exists  */
1096       
1097       /*---- Create a new table  ----*/
1098       %if (&etls_tableExist eq 0) %then
1099       %do;  /* if table does not exist  */
1100       
1101          %put %str(NOTE: Creating table ...);
1102       
1103          data TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019
1104                  (COMPRESS = YES);
1105             attrib TESISAT length = $10
1106                format = $10.
1107                label = 'TESISAT';
1108             attrib DAGITIM_BOLGESI length = $10
1109                format = $10.
1110                label = 'DAGITIM_BOLGESI';
1111             attrib TAKVIM_AY_YIL length = $10
1112                format = $10.
1113                label = 'TAKVIM_AY_YIL';
1114             attrib TUKETIM_P length = 8
1115                label = 'TUKETIM_P';
1116             attrib SAYAC_CARPANI length = 8
1117                format = 14.5
1118                informat = 14.5
1119                label = 'SAYAC_CARPANI';
1120             attrib ANLIK_DEMAND length = 8
1121                label = 'ANLIK_DEMAND';
1122             call missing(of _all_);
1123             stop;
1124          run;
1125       
1126          %rcSet(&syserr);
1127       
1128       %end;  /* if table does not exist  */
1129       
1130       /*---- Append  ----*/
1131       %put %str(NOTE: Appending data ...);
1132       
1133       proc append base = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019(COMPRESS = YES)
1134          data = &etls_lastTable (&etls_tableOptions)  force ;
1135        run;
1136       
33                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1137       %rcSet(&syserr);
1138       
1139       proc datasets lib = work nolist nowarn memtype = (data view);
1140          delete WJVDEZ52;
1141       quit;
1142       
1143       %mend etls_loader;
1144       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZ52;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TESISAT is too short" " for the specified source column TESISAT.  
Values will be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TESISAT is too short for the specified source column TESISAT.  Values will be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column DAGITIM_BOLGESI is too" " short for the specified source column 
DAGITIM_BOLGESI.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column DAGITIM_BOLGESI is too short for the specified source column DAGITIM_BOLGESI.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TAKVIM_AY_YIL is too" " short for the specified source column 
TAKVIM_AY_YIL.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TAKVIM_AY_YIL is too short for the specified source column TAKVIM_AY_YIL.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Mapping columns ...
MPRINT(ETLS_LOADER):   proc sql;
MPRINT(ETLS_LOADER):   create view work.WJVDEZ52 as select TESISAT length = 10 format = $10., DAGITIM_BOLGESI length = 10 format = 
$10., TAKVIM_AY_YIL length = 10 format = $10., TUKETIM_P, SAYAC_CARPANI, ANLIK_DEMAND from RISU.ANLIK_DEMAND_CIFTTERIM_2019 ;
NOTE: SQL view WORK.WJVDEZ52 has been defined.
MPRINT(ETLS_LOADER):   quit;
34                                                         The SAS System                            09:00 Tuesday, November 3, 2020

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019 (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib TESISAT length = $10 format = $10. label = 'TESISAT';
MPRINT(ETLS_LOADER):   attrib DAGITIM_BOLGESI length = $10 format = $10. label = 'DAGITIM_BOLGESI';
MPRINT(ETLS_LOADER):   attrib TAKVIM_AY_YIL length = $10 format = $10. label = 'TAKVIM_AY_YIL';
MPRINT(ETLS_LOADER):   attrib TUKETIM_P length = 8 label = 'TUKETIM_P';
MPRINT(ETLS_LOADER):   attrib SAYAC_CARPANI length = 8 format = 14.5 informat = 14.5 label = 'SAYAC_CARPANI';
MPRINT(ETLS_LOADER):   attrib ANLIK_DEMAND length = 8 label = 'ANLIK_DEMAND';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019 has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019(COMPRESS = YES) data = WORK.WJVDEZ52 () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending WORK.WJVDEZ52 to TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019.
NOTE: There were 2712 observations read from the data set WORK.WJVDEZ52.
NOTE: 2712 observations added.
NOTE: The data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019 has 2712 observations and 6 variables.
NOTE: Compressing data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019 decreased size by 11.87 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           12.05 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZ52;
MPRINT(ETLS_LOADER):   quit;
NOTE: Deleting WORK.WJVDEZ52 (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1145       
1146       %let etls_recCheckExist = 0;
1147       %let etls_recnt = 0;
1148       %macro etls_recordCheck;
1149          %let etls_recCheckExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019, DATA)) or
1150                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019, VIEW)));
1151       
1152          %if (&etls_recCheckExist) %then
1153          %do;
1154             %local etls_syntaxcheck;
35                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1155             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1156             /* Turn off syntaxcheck option to perform following steps  */
1157             options nosyntaxcheck;
1158       
1159             proc contents data = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019 out = work.etls_contents(keep = nobs) noprint;
1160             run;
1161       
1162             data _null_;
1163                set work.etls_contents (obs = 1);
1164                call symput("etls_recnt", left(put(nobs,32.)));
1165             run;
1166       
1167             proc datasets lib = work nolist nowarn memtype = (data view);
1168                delete etls_contents;
1169             quit;
1170       
1171             /* Reset syntaxcheck option to previous setting  */
1172             options &etls_syntaxcheck;
1173          %end;
1174       %mend etls_recordCheck;
1175       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019 out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1176       
1177       
1178       
1179       /** Step end Table Loader **/
1180       
36                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1181       /*==========================================================================*
1182        * Step:            Table Loader                          A57BXQB4.BV0003QK *
1183        * Transform:       Table Loader (Version 2.1)                              *
1184        * Description:                                                             *
1185        *                                                                          *
1186        * Source Table:    ANLIK_DEMAND_CIFTTERIM_2020 -         A57BXQB4.BE000585 *
1187        *                   RISU.ANLIK_DEMAND_CIFTTERIM_2020                       *
1188        * Target Table:    ANLIK_DEMAND_CIFTTERIM_2020 -         A57BXQB4.BE000588 *
1189        *                   TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020                    *
1190        *==========================================================================*/
1191       
1192       %let transformID = %quote(A57BXQB4.BV0003QK);
1193       %let trans_rc = 0;
1194       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1195       
1196       %let SYSLAST = %nrquote(RISU.ANLIK_DEMAND_CIFTTERIM_2020);
1197       
1198       %global etls_sql_pushDown;
1199       %let etls_sql_pushDown = -1;
1200       option DBIDIRECTEXEC;
1201       
1202       %global etls_tableExist;
1203       %global etls_numIndex;
1204       %global etls_lastTable;
1205       %let etls_tableExist = -1;
1206       %let etls_numIndex = -1;
1207       %let etls_lastTable = &SYSLAST;
1208       
1209       /*---- Define load data macro  ----*/
1210       
1211       /* --------------------------------------------------------------
1212          Load Technique Selection: Replace - EntireTable
1213          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1214          Additional options selections...
1215             Set unmapped to missing on updates: false
1216          -------------------------------------------------------------- */
1217       %macro etls_loader;
1218       
1219          %let etls_tableOptions = ;
1220       
1221          /* Determine if the target table exists  */
1222          %let etls_tableExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020, DATA)) or
1223                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020, VIEW)));
1224       
1225          %if &etls_tableExist %then
1226          %do;/* table exists  */
1227             %let etls_hasPreExistingConstraint=0;
1228       
1229             proc datasets lib = work nolist nowarn memtype = (data view);
1230                delete etls_commands etls_commands_F;
1231             quit;
1232       
1233             %let etls_otherTablesReferToThisTable=0;
1234       
1235             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1236                %put NOTE: Building table listing Constraints and Indexes for: &table;
1237                proc datasets lib=work nolist; delete &workTableOut; quit;
1238                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
37                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1239       
1240                data &workTableOut;
1241                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1242                   name = '';
1243                   type = '';
1244                   icown = '';
1245                   idxUnique = '';
1246                   idxNoMiss = '';
1247                   recreate = '';
1248                   set &workTableOut;
1249                   ref = '';
1250                   type=upcase(type);
1251                   if type eq 'REFERENTIAL' then
1252                   do;
1253                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1254                           " another table: " ref;
1255                      call symput('etls_otherTablesReferToThisTable','1');
1256                      delete;
1257                   end;
1258                   if type='INDEX' and ICOwn eq 'YES' then delete;
1259                run;
1260                %rcSet(&syserr);
1261       
1262             %mend etls_CIContents;
1263       
1264             %etls_CIContents(table=TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020, workTableOut=etls_commands, inDSOptions=);
1265       
1266             %if &etls_otherTablesReferToThisTable %then
1267                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1267     ! constraints.;
1268             %else
1269             %do; /* okay - remove foreign keys  */
1270       
1271                data etls_commands_F;
1272                   set etls_commands;
1273                   if upcase(type)="FOREIGN KEY" then
1274                   do;
1275                      command='ic delete '||trim(name)||';';
1276                      output etls_commands_F;
1277                   end;
1278                run;
1279       
1280                %put %str(NOTE: Removing foreign keys before dropping table...);
1281                data _null_;
1282                   set etls_commands_F end=eof;
1283                   if _n_=1 then
1284                      call execute('proc datasets nolist lib=TMPLIB3;modify ANLIK_DEMAND_CIFTTERIM_2020;');
1285                   call execute(command);
1286                   if eof then call execute('; quit;');
1287                run;
1288                %rcSet(&syserr);
1289       
1290          %end; /* okay - remove foreign keys  */
1291       
1292          proc datasets lib = work nolist nowarn memtype = (data view);
1293             delete etls_commands etls_commands_F;
1294          quit;
1295       
38                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1296          /*---- Drop a table  ----*/
1297          %put %str(NOTE: Dropping table ...);
1298          proc datasets lib = TMPLIB3 nolist nowarn memtype = (data view);
1299             delete ANLIK_DEMAND_CIFTTERIM_2020;
1300          quit;
1301       
1302          %rcSet(&syserr);
1303       
1304          %let etls_tableExist = 0;
1305       
1306       %end; /* table exists  */
1307       
1308       /*---- Create a new table  ----*/
1309       %if (&etls_tableExist eq 0) %then
1310       %do;  /* if table does not exist  */
1311       
1312          %put %str(NOTE: Creating table ...);
1313       
1314          data TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020
1315                  (COMPRESS = YES);
1316             attrib TESISAT length = $20
1317                format = $20.
1318                informat = $20.
1319                label = 'TESISAT';
1320             attrib DAGITIM_BOLGESI length = $20
1321                format = $20.
1322                informat = $20.
1323                label = 'DAGITIM_BOLGESI';
1324             attrib TAKVIM_AY_YIL length = $14
1325                format = $14.
1326                informat = $14.
1327                label = 'TAKVIM_AY_YIL';
1328             attrib TUKETIM_P length = 8
1329                label = 'TUKETIM_P';
1330             attrib SAYAC_CARPANI length = 8
1331                format = 14.5
1332                informat = 14.5
1333                label = 'SAYAC_CARPANI';
1334             attrib ANLIK_DEMAND length = 8
1335                label = 'ANLIK_DEMAND';
1336             call missing(of _all_);
1337             stop;
1338          run;
1339       
1340          %rcSet(&syserr);
1341       
1342       %end;  /* if table does not exist  */
1343       
1344       /*---- Append  ----*/
1345       %put %str(NOTE: Appending data ...);
1346       
1347       proc append base = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020(COMPRESS = YES)
1348          data = &etls_lastTable (&etls_tableOptions)  force ;
1349        run;
1350       
1351       %rcSet(&syserr);
1352       
1353       %mend etls_loader;
39                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1354       %etls_loader;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020 (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib TESISAT length = $20 format = $20. informat = $20. label = 'TESISAT';
MPRINT(ETLS_LOADER):   attrib DAGITIM_BOLGESI length = $20 format = $20. informat = $20. label = 'DAGITIM_BOLGESI';
MPRINT(ETLS_LOADER):   attrib TAKVIM_AY_YIL length = $14 format = $14. informat = $14. label = 'TAKVIM_AY_YIL';
MPRINT(ETLS_LOADER):   attrib TUKETIM_P length = 8 label = 'TUKETIM_P';
MPRINT(ETLS_LOADER):   attrib SAYAC_CARPANI length = 8 format = 14.5 informat = 14.5 label = 'SAYAC_CARPANI';
MPRINT(ETLS_LOADER):   attrib ANLIK_DEMAND length = 8 label = 'ANLIK_DEMAND';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020 has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020(COMPRESS = YES) data = 
RISU.ANLIK_DEMAND_CIFTTERIM_2020 () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending RISU.ANLIK_DEMAND_CIFTTERIM_2020 to TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020.
NOTE: There were 7596 observations read from the data set RISU.ANLIK_DEMAND_CIFTTERIM_2020.
NOTE: 7596 observations added.
NOTE: The data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020 has 7596 observations and 6 variables.
NOTE: Compressing data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020 decreased size by 36.71 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           11.98 seconds
      cpu time            0.03 seconds
      

MPRINT(ETLS_LOADER):  ;
1355       
1356       %let etls_recCheckExist = 0;
1357       %let etls_recnt = 0;
1358       %macro etls_recordCheck;
1359          %let etls_recCheckExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020, DATA)) or
1360                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020, VIEW)));
1361       
1362          %if (&etls_recCheckExist) %then
1363          %do;
1364             %local etls_syntaxcheck;
1365             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1366             /* Turn off syntaxcheck option to perform following steps  */
1367             options nosyntaxcheck;
1368       
1369             proc contents data = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020 out = work.etls_contents(keep = nobs) noprint;
1370             run;
1371       
1372             data _null_;
1373                set work.etls_contents (obs = 1);
1374                call symput("etls_recnt", left(put(nobs,32.)));
1375             run;
1376       
40                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1377             proc datasets lib = work nolist nowarn memtype = (data view);
1378                delete etls_contents;
1379             quit;
1380       
1381             /* Reset syntaxcheck option to previous setting  */
1382             options &etls_syntaxcheck;
1383          %end;
1384       %mend etls_recordCheck;
1385       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020 out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1386       
1387       
1388       
1389       /** Step end Table Loader **/
1390       
1391       /*---- Start of User Written Code  ----*/
1392       
1393       PROC SQL;
1394       CREATE TABLE TMPLIB3.ANLIK_DEMAND_CIFTTERIM AS
1395       SELECT * FROM TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016
1396       UNION ALL
1397       SELECT * FROM TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017
1398       UNION ALL
1399       SELECT * FROM TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018
1400       UNION ALL
1401       SELECT * FROM TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019
1402       UNION ALL
41                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1403       SELECT * FROM TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020
1404       ;
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: Physical Name: TMPLIB3
 SPDS_NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4  Server at 10.166.0.39.
 SPDS_NOTE: Libref X0000001 was successfully assigned as follows: 
            Engine:        SPDSENG 
            Physical Name: :15729022/spdsmeta1/TMPLIB3/

 SPDS_NOTE: Libref TMPLIB3 was successfully assigned as follows: 
            Engine:        SPDSENG 
            Physical Name: :15729022/spdsmeta1/TMPLIB3/

NOTE: Implicit SQL: CREATE TABLE TMPLIB3.ANLIK_DEMAND_CIFTTERIM as  select * from (  select * from (  select * from ( select 
      TXT_1.TESISAT, TXT_1.DAGITIM_BOLGESI, TXT_1.TAKVIM_AY_YIL, TXT_1.TUKETIM_P, TXT_1.SAYAC_CARPANI, TXT_1.ANLIK_DEMAND from 
      ANLIK_DEMAND_CIFTTERIM_2016 TXT_1 union all select TXT_2.TESISAT, TXT_2.DAGITIM_BOLGESI, TXT_2.TAKVIM_AY_YIL, 
      TXT_2.TUKETIM_P, TXT_2.SAYAC_CARPANI, TXT_2.ANLIK_DEMAND from ANLIK_DEMAND_CIFTTERIM_2017 TXT_2 ) TXT_0  union all select 
      TXT_3.TESISAT, TXT_3.DAGITIM_BOLGESI, TXT_3.TAKVIM_AY_YIL, TXT_3.TUKETIM_P, TXT_3.SAYAC_CARPANI, TXT_3.ANLIK_DEMAND from 
      ANLIK_DEMAND_CIFTTERIM_2018 TXT_3 ) TXT_0  union all select TXT_4.TESISAT, TXT_4.DAGITIM_BOLGESI, TXT_4.TAKVIM_AY_YIL, 
      TXT_4.TUKETIM_P, TXT_4.SAYAC_CARPANI, TXT_4.ANLIK_DEMAND from ANLIK_DEMAND_CIFTTERIM_2019 TXT_4 ) TXT_0  union all select 
      TXT_5.TESISAT, TXT_5.DAGITIM_BOLGESI, TXT_5.TAKVIM_AY_YIL, TXT_5.TUKETIM_P, TXT_5.SAYAC_CARPANI, TXT_5.ANLIK_DEMAND from 
      ANLIK_DEMAND_CIFTTERIM_2020 TXT_5
 SPDS_NOTE: Table TMPLIB3.ANLIK_DEMAND_CIFTTERIM created, with 16962 rows and 6 columns.

1405       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.74 seconds
      cpu time            0.00 seconds
      

1406       
1407       proc sql;
1408       drop table TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016;
NOTE: Table TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2016 has been dropped.
1409       drop table TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017;
NOTE: Table TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2017 has been dropped.
1410       drop table TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018;
NOTE: Table TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2018 has been dropped.
1411       drop table TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019;
NOTE: Table TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2019 has been dropped.
1412       drop table TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020;
NOTE: Table TMPLIB3.ANLIK_DEMAND_CIFTTERIM_2020 has been dropped.
1413       quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1414       /*---- End of User Written Code  ----*/
1415       
1416       /*==========================================================================*
1417        * Step:            Table Loader                          A57BXQB4.BV0000VN *
1418        * Transform:       Table Loader (Version 2.1)                              *
1419        * Description:                                                             *
1420        *                                                                          *
1421        * Source Table:    ANLIK_DEMAND_TEKTERIM_2016 -          A57BXQB4.BE0001HD *
1422        *                   RISU.ANLIK_DEMAND_TEKTERIM_2016                        *
1423        * Target Table:    ANLIK_DEMAND_TEKTERIM_2016 -          A57BXQB4.BE0001HE *
42                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1424        *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016                     *
1425        *                                                                          *
1426        * Warnings:                                                                *
1427        * Mapping of the target column TESISAT is too short for the specified      *
1428        *  source column TESISAT.  Values will be truncated.                       *
1429        * Mapping of the target column DAGITIM_BOLGESI is too short for the        *
1430        *  specified source column DAGITIM_BOLGESI.  Values will be truncated.     *
1431        * Mapping of the target column TAKVIM_AY_YIL is too short for the specified *
1432        *  source column TAKVIM_AY_YIL.  Values will be truncated.                 *
1433        *==========================================================================*/
1434       
1435       %let transformID = %quote(A57BXQB4.BV0000VN);
1436       %let trans_rc = 0;
1437       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1438       
1439       %let SYSLAST = %nrquote(RISU.ANLIK_DEMAND_TEKTERIM_2016);
1440       
1441       %global etls_sql_pushDown;
1442       %let etls_sql_pushDown = -1;
1443       option DBIDIRECTEXEC;
1444       
1445       %global etls_tableExist;
1446       %global etls_numIndex;
1447       %global etls_lastTable;
1448       %let etls_tableExist = -1;
1449       %let etls_numIndex = -1;
1450       %let etls_lastTable = &SYSLAST;
1451       
1452       /*---- Define load data macro  ----*/
1453       
1454       /* --------------------------------------------------------------
1455          Load Technique Selection: Replace - EntireTable
1456          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1457          Additional options selections...
1458             Set unmapped to missing on updates: false
1459          -------------------------------------------------------------- */
1460       %macro etls_loader;
1461       
1462          %let etls_tableOptions = ;
1463       
1464          /*---- Map the columns  ----*/
1465          proc datasets lib = work nolist nowarn memtype = (data view);
1466             delete WJVDEZ6K;
1467          quit;
1468       
1469          data _null_;
1470             put "WARNING%QUOTE(:) Mapping of the target column TESISAT is too short"
1471                  " for the specified source column TESISAT.  Values will be truncated.";
1472          run;
1473       
1474          data _null_;
1475             put "WARNING%QUOTE(:) Mapping of the target column DAGITIM_BOLGESI is too"
1476                  " short for the specified source column DAGITIM_BOLGESI.  Values will"
1477                  " be truncated.";
1478          run;
1479       
1480          data _null_;
1481             put "WARNING%QUOTE(:) Mapping of the target column TAKVIM_AY_YIL is too"
43                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1482                  " short for the specified source column TAKVIM_AY_YIL.  Values will"
1483                  " be truncated.";
1484          run;
1485       
1486          %put %str(NOTE: Mapping columns ...);
1487          proc sql;
1488             create view work.WJVDEZ6K as
1489                select
1490                   TESISAT length = 10
1491                      format = $10.,
1492                   DAGITIM_BOLGESI length = 10
1493                      format = $10.,
1494                   TAKVIM_AY_YIL length = 10
1495                      format = $10.,
1496                   TUKETIM_P,
1497                   SAYAC_CARPANI,
1498                   ANLIK_DEMAND
1499             from &etls_lastTable
1500             ;
1501          quit;
1502       
1503          %let SYSLAST = work.WJVDEZ6K;
1504       
1505          %let etls_lastTable = &SYSLAST;
1506          %let etls_tableOptions = ;
1507       
1508          /* Determine if the target table exists  */
1509          %let etls_tableExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016, DATA)) or
1510                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016, VIEW)));
1511       
1512          %if &etls_tableExist %then
1513          %do;/* table exists  */
1514             %let etls_hasPreExistingConstraint=0;
1515       
1516             proc datasets lib = work nolist nowarn memtype = (data view);
1517                delete etls_commands etls_commands_F;
1518             quit;
1519       
1520             %let etls_otherTablesReferToThisTable=0;
1521       
1522             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1523                %put NOTE: Building table listing Constraints and Indexes for: &table;
1524                proc datasets lib=work nolist; delete &workTableOut; quit;
1525                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1526       
1527                data &workTableOut;
1528                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1529                   name = '';
1530                   type = '';
1531                   icown = '';
1532                   idxUnique = '';
1533                   idxNoMiss = '';
1534                   recreate = '';
1535                   set &workTableOut;
1536                   ref = '';
1537                   type=upcase(type);
1538                   if type eq 'REFERENTIAL' then
1539                   do;
44                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1540                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1541                           " another table: " ref;
1542                      call symput('etls_otherTablesReferToThisTable','1');
1543                      delete;
1544                   end;
1545                   if type='INDEX' and ICOwn eq 'YES' then delete;
1546                run;
1547                %rcSet(&syserr);
1548       
1549             %mend etls_CIContents;
1550       
1551             %etls_CIContents(table=TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016, workTableOut=etls_commands, inDSOptions=);
1552       
1553             %if &etls_otherTablesReferToThisTable %then
1554                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1554     ! constraints.;
1555             %else
1556             %do; /* okay - remove foreign keys  */
1557       
1558                data etls_commands_F;
1559                   set etls_commands;
1560                   if upcase(type)="FOREIGN KEY" then
1561                   do;
1562                      command='ic delete '||trim(name)||';';
1563                      output etls_commands_F;
1564                   end;
1565                run;
1566       
1567                %put %str(NOTE: Removing foreign keys before dropping table...);
1568                data _null_;
1569                   set etls_commands_F end=eof;
1570                   if _n_=1 then
1571                      call execute('proc datasets nolist lib=TMPLIB3;modify ANLIK_DEMAND_TEKTERIM_2016;');
1572                   call execute(command);
1573                   if eof then call execute('; quit;');
1574                run;
1575                %rcSet(&syserr);
1576       
1577          %end; /* okay - remove foreign keys  */
1578       
1579          proc datasets lib = work nolist nowarn memtype = (data view);
1580             delete etls_commands etls_commands_F;
1581          quit;
1582       
1583          /*---- Drop a table  ----*/
1584          %put %str(NOTE: Dropping table ...);
1585          proc datasets lib = TMPLIB3 nolist nowarn memtype = (data view);
1586             delete ANLIK_DEMAND_TEKTERIM_2016;
1587          quit;
1588       
1589          %rcSet(&syserr);
1590       
1591          %let etls_tableExist = 0;
1592       
1593       %end; /* table exists  */
1594       
1595       /*---- Create a new table  ----*/
1596       %if (&etls_tableExist eq 0) %then
45                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1597       %do;  /* if table does not exist  */
1598       
1599          %put %str(NOTE: Creating table ...);
1600       
1601          data TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016
1602                  (COMPRESS = YES);
1603             attrib TESISAT length = $10
1604                format = $10.
1605                label = 'TESISAT';
1606             attrib DAGITIM_BOLGESI length = $10
1607                format = $10.
1608                label = 'DAGITIM_BOLGESI';
1609             attrib TAKVIM_AY_YIL length = $10
1610                format = $10.
1611                label = 'TAKVIM_AY_YIL';
1612             attrib TUKETIM_P length = 8
1613                label = 'TUKETIM_P';
1614             attrib SAYAC_CARPANI length = 8
1615                format = 14.5
1616                informat = 14.5
1617                label = 'SAYAC_CARPANI';
1618             attrib ANLIK_DEMAND length = 8
1619                label = 'ANLIK_DEMAND';
1620             call missing(of _all_);
1621             stop;
1622          run;
1623       
1624          %rcSet(&syserr);
1625       
1626       %end;  /* if table does not exist  */
1627       
1628       /*---- Append  ----*/
1629       %put %str(NOTE: Appending data ...);
1630       
1631       proc append base = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016(COMPRESS = YES)
1632          data = &etls_lastTable (&etls_tableOptions)  force ;
1633        run;
1634       
1635       %rcSet(&syserr);
1636       
1637       proc datasets lib = work nolist nowarn memtype = (data view);
1638          delete WJVDEZ6K;
1639       quit;
1640       
1641       %mend etls_loader;
1642       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZ6K;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TESISAT is too short" " for the specified source column TESISAT.  
Values will be truncated.";
46                                                         The SAS System                            09:00 Tuesday, November 3, 2020

MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TESISAT is too short for the specified source column TESISAT.  Values will be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column DAGITIM_BOLGESI is too" " short for the specified source column 
DAGITIM_BOLGESI.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column DAGITIM_BOLGESI is too short for the specified source column DAGITIM_BOLGESI.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TAKVIM_AY_YIL is too" " short for the specified source column 
TAKVIM_AY_YIL.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TAKVIM_AY_YIL is too short for the specified source column TAKVIM_AY_YIL.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Mapping columns ...
MPRINT(ETLS_LOADER):   proc sql;
MPRINT(ETLS_LOADER):   create view work.WJVDEZ6K as select TESISAT length = 10 format = $10., DAGITIM_BOLGESI length = 10 format = 
$10., TAKVIM_AY_YIL length = 10 format = $10., TUKETIM_P, SAYAC_CARPANI, ANLIK_DEMAND from RISU.ANLIK_DEMAND_TEKTERIM_2016 ;
NOTE: SQL view WORK.WJVDEZ6K has been defined.
MPRINT(ETLS_LOADER):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016 (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib TESISAT length = $10 format = $10. label = 'TESISAT';
MPRINT(ETLS_LOADER):   attrib DAGITIM_BOLGESI length = $10 format = $10. label = 'DAGITIM_BOLGESI';
MPRINT(ETLS_LOADER):   attrib TAKVIM_AY_YIL length = $10 format = $10. label = 'TAKVIM_AY_YIL';
MPRINT(ETLS_LOADER):   attrib TUKETIM_P length = 8 label = 'TUKETIM_P';
MPRINT(ETLS_LOADER):   attrib SAYAC_CARPANI length = 8 format = 14.5 informat = 14.5 label = 'SAYAC_CARPANI';
MPRINT(ETLS_LOADER):   attrib ANLIK_DEMAND length = 8 label = 'ANLIK_DEMAND';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016 has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
47                                                         The SAS System                            09:00 Tuesday, November 3, 2020

      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016(COMPRESS = YES) data = WORK.WJVDEZ6K () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending WORK.WJVDEZ6K to TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016.
NOTE: There were 21777769 observations read from the data set WORK.WJVDEZ6K.
NOTE: 21777769 observations added.
NOTE: The data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016 has 21777769 observations and 6 variables.
NOTE: Compressing data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016 decreased size by 16.48 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           7:38.42
      cpu time            1:58.95
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZ6K;
MPRINT(ETLS_LOADER):   quit;
NOTE: Deleting WORK.WJVDEZ6K (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1643       
1644       %let etls_recCheckExist = 0;
1645       %let etls_recnt = 0;
1646       %macro etls_recordCheck;
1647          %let etls_recCheckExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016, DATA)) or
1648                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016, VIEW)));
1649       
1650          %if (&etls_recCheckExist) %then
1651          %do;
1652             %local etls_syntaxcheck;
1653             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1654             /* Turn off syntaxcheck option to perform following steps  */
1655             options nosyntaxcheck;
1656       
1657             proc contents data = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016 out = work.etls_contents(keep = nobs) noprint;
1658             run;
1659       
1660             data _null_;
1661                set work.etls_contents (obs = 1);
1662                call symput("etls_recnt", left(put(nobs,32.)));
1663             run;
1664       
1665             proc datasets lib = work nolist nowarn memtype = (data view);
1666                delete etls_contents;
1667             quit;
1668       
1669             /* Reset syntaxcheck option to previous setting  */
1670             options &etls_syntaxcheck;
1671          %end;
1672       %mend etls_recordCheck;
48                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1673       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016 out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1674       
1675       
1676       
1677       /** Step end Table Loader **/
1678       
1679       /*==========================================================================*
1680        * Step:            Table Loader                          A57BXQB4.BV0000VO *
1681        * Transform:       Table Loader (Version 2.1)                              *
1682        * Description:                                                             *
1683        *                                                                          *
1684        * Source Table:    ANLIK_DEMAND_TEKTERIM_2017 -          A57BXQB4.BE0001HF *
1685        *                   RISU.ANLIK_DEMAND_TEKTERIM_2017                        *
1686        * Target Table:    ANLIK_DEMAND_TEKTERIM_2017 -          A57BXQB4.BE0001HG *
1687        *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017                     *
1688        *                                                                          *
1689        * Warnings:                                                                *
1690        * Mapping of the target column TESISAT is too short for the specified      *
1691        *  source column TESISAT.  Values will be truncated.                       *
1692        * Mapping of the target column DAGITIM_BOLGESI is too short for the        *
1693        *  specified source column DAGITIM_BOLGESI.  Values will be truncated.     *
1694        * Mapping of the target column TAKVIM_AY_YIL is too short for the specified *
1695        *  source column TAKVIM_AY_YIL.  Values will be truncated.                 *
1696        *==========================================================================*/
1697       
1698       %let transformID = %quote(A57BXQB4.BV0000VO);
49                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1699       %let trans_rc = 0;
1700       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1701       
1702       %let SYSLAST = %nrquote(RISU.ANLIK_DEMAND_TEKTERIM_2017);
1703       
1704       %global etls_sql_pushDown;
1705       %let etls_sql_pushDown = -1;
1706       option DBIDIRECTEXEC;
1707       
1708       %global etls_tableExist;
1709       %global etls_numIndex;
1710       %global etls_lastTable;
1711       %let etls_tableExist = -1;
1712       %let etls_numIndex = -1;
1713       %let etls_lastTable = &SYSLAST;
1714       
1715       /*---- Define load data macro  ----*/
1716       
1717       /* --------------------------------------------------------------
1718          Load Technique Selection: Replace - EntireTable
1719          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1720          Additional options selections...
1721             Set unmapped to missing on updates: false
1722          -------------------------------------------------------------- */
1723       %macro etls_loader;
1724       
1725          %let etls_tableOptions = ;
1726       
1727          /*---- Map the columns  ----*/
1728          proc datasets lib = work nolist nowarn memtype = (data view);
1729             delete WJVDEZAU;
1730          quit;
1731       
1732          data _null_;
1733             put "WARNING%QUOTE(:) Mapping of the target column TESISAT is too short"
1734                  " for the specified source column TESISAT.  Values will be truncated.";
1735          run;
1736       
1737          data _null_;
1738             put "WARNING%QUOTE(:) Mapping of the target column DAGITIM_BOLGESI is too"
1739                  " short for the specified source column DAGITIM_BOLGESI.  Values will"
1740                  " be truncated.";
1741          run;
1742       
1743          data _null_;
1744             put "WARNING%QUOTE(:) Mapping of the target column TAKVIM_AY_YIL is too"
1745                  " short for the specified source column TAKVIM_AY_YIL.  Values will"
1746                  " be truncated.";
1747          run;
1748       
1749          %put %str(NOTE: Mapping columns ...);
1750          proc sql;
1751             create view work.WJVDEZAU as
1752                select
1753                   TESISAT length = 10
1754                      format = $10.,
1755                   DAGITIM_BOLGESI length = 10
1756                      format = $10.,
50                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1757                   TAKVIM_AY_YIL length = 10
1758                      format = $10.,
1759                   TUKETIM_P,
1760                   SAYAC_CARPANI,
1761                   ANLIK_DEMAND
1762             from &etls_lastTable
1763             ;
1764          quit;
1765       
1766          %let SYSLAST = work.WJVDEZAU;
1767       
1768          %let etls_lastTable = &SYSLAST;
1769          %let etls_tableOptions = ;
1770       
1771          /* Determine if the target table exists  */
1772          %let etls_tableExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017, DATA)) or
1773                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017, VIEW)));
1774       
1775          %if &etls_tableExist %then
1776          %do;/* table exists  */
1777             %let etls_hasPreExistingConstraint=0;
1778       
1779             proc datasets lib = work nolist nowarn memtype = (data view);
1780                delete etls_commands etls_commands_F;
1781             quit;
1782       
1783             %let etls_otherTablesReferToThisTable=0;
1784       
1785             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1786                %put NOTE: Building table listing Constraints and Indexes for: &table;
1787                proc datasets lib=work nolist; delete &workTableOut; quit;
1788                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1789       
1790                data &workTableOut;
1791                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1792                   name = '';
1793                   type = '';
1794                   icown = '';
1795                   idxUnique = '';
1796                   idxNoMiss = '';
1797                   recreate = '';
1798                   set &workTableOut;
1799                   ref = '';
1800                   type=upcase(type);
1801                   if type eq 'REFERENTIAL' then
1802                   do;
1803                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1804                           " another table: " ref;
1805                      call symput('etls_otherTablesReferToThisTable','1');
1806                      delete;
1807                   end;
1808                   if type='INDEX' and ICOwn eq 'YES' then delete;
1809                run;
1810                %rcSet(&syserr);
1811       
1812             %mend etls_CIContents;
1813       
1814             %etls_CIContents(table=TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017, workTableOut=etls_commands, inDSOptions=);
51                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1815       
1816             %if &etls_otherTablesReferToThisTable %then
1817                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1817     ! constraints.;
1818             %else
1819             %do; /* okay - remove foreign keys  */
1820       
1821                data etls_commands_F;
1822                   set etls_commands;
1823                   if upcase(type)="FOREIGN KEY" then
1824                   do;
1825                      command='ic delete '||trim(name)||';';
1826                      output etls_commands_F;
1827                   end;
1828                run;
1829       
1830                %put %str(NOTE: Removing foreign keys before dropping table...);
1831                data _null_;
1832                   set etls_commands_F end=eof;
1833                   if _n_=1 then
1834                      call execute('proc datasets nolist lib=TMPLIB3;modify ANLIK_DEMAND_TEKTERIM_2017;');
1835                   call execute(command);
1836                   if eof then call execute('; quit;');
1837                run;
1838                %rcSet(&syserr);
1839       
1840          %end; /* okay - remove foreign keys  */
1841       
1842          proc datasets lib = work nolist nowarn memtype = (data view);
1843             delete etls_commands etls_commands_F;
1844          quit;
1845       
1846          /*---- Drop a table  ----*/
1847          %put %str(NOTE: Dropping table ...);
1848          proc datasets lib = TMPLIB3 nolist nowarn memtype = (data view);
1849             delete ANLIK_DEMAND_TEKTERIM_2017;
1850          quit;
1851       
1852          %rcSet(&syserr);
1853       
1854          %let etls_tableExist = 0;
1855       
1856       %end; /* table exists  */
1857       
1858       /*---- Create a new table  ----*/
1859       %if (&etls_tableExist eq 0) %then
1860       %do;  /* if table does not exist  */
1861       
1862          %put %str(NOTE: Creating table ...);
1863       
1864          data TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017
1865                  (COMPRESS = YES);
1866             attrib TESISAT length = $10
1867                format = $10.
1868                label = 'TESISAT';
1869             attrib DAGITIM_BOLGESI length = $10
1870                format = $10.
1871                label = 'DAGITIM_BOLGESI';
52                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1872             attrib TAKVIM_AY_YIL length = $10
1873                format = $10.
1874                label = 'TAKVIM_AY_YIL';
1875             attrib TUKETIM_P length = 8
1876                label = 'TUKETIM_P';
1877             attrib SAYAC_CARPANI length = 8
1878                format = 14.5
1879                informat = 14.5
1880                label = 'SAYAC_CARPANI';
1881             attrib ANLIK_DEMAND length = 8
1882                label = 'ANLIK_DEMAND';
1883             call missing(of _all_);
1884             stop;
1885          run;
1886       
1887          %rcSet(&syserr);
1888       
1889       %end;  /* if table does not exist  */
1890       
1891       /*---- Append  ----*/
1892       %put %str(NOTE: Appending data ...);
1893       
1894       proc append base = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017(COMPRESS = YES)
1895          data = &etls_lastTable (&etls_tableOptions)  force ;
1896        run;
1897       
1898       %rcSet(&syserr);
1899       
1900       proc datasets lib = work nolist nowarn memtype = (data view);
1901          delete WJVDEZAU;
1902       quit;
1903       
1904       %mend etls_loader;
1905       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZAU;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TESISAT is too short" " for the specified source column TESISAT.  
Values will be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TESISAT is too short for the specified source column TESISAT.  Values will be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column DAGITIM_BOLGESI is too" " short for the specified source column 
DAGITIM_BOLGESI.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;
53                                                         The SAS System                            09:00 Tuesday, November 3, 2020


WARNING: Mapping of the target column DAGITIM_BOLGESI is too short for the specified source column DAGITIM_BOLGESI.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TAKVIM_AY_YIL is too" " short for the specified source column 
TAKVIM_AY_YIL.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TAKVIM_AY_YIL is too short for the specified source column TAKVIM_AY_YIL.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Mapping columns ...
MPRINT(ETLS_LOADER):   proc sql;
MPRINT(ETLS_LOADER):   create view work.WJVDEZAU as select TESISAT length = 10 format = $10., DAGITIM_BOLGESI length = 10 format = 
$10., TAKVIM_AY_YIL length = 10 format = $10., TUKETIM_P, SAYAC_CARPANI, ANLIK_DEMAND from RISU.ANLIK_DEMAND_TEKTERIM_2017 ;
NOTE: SQL view WORK.WJVDEZAU has been defined.
MPRINT(ETLS_LOADER):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017 (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib TESISAT length = $10 format = $10. label = 'TESISAT';
MPRINT(ETLS_LOADER):   attrib DAGITIM_BOLGESI length = $10 format = $10. label = 'DAGITIM_BOLGESI';
MPRINT(ETLS_LOADER):   attrib TAKVIM_AY_YIL length = $10 format = $10. label = 'TAKVIM_AY_YIL';
MPRINT(ETLS_LOADER):   attrib TUKETIM_P length = 8 label = 'TUKETIM_P';
MPRINT(ETLS_LOADER):   attrib SAYAC_CARPANI length = 8 format = 14.5 informat = 14.5 label = 'SAYAC_CARPANI';
MPRINT(ETLS_LOADER):   attrib ANLIK_DEMAND length = 8 label = 'ANLIK_DEMAND';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017 has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017(COMPRESS = YES) data = WORK.WJVDEZAU () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending WORK.WJVDEZAU to TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017.
NOTE: There were 93589592 observations read from the data set WORK.WJVDEZAU.
NOTE: 93589592 observations added.
NOTE: The data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017 has 93589592 observations and 6 variables.
54                                                         The SAS System                            09:00 Tuesday, November 3, 2020

NOTE: Compressing data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017 decreased size by 13.47 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           26:49.74
      cpu time            8:41.68
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZAU;
MPRINT(ETLS_LOADER):   quit;
NOTE: Deleting WORK.WJVDEZAU (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1906       
1907       %let etls_recCheckExist = 0;
1908       %let etls_recnt = 0;
1909       %macro etls_recordCheck;
1910          %let etls_recCheckExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017, DATA)) or
1911                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017, VIEW)));
1912       
1913          %if (&etls_recCheckExist) %then
1914          %do;
1915             %local etls_syntaxcheck;
1916             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1917             /* Turn off syntaxcheck option to perform following steps  */
1918             options nosyntaxcheck;
1919       
1920             proc contents data = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017 out = work.etls_contents(keep = nobs) noprint;
1921             run;
1922       
1923             data _null_;
1924                set work.etls_contents (obs = 1);
1925                call symput("etls_recnt", left(put(nobs,32.)));
1926             run;
1927       
1928             proc datasets lib = work nolist nowarn memtype = (data view);
1929                delete etls_contents;
1930             quit;
1931       
1932             /* Reset syntaxcheck option to previous setting  */
1933             options &etls_syntaxcheck;
1934          %end;
1935       %mend etls_recordCheck;
1936       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017 out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
55                                                         The SAS System                            09:00 Tuesday, November 3, 2020

MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1937       
1938       
1939       
1940       /** Step end Table Loader **/
1941       
1942       /*==========================================================================*
1943        * Step:            Table Loader                          A57BXQB4.BV0000VP *
1944        * Transform:       Table Loader (Version 2.1)                              *
1945        * Description:                                                             *
1946        *                                                                          *
1947        * Source Table:    ANLIK_DEMAND_TEKTERIM_2018 -          A57BXQB4.BE0001HH *
1948        *                   RISU.ANLIK_DEMAND_TEKTERIM_2018                        *
1949        * Target Table:    ANLIK_DEMAND_TEKTERIM_2018 -          A57BXQB4.BE0001HI *
1950        *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018                     *
1951        *                                                                          *
1952        * Warnings:                                                                *
1953        * Mapping of the target column TESISAT is too short for the specified      *
1954        *  source column TESISAT.  Values will be truncated.                       *
1955        * Mapping of the target column DAGITIM_BOLGESI is too short for the        *
1956        *  specified source column DAGITIM_BOLGESI.  Values will be truncated.     *
1957        * Mapping of the target column TAKVIM_AY_YIL is too short for the specified *
1958        *  source column TAKVIM_AY_YIL.  Values will be truncated.                 *
1959        *==========================================================================*/
1960       
1961       %let transformID = %quote(A57BXQB4.BV0000VP);
1962       %let trans_rc = 0;
1963       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1964       
1965       %let SYSLAST = %nrquote(RISU.ANLIK_DEMAND_TEKTERIM_2018);
1966       
1967       %global etls_sql_pushDown;
1968       %let etls_sql_pushDown = -1;
1969       option DBIDIRECTEXEC;
1970       
1971       %global etls_tableExist;
1972       %global etls_numIndex;
1973       %global etls_lastTable;
56                                                         The SAS System                            09:00 Tuesday, November 3, 2020

1974       %let etls_tableExist = -1;
1975       %let etls_numIndex = -1;
1976       %let etls_lastTable = &SYSLAST;
1977       
1978       /*---- Define load data macro  ----*/
1979       
1980       /* --------------------------------------------------------------
1981          Load Technique Selection: Replace - EntireTable
1982          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1983          Additional options selections...
1984             Set unmapped to missing on updates: false
1985          -------------------------------------------------------------- */
1986       %macro etls_loader;
1987       
1988          %let etls_tableOptions = ;
1989       
1990          /*---- Map the columns  ----*/
1991          proc datasets lib = work nolist nowarn memtype = (data view);
1992             delete WJVDEZDB;
1993          quit;
1994       
1995          data _null_;
1996             put "WARNING%QUOTE(:) Mapping of the target column TESISAT is too short"
1997                  " for the specified source column TESISAT.  Values will be truncated.";
1998          run;
1999       
2000          data _null_;
2001             put "WARNING%QUOTE(:) Mapping of the target column DAGITIM_BOLGESI is too"
2002                  " short for the specified source column DAGITIM_BOLGESI.  Values will"
2003                  " be truncated.";
2004          run;
2005       
2006          data _null_;
2007             put "WARNING%QUOTE(:) Mapping of the target column TAKVIM_AY_YIL is too"
2008                  " short for the specified source column TAKVIM_AY_YIL.  Values will"
2009                  " be truncated.";
2010          run;
2011       
2012          %put %str(NOTE: Mapping columns ...);
2013          proc sql;
2014             create view work.WJVDEZDB as
2015                select
2016                   TESISAT length = 10
2017                      format = $10.,
2018                   DAGITIM_BOLGESI length = 10
2019                      format = $10.,
2020                   TAKVIM_AY_YIL length = 10
2021                      format = $10.,
2022                   TUKETIM_P,
2023                   SAYAC_CARPANI,
2024                   ANLIK_DEMAND
2025             from &etls_lastTable
2026             ;
2027          quit;
2028       
2029          %let SYSLAST = work.WJVDEZDB;
2030       
2031          %let etls_lastTable = &SYSLAST;
57                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2032          %let etls_tableOptions = ;
2033       
2034          /* Determine if the target table exists  */
2035          %let etls_tableExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018, DATA)) or
2036                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018, VIEW)));
2037       
2038          %if &etls_tableExist %then
2039          %do;/* table exists  */
2040             %let etls_hasPreExistingConstraint=0;
2041       
2042             proc datasets lib = work nolist nowarn memtype = (data view);
2043                delete etls_commands etls_commands_F;
2044             quit;
2045       
2046             %let etls_otherTablesReferToThisTable=0;
2047       
2048             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2049                %put NOTE: Building table listing Constraints and Indexes for: &table;
2050                proc datasets lib=work nolist; delete &workTableOut; quit;
2051                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2052       
2053                data &workTableOut;
2054                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2055                   name = '';
2056                   type = '';
2057                   icown = '';
2058                   idxUnique = '';
2059                   idxNoMiss = '';
2060                   recreate = '';
2061                   set &workTableOut;
2062                   ref = '';
2063                   type=upcase(type);
2064                   if type eq 'REFERENTIAL' then
2065                   do;
2066                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2067                           " another table: " ref;
2068                      call symput('etls_otherTablesReferToThisTable','1');
2069                      delete;
2070                   end;
2071                   if type='INDEX' and ICOwn eq 'YES' then delete;
2072                run;
2073                %rcSet(&syserr);
2074       
2075             %mend etls_CIContents;
2076       
2077             %etls_CIContents(table=TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018, workTableOut=etls_commands, inDSOptions=);
2078       
2079             %if &etls_otherTablesReferToThisTable %then
2080                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2080     ! constraints.;
2081             %else
2082             %do; /* okay - remove foreign keys  */
2083       
2084                data etls_commands_F;
2085                   set etls_commands;
2086                   if upcase(type)="FOREIGN KEY" then
2087                   do;
2088                      command='ic delete '||trim(name)||';';
58                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2089                      output etls_commands_F;
2090                   end;
2091                run;
2092       
2093                %put %str(NOTE: Removing foreign keys before dropping table...);
2094                data _null_;
2095                   set etls_commands_F end=eof;
2096                   if _n_=1 then
2097                      call execute('proc datasets nolist lib=TMPLIB3;modify ANLIK_DEMAND_TEKTERIM_2018;');
2098                   call execute(command);
2099                   if eof then call execute('; quit;');
2100                run;
2101                %rcSet(&syserr);
2102       
2103          %end; /* okay - remove foreign keys  */
2104       
2105          proc datasets lib = work nolist nowarn memtype = (data view);
2106             delete etls_commands etls_commands_F;
2107          quit;
2108       
2109          /*---- Drop a table  ----*/
2110          %put %str(NOTE: Dropping table ...);
2111          proc datasets lib = TMPLIB3 nolist nowarn memtype = (data view);
2112             delete ANLIK_DEMAND_TEKTERIM_2018;
2113          quit;
2114       
2115          %rcSet(&syserr);
2116       
2117          %let etls_tableExist = 0;
2118       
2119       %end; /* table exists  */
2120       
2121       /*---- Create a new table  ----*/
2122       %if (&etls_tableExist eq 0) %then
2123       %do;  /* if table does not exist  */
2124       
2125          %put %str(NOTE: Creating table ...);
2126       
2127          data TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018
2128                  (COMPRESS = YES);
2129             attrib TESISAT length = $10
2130                format = $10.
2131                label = 'TESISAT';
2132             attrib DAGITIM_BOLGESI length = $10
2133                format = $10.
2134                label = 'DAGITIM_BOLGESI';
2135             attrib TAKVIM_AY_YIL length = $10
2136                format = $10.
2137                label = 'TAKVIM_AY_YIL';
2138             attrib TUKETIM_P length = 8
2139                label = 'TUKETIM_P';
2140             attrib SAYAC_CARPANI length = 8
2141                format = 14.5
2142                informat = 14.5
2143                label = 'SAYAC_CARPANI';
2144             attrib ANLIK_DEMAND length = 8
2145                label = 'ANLIK_DEMAND';
2146             call missing(of _all_);
59                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2147             stop;
2148          run;
2149       
2150          %rcSet(&syserr);
2151       
2152       %end;  /* if table does not exist  */
2153       
2154       /*---- Append  ----*/
2155       %put %str(NOTE: Appending data ...);
2156       
2157       proc append base = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018(COMPRESS = YES)
2158          data = &etls_lastTable (&etls_tableOptions)  force ;
2159        run;
2160       
2161       %rcSet(&syserr);
2162       
2163       proc datasets lib = work nolist nowarn memtype = (data view);
2164          delete WJVDEZDB;
2165       quit;
2166       
2167       %mend etls_loader;
2168       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZDB;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TESISAT is too short" " for the specified source column TESISAT.  
Values will be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TESISAT is too short for the specified source column TESISAT.  Values will be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column DAGITIM_BOLGESI is too" " short for the specified source column 
DAGITIM_BOLGESI.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column DAGITIM_BOLGESI is too short for the specified source column DAGITIM_BOLGESI.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TAKVIM_AY_YIL is too" " short for the specified source column 
TAKVIM_AY_YIL.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;
60                                                         The SAS System                            09:00 Tuesday, November 3, 2020


WARNING: Mapping of the target column TAKVIM_AY_YIL is too short for the specified source column TAKVIM_AY_YIL.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Mapping columns ...
MPRINT(ETLS_LOADER):   proc sql;
MPRINT(ETLS_LOADER):   create view work.WJVDEZDB as select TESISAT length = 10 format = $10., DAGITIM_BOLGESI length = 10 format = 
$10., TAKVIM_AY_YIL length = 10 format = $10., TUKETIM_P, SAYAC_CARPANI, ANLIK_DEMAND from RISU.ANLIK_DEMAND_TEKTERIM_2018 ;
NOTE: SQL view WORK.WJVDEZDB has been defined.
MPRINT(ETLS_LOADER):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018 (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib TESISAT length = $10 format = $10. label = 'TESISAT';
MPRINT(ETLS_LOADER):   attrib DAGITIM_BOLGESI length = $10 format = $10. label = 'DAGITIM_BOLGESI';
MPRINT(ETLS_LOADER):   attrib TAKVIM_AY_YIL length = $10 format = $10. label = 'TAKVIM_AY_YIL';
MPRINT(ETLS_LOADER):   attrib TUKETIM_P length = 8 label = 'TUKETIM_P';
MPRINT(ETLS_LOADER):   attrib SAYAC_CARPANI length = 8 format = 14.5 informat = 14.5 label = 'SAYAC_CARPANI';
MPRINT(ETLS_LOADER):   attrib ANLIK_DEMAND length = 8 label = 'ANLIK_DEMAND';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018 has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018(COMPRESS = YES) data = WORK.WJVDEZDB () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending WORK.WJVDEZDB to TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018.
NOTE: There were 98992630 observations read from the data set WORK.WJVDEZDB.
NOTE: 98992630 observations added.
NOTE: The data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018 has 98992630 observations and 6 variables.
NOTE: Compressing data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018 decreased size by 13.30 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           28:07.82
      cpu time            9:20.19
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZDB;
MPRINT(ETLS_LOADER):   quit;
NOTE: Deleting WORK.WJVDEZDB (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
61                                                         The SAS System                            09:00 Tuesday, November 3, 2020

      real time           0.00 seconds
      cpu time            0.00 seconds
      

2169       
2170       %let etls_recCheckExist = 0;
2171       %let etls_recnt = 0;
2172       %macro etls_recordCheck;
2173          %let etls_recCheckExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018, DATA)) or
2174                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018, VIEW)));
2175       
2176          %if (&etls_recCheckExist) %then
2177          %do;
2178             %local etls_syntaxcheck;
2179             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2180             /* Turn off syntaxcheck option to perform following steps  */
2181             options nosyntaxcheck;
2182       
2183             proc contents data = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018 out = work.etls_contents(keep = nobs) noprint;
2184             run;
2185       
2186             data _null_;
2187                set work.etls_contents (obs = 1);
2188                call symput("etls_recnt", left(put(nobs,32.)));
2189             run;
2190       
2191             proc datasets lib = work nolist nowarn memtype = (data view);
2192                delete etls_contents;
2193             quit;
2194       
2195             /* Reset syntaxcheck option to previous setting  */
2196             options &etls_syntaxcheck;
2197          %end;
2198       %mend etls_recordCheck;
2199       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018 out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
62                                                         The SAS System                            09:00 Tuesday, November 3, 2020

MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2200       
2201       
2202       
2203       /** Step end Table Loader **/
2204       
2205       /*==========================================================================*
2206        * Step:            Table Loader                          A57BXQB4.BV0000VQ *
2207        * Transform:       Table Loader (Version 2.1)                              *
2208        * Description:                                                             *
2209        *                                                                          *
2210        * Source Table:    ANLIK_DEMAND_TEKTERIM_2019 -          A57BXQB4.BE0001HJ *
2211        *                   RISU.ANLIK_DEMAND_TEKTERIM_2019                        *
2212        * Target Table:    ANLIK_DEMAND_TEKTERIM_2019 -          A57BXQB4.BE0001HK *
2213        *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019                     *
2214        *                                                                          *
2215        * Warnings:                                                                *
2216        * Mapping of the target column TESISAT is too short for the specified      *
2217        *  source column TESISAT.  Values will be truncated.                       *
2218        * Mapping of the target column DAGITIM_BOLGESI is too short for the        *
2219        *  specified source column DAGITIM_BOLGESI.  Values will be truncated.     *
2220        * Mapping of the target column TAKVIM_AY_YIL is too short for the specified *
2221        *  source column TAKVIM_AY_YIL.  Values will be truncated.                 *
2222        *==========================================================================*/
2223       
2224       %let transformID = %quote(A57BXQB4.BV0000VQ);
2225       %let trans_rc = 0;
2226       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2227       
2228       %let SYSLAST = %nrquote(RISU.ANLIK_DEMAND_TEKTERIM_2019);
2229       
2230       %global etls_sql_pushDown;
2231       %let etls_sql_pushDown = -1;
2232       option DBIDIRECTEXEC;
2233       
2234       %global etls_tableExist;
2235       %global etls_numIndex;
2236       %global etls_lastTable;
2237       %let etls_tableExist = -1;
2238       %let etls_numIndex = -1;
2239       %let etls_lastTable = &SYSLAST;
2240       
2241       /*---- Define load data macro  ----*/
2242       
2243       /* --------------------------------------------------------------
2244          Load Technique Selection: Replace - EntireTable
2245          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2246          Additional options selections...
2247             Set unmapped to missing on updates: false
2248          -------------------------------------------------------------- */
63                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2249       %macro etls_loader;
2250       
2251          %let etls_tableOptions = ;
2252       
2253          /*---- Map the columns  ----*/
2254          proc datasets lib = work nolist nowarn memtype = (data view);
2255             delete WJVDEZEI;
2256          quit;
2257       
2258          data _null_;
2259             put "WARNING%QUOTE(:) Mapping of the target column TESISAT is too short"
2260                  " for the specified source column TESISAT.  Values will be truncated.";
2261          run;
2262       
2263          data _null_;
2264             put "WARNING%QUOTE(:) Mapping of the target column DAGITIM_BOLGESI is too"
2265                  " short for the specified source column DAGITIM_BOLGESI.  Values will"
2266                  " be truncated.";
2267          run;
2268       
2269          data _null_;
2270             put "WARNING%QUOTE(:) Mapping of the target column TAKVIM_AY_YIL is too"
2271                  " short for the specified source column TAKVIM_AY_YIL.  Values will"
2272                  " be truncated.";
2273          run;
2274       
2275          %put %str(NOTE: Mapping columns ...);
2276          proc sql;
2277             create view work.WJVDEZEI as
2278                select
2279                   TESISAT length = 10
2280                      format = $10.,
2281                   DAGITIM_BOLGESI length = 10
2282                      format = $10.,
2283                   TAKVIM_AY_YIL length = 10
2284                      format = $10.,
2285                   TUKETIM_P,
2286                   SAYAC_CARPANI,
2287                   ANLIK_DEMAND
2288             from &etls_lastTable
2289             ;
2290          quit;
2291       
2292          %let SYSLAST = work.WJVDEZEI;
2293       
2294          %let etls_lastTable = &SYSLAST;
2295          %let etls_tableOptions = ;
2296       
2297          /* Determine if the target table exists  */
2298          %let etls_tableExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019, DATA)) or
2299                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019, VIEW)));
2300       
2301          %if &etls_tableExist %then
2302          %do;/* table exists  */
2303             %let etls_hasPreExistingConstraint=0;
2304       
2305             proc datasets lib = work nolist nowarn memtype = (data view);
2306                delete etls_commands etls_commands_F;
64                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2307             quit;
2308       
2309             %let etls_otherTablesReferToThisTable=0;
2310       
2311             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2312                %put NOTE: Building table listing Constraints and Indexes for: &table;
2313                proc datasets lib=work nolist; delete &workTableOut; quit;
2314                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2315       
2316                data &workTableOut;
2317                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2318                   name = '';
2319                   type = '';
2320                   icown = '';
2321                   idxUnique = '';
2322                   idxNoMiss = '';
2323                   recreate = '';
2324                   set &workTableOut;
2325                   ref = '';
2326                   type=upcase(type);
2327                   if type eq 'REFERENTIAL' then
2328                   do;
2329                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2330                           " another table: " ref;
2331                      call symput('etls_otherTablesReferToThisTable','1');
2332                      delete;
2333                   end;
2334                   if type='INDEX' and ICOwn eq 'YES' then delete;
2335                run;
2336                %rcSet(&syserr);
2337       
2338             %mend etls_CIContents;
2339       
2340             %etls_CIContents(table=TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019, workTableOut=etls_commands, inDSOptions=);
2341       
2342             %if &etls_otherTablesReferToThisTable %then
2343                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2343     ! constraints.;
2344             %else
2345             %do; /* okay - remove foreign keys  */
2346       
2347                data etls_commands_F;
2348                   set etls_commands;
2349                   if upcase(type)="FOREIGN KEY" then
2350                   do;
2351                      command='ic delete '||trim(name)||';';
2352                      output etls_commands_F;
2353                   end;
2354                run;
2355       
2356                %put %str(NOTE: Removing foreign keys before dropping table...);
2357                data _null_;
2358                   set etls_commands_F end=eof;
2359                   if _n_=1 then
2360                      call execute('proc datasets nolist lib=TMPLIB3;modify ANLIK_DEMAND_TEKTERIM_2019;');
2361                   call execute(command);
2362                   if eof then call execute('; quit;');
2363                run;
65                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2364                %rcSet(&syserr);
2365       
2366          %end; /* okay - remove foreign keys  */
2367       
2368          proc datasets lib = work nolist nowarn memtype = (data view);
2369             delete etls_commands etls_commands_F;
2370          quit;
2371       
2372          /*---- Drop a table  ----*/
2373          %put %str(NOTE: Dropping table ...);
2374          proc datasets lib = TMPLIB3 nolist nowarn memtype = (data view);
2375             delete ANLIK_DEMAND_TEKTERIM_2019;
2376          quit;
2377       
2378          %rcSet(&syserr);
2379       
2380          %let etls_tableExist = 0;
2381       
2382       %end; /* table exists  */
2383       
2384       /*---- Create a new table  ----*/
2385       %if (&etls_tableExist eq 0) %then
2386       %do;  /* if table does not exist  */
2387       
2388          %put %str(NOTE: Creating table ...);
2389       
2390          data TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019
2391                  (COMPRESS = YES);
2392             attrib TESISAT length = $10
2393                format = $10.
2394                label = 'TESISAT';
2395             attrib DAGITIM_BOLGESI length = $10
2396                format = $10.
2397                label = 'DAGITIM_BOLGESI';
2398             attrib TAKVIM_AY_YIL length = $10
2399                format = $10.
2400                label = 'TAKVIM_AY_YIL';
2401             attrib TUKETIM_P length = 8
2402                label = 'TUKETIM_P';
2403             attrib SAYAC_CARPANI length = 8
2404                format = 14.5
2405                informat = 14.5
2406                label = 'SAYAC_CARPANI';
2407             attrib ANLIK_DEMAND length = 8
2408                label = 'ANLIK_DEMAND';
2409             call missing(of _all_);
2410             stop;
2411          run;
2412       
2413          %rcSet(&syserr);
2414       
2415       %end;  /* if table does not exist  */
2416       
2417       /*---- Append  ----*/
2418       %put %str(NOTE: Appending data ...);
2419       
2420       proc append base = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019(COMPRESS = YES)
2421          data = &etls_lastTable (&etls_tableOptions)  force ;
66                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2422        run;
2423       
2424       %rcSet(&syserr);
2425       
2426       proc datasets lib = work nolist nowarn memtype = (data view);
2427          delete WJVDEZEI;
2428       quit;
2429       
2430       %mend etls_loader;
2431       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZEI;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TESISAT is too short" " for the specified source column TESISAT.  
Values will be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TESISAT is too short for the specified source column TESISAT.  Values will be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column DAGITIM_BOLGESI is too" " short for the specified source column 
DAGITIM_BOLGESI.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column DAGITIM_BOLGESI is too short for the specified source column DAGITIM_BOLGESI.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   put "WARNING: Mapping of the target column TAKVIM_AY_YIL is too" " short for the specified source column 
TAKVIM_AY_YIL.  Values will" " be truncated.";
MPRINT(ETLS_LOADER):   run;

WARNING: Mapping of the target column TAKVIM_AY_YIL is too short for the specified source column TAKVIM_AY_YIL.  Values will
 be truncated.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Mapping columns ...
MPRINT(ETLS_LOADER):   proc sql;
MPRINT(ETLS_LOADER):   create view work.WJVDEZEI as select TESISAT length = 10 format = $10., DAGITIM_BOLGESI length = 10 format = 
$10., TAKVIM_AY_YIL length = 10 format = $10., TUKETIM_P, SAYAC_CARPANI, ANLIK_DEMAND from RISU.ANLIK_DEMAND_TEKTERIM_2019 ;
67                                                         The SAS System                            09:00 Tuesday, November 3, 2020

NOTE: SQL view WORK.WJVDEZEI has been defined.
MPRINT(ETLS_LOADER):   quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019 (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib TESISAT length = $10 format = $10. label = 'TESISAT';
MPRINT(ETLS_LOADER):   attrib DAGITIM_BOLGESI length = $10 format = $10. label = 'DAGITIM_BOLGESI';
MPRINT(ETLS_LOADER):   attrib TAKVIM_AY_YIL length = $10 format = $10. label = 'TAKVIM_AY_YIL';
MPRINT(ETLS_LOADER):   attrib TUKETIM_P length = 8 label = 'TUKETIM_P';
MPRINT(ETLS_LOADER):   attrib SAYAC_CARPANI length = 8 format = 14.5 informat = 14.5 label = 'SAYAC_CARPANI';
MPRINT(ETLS_LOADER):   attrib ANLIK_DEMAND length = 8 label = 'ANLIK_DEMAND';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019 has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019(COMPRESS = YES) data = WORK.WJVDEZEI () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending WORK.WJVDEZEI to TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019.
NOTE: There were 104115410 observations read from the data set WORK.WJVDEZEI.
NOTE: 104115410 observations added.
NOTE: The data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019 has 104115410 observations and 6 variables.
NOTE: Compressing data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019 decreased size by 13.25 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           15:38.36
      cpu time            3:27.77
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete WJVDEZEI;
MPRINT(ETLS_LOADER):   quit;
NOTE: Deleting WORK.WJVDEZEI (memtype=VIEW).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2432       
2433       %let etls_recCheckExist = 0;
2434       %let etls_recnt = 0;
2435       %macro etls_recordCheck;
2436          %let etls_recCheckExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019, DATA)) or
2437                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019, VIEW)));
2438       
2439          %if (&etls_recCheckExist) %then
68                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2440          %do;
2441             %local etls_syntaxcheck;
2442             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2443             /* Turn off syntaxcheck option to perform following steps  */
2444             options nosyntaxcheck;
2445       
2446             proc contents data = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019 out = work.etls_contents(keep = nobs) noprint;
2447             run;
2448       
2449             data _null_;
2450                set work.etls_contents (obs = 1);
2451                call symput("etls_recnt", left(put(nobs,32.)));
2452             run;
2453       
2454             proc datasets lib = work nolist nowarn memtype = (data view);
2455                delete etls_contents;
2456             quit;
2457       
2458             /* Reset syntaxcheck option to previous setting  */
2459             options &etls_syntaxcheck;
2460          %end;
2461       %mend etls_recordCheck;
2462       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019 out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2463       
2464       
2465       
69                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2466       /** Step end Table Loader **/
2467       
2468       /*==========================================================================*
2469        * Step:            Table Loader                          A57BXQB4.BV0003QJ *
2470        * Transform:       Table Loader (Version 2.1)                              *
2471        * Description:                                                             *
2472        *                                                                          *
2473        * Source Table:    ANLIK_DEMAND_TEKTERIM_2020 -          A57BXQB4.BE000586 *
2474        *                   RISU.ANLIK_DEMAND_TEKTERIM_2020                        *
2475        * Target Table:    ANLIK_DEMAND_TEKTERIM_2020 -          A57BXQB4.BE000587 *
2476        *                   TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020                     *
2477        *==========================================================================*/
2478       
2479       %let transformID = %quote(A57BXQB4.BV0003QJ);
2480       %let trans_rc = 0;
2481       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2482       
2483       %let SYSLAST = %nrquote(RISU.ANLIK_DEMAND_TEKTERIM_2020);
2484       
2485       %global etls_sql_pushDown;
2486       %let etls_sql_pushDown = -1;
2487       option DBIDIRECTEXEC;
2488       
2489       %global etls_tableExist;
2490       %global etls_numIndex;
2491       %global etls_lastTable;
2492       %let etls_tableExist = -1;
2493       %let etls_numIndex = -1;
2494       %let etls_lastTable = &SYSLAST;
2495       
2496       /*---- Define load data macro  ----*/
2497       
2498       /* --------------------------------------------------------------
2499          Load Technique Selection: Replace - EntireTable
2500          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2501          Additional options selections...
2502             Set unmapped to missing on updates: false
2503          -------------------------------------------------------------- */
2504       %macro etls_loader;
2505       
2506          %let etls_tableOptions = ;
2507       
2508          /* Determine if the target table exists  */
2509          %let etls_tableExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020, DATA)) or
2510                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020, VIEW)));
2511       
2512          %if &etls_tableExist %then
2513          %do;/* table exists  */
2514             %let etls_hasPreExistingConstraint=0;
2515       
2516             proc datasets lib = work nolist nowarn memtype = (data view);
2517                delete etls_commands etls_commands_F;
2518             quit;
2519       
2520             %let etls_otherTablesReferToThisTable=0;
2521       
2522             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2523                %put NOTE: Building table listing Constraints and Indexes for: &table;
70                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2524                proc datasets lib=work nolist; delete &workTableOut; quit;
2525                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2526       
2527                data &workTableOut;
2528                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2529                   name = '';
2530                   type = '';
2531                   icown = '';
2532                   idxUnique = '';
2533                   idxNoMiss = '';
2534                   recreate = '';
2535                   set &workTableOut;
2536                   ref = '';
2537                   type=upcase(type);
2538                   if type eq 'REFERENTIAL' then
2539                   do;
2540                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2541                           " another table: " ref;
2542                      call symput('etls_otherTablesReferToThisTable','1');
2543                      delete;
2544                   end;
2545                   if type='INDEX' and ICOwn eq 'YES' then delete;
2546                run;
2547                %rcSet(&syserr);
2548       
2549             %mend etls_CIContents;
2550       
2551             %etls_CIContents(table=TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020, workTableOut=etls_commands, inDSOptions=);
2552       
2553             %if &etls_otherTablesReferToThisTable %then
2554                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2554     ! constraints.;
2555             %else
2556             %do; /* okay - remove foreign keys  */
2557       
2558                data etls_commands_F;
2559                   set etls_commands;
2560                   if upcase(type)="FOREIGN KEY" then
2561                   do;
2562                      command='ic delete '||trim(name)||';';
2563                      output etls_commands_F;
2564                   end;
2565                run;
2566       
2567                %put %str(NOTE: Removing foreign keys before dropping table...);
2568                data _null_;
2569                   set etls_commands_F end=eof;
2570                   if _n_=1 then
2571                      call execute('proc datasets nolist lib=TMPLIB3;modify ANLIK_DEMAND_TEKTERIM_2020;');
2572                   call execute(command);
2573                   if eof then call execute('; quit;');
2574                run;
2575                %rcSet(&syserr);
2576       
2577          %end; /* okay - remove foreign keys  */
2578       
2579          proc datasets lib = work nolist nowarn memtype = (data view);
2580             delete etls_commands etls_commands_F;
71                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2581          quit;
2582       
2583          /*---- Drop a table  ----*/
2584          %put %str(NOTE: Dropping table ...);
2585          proc datasets lib = TMPLIB3 nolist nowarn memtype = (data view);
2586             delete ANLIK_DEMAND_TEKTERIM_2020;
2587          quit;
2588       
2589          %rcSet(&syserr);
2590       
2591          %let etls_tableExist = 0;
2592       
2593       %end; /* table exists  */
2594       
2595       /*---- Create a new table  ----*/
2596       %if (&etls_tableExist eq 0) %then
2597       %do;  /* if table does not exist  */
2598       
2599          %put %str(NOTE: Creating table ...);
2600       
2601          data TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020
2602                  (COMPRESS = YES);
2603             attrib TESISAT length = $20
2604                format = $20.
2605                informat = $20.
2606                label = 'TESISAT';
2607             attrib DAGITIM_BOLGESI length = $20
2608                format = $20.
2609                informat = $20.
2610                label = 'DAGITIM_BOLGESI';
2611             attrib TAKVIM_AY_YIL length = $14
2612                format = $14.
2613                informat = $14.
2614                label = 'TAKVIM_AY_YIL';
2615             attrib TUKETIM_P length = 8
2616                label = 'TUKETIM_P';
2617             attrib SAYAC_CARPANI length = 8
2618                format = 14.5
2619                informat = 14.5
2620                label = 'SAYAC_CARPANI';
2621             attrib ANLIK_DEMAND length = 8
2622                label = 'ANLIK_DEMAND';
2623             call missing(of _all_);
2624             stop;
2625          run;
2626       
2627          %rcSet(&syserr);
2628       
2629       %end;  /* if table does not exist  */
2630       
2631       /*---- Append  ----*/
2632       %put %str(NOTE: Appending data ...);
2633       
2634       proc append base = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020(COMPRESS = YES)
2635          data = &etls_lastTable (&etls_tableOptions)  force ;
2636        run;
2637       
2638       %rcSet(&syserr);
72                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2639       
2640       %mend etls_loader;
2641       %etls_loader;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020 (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib TESISAT length = $20 format = $20. informat = $20. label = 'TESISAT';
MPRINT(ETLS_LOADER):   attrib DAGITIM_BOLGESI length = $20 format = $20. informat = $20. label = 'DAGITIM_BOLGESI';
MPRINT(ETLS_LOADER):   attrib TAKVIM_AY_YIL length = $14 format = $14. informat = $14. label = 'TAKVIM_AY_YIL';
MPRINT(ETLS_LOADER):   attrib TUKETIM_P length = 8 label = 'TUKETIM_P';
MPRINT(ETLS_LOADER):   attrib SAYAC_CARPANI length = 8 format = 14.5 informat = 14.5 label = 'SAYAC_CARPANI';
MPRINT(ETLS_LOADER):   attrib ANLIK_DEMAND length = 8 label = 'ANLIK_DEMAND';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020 has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020(COMPRESS = YES) data = RISU.ANLIK_DEMAND_TEKTERIM_2020 
() force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending RISU.ANLIK_DEMAND_TEKTERIM_2020 to TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020.
NOTE: There were 89235252 observations read from the data set RISU.ANLIK_DEMAND_TEKTERIM_2020.
NOTE: 89235252 observations added.
NOTE: The data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020 has 89235252 observations and 6 variables.
NOTE: Compressing data set TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020 decreased size by 37.33 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           14:09.27
      cpu time            2:37.75
      

MPRINT(ETLS_LOADER):  ;
2642       
2643       %let etls_recCheckExist = 0;
2644       %let etls_recnt = 0;
2645       %macro etls_recordCheck;
2646          %let etls_recCheckExist = %eval(%sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020, DATA)) or
2647                %sysfunc(exist(TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020, VIEW)));
2648       
2649          %if (&etls_recCheckExist) %then
2650          %do;
2651             %local etls_syntaxcheck;
2652             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2653             /* Turn off syntaxcheck option to perform following steps  */
2654             options nosyntaxcheck;
2655       
2656             proc contents data = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020 out = work.etls_contents(keep = nobs) noprint;
2657             run;
2658       
2659             data _null_;
2660                set work.etls_contents (obs = 1);
2661                call symput("etls_recnt", left(put(nobs,32.)));
73                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2662             run;
2663       
2664             proc datasets lib = work nolist nowarn memtype = (data view);
2665                delete etls_contents;
2666             quit;
2667       
2668             /* Reset syntaxcheck option to previous setting  */
2669             options &etls_syntaxcheck;
2670          %end;
2671       %mend etls_recordCheck;
2672       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020 out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2673       
2674       
2675       
2676       /** Step end Table Loader **/
2677       
2678       /*---- Start of User Written Code  ----*/
2679       
2680       PROC SQL;
2681       CREATE TABLE TMPLIB3.ANLIK_DEMAND_TEKTERIM AS
2682       SELECT * FROM TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016
2683       UNION ALL
2684       SELECT * FROM TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017
2685       UNION ALL
2686       SELECT * FROM TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018
2687       UNION ALL
74                                                         The SAS System                            09:00 Tuesday, November 3, 2020

2688       SELECT * FROM TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019
2689       UNION ALL
2690       SELECT * FROM TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020
2691       ;
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: Physical Name: TMPLIB3
 SPDS_NOTE: Libref X0000001 was successfully assigned as follows: 
            Engine:        SPDSENG 
            Physical Name: :15729022/spdsmeta1/TMPLIB3/

 SPDS_NOTE: Libref TMPLIB3 was successfully assigned as follows: 
            Engine:        SPDSENG 
            Physical Name: :15729022/spdsmeta1/TMPLIB3/

NOTE: Implicit SQL: CREATE TABLE TMPLIB3.ANLIK_DEMAND_TEKTERIM as  select * from (  select * from (  select * from ( select 
      TXT_1.TESISAT, TXT_1.DAGITIM_BOLGESI, TXT_1.TAKVIM_AY_YIL, TXT_1.TUKETIM_P, TXT_1.SAYAC_CARPANI, TXT_1.ANLIK_DEMAND from 
      ANLIK_DEMAND_TEKTERIM_2016 TXT_1 union all select TXT_2.TESISAT, TXT_2.DAGITIM_BOLGESI, TXT_2.TAKVIM_AY_YIL, TXT_2.TUKETIM_P, 
      TXT_2.SAYAC_CARPANI, TXT_2.ANLIK_DEMAND from ANLIK_DEMAND_TEKTERIM_2017 TXT_2 ) TXT_0  union all select TXT_3.TESISAT, 
      TXT_3.DAGITIM_BOLGESI, TXT_3.TAKVIM_AY_YIL, TXT_3.TUKETIM_P, TXT_3.SAYAC_CARPANI, TXT_3.ANLIK_DEMAND from 
      ANLIK_DEMAND_TEKTERIM_2018 TXT_3 ) TXT_0  union all select TXT_4.TESISAT, TXT_4.DAGITIM_BOLGESI, TXT_4.TAKVIM_AY_YIL, 
      TXT_4.TUKETIM_P, TXT_4.SAYAC_CARPANI, TXT_4.ANLIK_DEMAND from ANLIK_DEMAND_TEKTERIM_2019 TXT_4 ) TXT_0  union all select 
      TXT_5.TESISAT, TXT_5.DAGITIM_BOLGESI, TXT_5.TAKVIM_AY_YIL, TXT_5.TUKETIM_P, TXT_5.SAYAC_CARPANI, TXT_5.ANLIK_DEMAND from 
      ANLIK_DEMAND_TEKTERIM_2020 TXT_5
 SPDS_NOTE: Table TMPLIB3.ANLIK_DEMAND_TEKTERIM created, with 407710653 rows and 6 columns.

2692       QUIT;
NOTE: PROCEDURE SQL used (Total process time):
      real time           19:43.36
      cpu time            0.00 seconds
      

2693       proc sql;
2694       drop table TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016;
NOTE: Table TMPLIB3.ANLIK_DEMAND_TEKTERIM_2016 has been dropped.
2695       drop table TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017;
NOTE: Table TMPLIB3.ANLIK_DEMAND_TEKTERIM_2017 has been dropped.
2696       drop table TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018;
NOTE: Table TMPLIB3.ANLIK_DEMAND_TEKTERIM_2018 has been dropped.
2697       drop table TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019;
NOTE: Table TMPLIB3.ANLIK_DEMAND_TEKTERIM_2019 has been dropped.
2698       drop table TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020;
NOTE: Table TMPLIB3.ANLIK_DEMAND_TEKTERIM_2020 has been dropped.
2699       quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           3.23 seconds
      cpu time            0.00 seconds
      

2700       /*---- End of User Written Code  ----*/
2701       
2702       /*---- Start of User Written Code  ----*/
2703       
2704       /*libname SMDM sasspds 'SMDM' server=eempa0.5400 user='anonymous';*/
2705       /*libname VYDM sasspds 'VYDM' server=eempa0.5400 user='anonymous';*/
2706       
2707       DATA VYDM.ANLIK_DEMAND_TEKTERIM;
2708       SET TMPLIB3.ANLIK_DEMAND_TEKTERIM;
2709       RUN;
75                                                         The SAS System                            09:00 Tuesday, November 3, 2020


NOTE: There were 407710653 observations read from the data set TMPLIB3.ANLIK_DEMAND_TEKTERIM.
NOTE: The data set VYDM.ANLIK_DEMAND_TEKTERIM has 407710653 observations and 6 variables.
NOTE: Compressing data set VYDM.ANLIK_DEMAND_TEKTERIM decreased size by 37.54 percent.
NOTE: DATA statement used (Total process time):
      real time           5:11.65
      cpu time            2:03.88
      

2710       
2711       DATA SMDM.ANLIK_DEMAND_TEKTERIM;
2712       SET TMPLIB3.ANLIK_DEMAND_TEKTERIM;
2713       RUN;

NOTE: There were 407710653 observations read from the data set TMPLIB3.ANLIK_DEMAND_TEKTERIM.
NOTE: The data set SMDM.ANLIK_DEMAND_TEKTERIM has 407710653 observations and 6 variables.
NOTE: Compressing data set SMDM.ANLIK_DEMAND_TEKTERIM decreased size by 37.54 percent.
NOTE: DATA statement used (Total process time):
      real time           5:26.70
      cpu time            2:06.55
      

2714       
2715       DATA SMDM.ANLIK_DEMAND_CIFTTERIM;
2716       SET TMPLIB3.ANLIK_DEMAND_CIFTTERIM;
2717       RUN;

NOTE: There were 16962 observations read from the data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM.
NOTE: The data set SMDM.ANLIK_DEMAND_CIFTTERIM has 16962 observations and 6 variables.
NOTE: Compressing data set SMDM.ANLIK_DEMAND_CIFTTERIM decreased size by 36.70 percent.
NOTE: DATA statement used (Total process time):
      real time           0.15 seconds
      cpu time            0.01 seconds
      

2718       
2719       DATA VYDM.ANLIK_DEMAND_CIFTTERIM;
2720       SET TMPLIB3.ANLIK_DEMAND_CIFTTERIM;
2721       RUN;

NOTE: There were 16962 observations read from the data set TMPLIB3.ANLIK_DEMAND_CIFTTERIM.
NOTE: The data set VYDM.ANLIK_DEMAND_CIFTTERIM has 16962 observations and 6 variables.
NOTE: Compressing data set VYDM.ANLIK_DEMAND_CIFTTERIM decreased size by 36.70 percent.
NOTE: DATA statement used (Total process time):
      real time           0.13 seconds
      cpu time            0.01 seconds
      

2722       
2723       /*---- End of User Written Code  ----*/
2724       
2725       %let etls_endTime = %sysfunc(datetime(),datetime.);
2726       

ERROR: Errors printed on page 6.

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
76                                                         The SAS System                            09:00 Tuesday, November 3, 2020

      real time           2:05:11.91
      cpu time            30:18.28
      


