NOTE: Log file opened at  Wed, 2 Dec 2020 09:30:00.825
1                                                          The SAS System                          09:30 Wednesday, December 2, 2020

ERROR: The SAS System is executing on a processor (CPU) whose model name, 
       model number, and serial number are not included in the setinit data 
       used to initialize the SAS System library in use. This is permitted if 
       this processor is a designated backup processor for a licensed CPU.
For this site, the SAS system is licensed for the following CPU serial 
numbers:
Model  **EEDPA0* Serial Number +4
ERROR: The requested node name EEDPA0 does not match the actual node name 
ERSDPA0.
NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M6) 
      Licensed to ENERJISA -TOROSLAR - DATA MANAGEMENT ADV PROD., Site 70166440.
NOTE: This session is executing on the AIX 7.2 (AIX 64) platform.



NOTE: Analytical products:
      
      SAS/STAT 15.1
      SAS/ETS 15.1

ERROR: The SAS System is executing on a processor (CPU) whose model name, model number, and serial number are not included in the 
       setinit data used to initialize the SAS System library in use. This is permitted if this processor is a designated backup 
       processor for a licensed CPU.
For this site, the SAS system is licensed for the following CPU serial numbers:

Model  **EEDPA0* Serial Number +4
ERROR: The requested node name EEDPA0 does not match the actual node name ERSDPA0.

WARNING: Your system is scheduled to expire on January 5, 2021, which is 34 days from now. The SAS System will no longer function 
         on or after that date. Please contact your SAS Installation Representative to obtain your updated SAS Installation Data 
         (SID) file, which includes SETINIT information.
To locate the name of your SAS Installation Representative go to http://support.sas.com/repfinder and provide your site number 
70166440 and company name as ENERJISA -TOROSLAR - DATA MANAGEMENT ADV PROD.. On the SAS REP list provided, locate the REP for 
operating system AIX 64.
NOTE: Additional host information:

IBM AIX AIX 64 2 7 00C9C0374C00 

You are running SAS 9. Some SAS 8 files will be automatically converted 
by the V9 engine; others are incompatible.  Please see 
http://support.sas.com/rnd/migration/planning/platform/64bit.html

PROC MIGRATE will preserve current SAS file attributes and is 
recommended for converting all your SAS libraries from any 
SAS 8 release to SAS 9.  For details and examples, please see
http://support.sas.com/rnd/migration/index.html


This message is contained in the SAS news file, and is presented upon
initialization.  Edit the file "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.




NOTE: SAS initialization used:
2                                                          The SAS System                          09:30 Wednesday, December 2, 2020

      real time           0.06 seconds
      cpu time            0.02 seconds
      
WARNING: The Base SAS Software product with which IOM CLSID:6E56FD51-CFC1-11D5-87BD-00C04F38F0DB is associated will be expiring 
         soon, and is currently in warning mode to indicate this upcoming expiration. Please run PROC SETINIT to obtain more 
         information on your warning period.
NOTE: This is a SPD 5.4  Engine 
      executing SAS (r) 9.4 (TS1M6) on the AIX platform.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
3                                                          The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
4                                                          The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: Libref SASDATA successfully assigned from logical server.
NOTE: Libref STPSAMP successfully assigned from logical server.
NOTE: Libref MIGLIB successfully assigned from logical server.
NOTE: Libref TRNLIB2 successfully assigned from logical server.
NOTE: Libref TRNLIB successfully assigned from logical server.
NOTE: Libref NEDLIB successfully assigned from logical server.
NOTE: Libref PILIB successfully assigned from logical server.
NOTE: Libref DMLIB successfully assigned from logical server.
NOTE: Libref TMPLIB3 successfully assigned from logical server.
NOTE: Libref TMPLIB4 successfully assigned from logical server.
NOTE: Libref ODSLIB successfully assigned from logical server.
NOTE: Libref ODSLIB2 successfully assigned from logical server.
NOTE: Libref ODSLIB3 successfully assigned from logical server.
NOTE: Libref PODSLIB1 successfully assigned from logical server.
NOTE: Libref PODSLIB2 successfully assigned from logical server.
NOTE: Libref PODSLIB3 successfully assigned from logical server.
NOTE: Libref DASHLIBD successfully assigned from logical server.
NOTE: Libref QLIKLIB successfully assigned from logical server.
WARNING: Libref SQLKODA may not have assigned correctly from logical server.
NOTE: The product with which the engine SQLSVR is associated will be expiring soon, and is currently in warning mode to indicate 
this upcoming expiration.  Please run PROC SETINIT to obtain more information on your warning period.
WARNING: Libref RISU may not have assigned correctly from logical server.
NOTE: The product with which the engine SAPHANA is associated will be expiring soon, and is currently in warning mode to indicate 
this upcoming expiration.  Please run PROC SETINIT to obtain more information on your warning period.
WARNING: Libref DQ_ORCL may not have assigned correctly from logical server.
NOTE: The product with which the engine ORACLE is associated will be expiring soon, and is currently in warning mode to indicate 
this upcoming expiration.  Please run PROC SETINIT to obtain more information on your warning period.
NOTE: Library ZGRLIB does not exist.
NOTE: Libref HANARWP successfully assigned from logical server.
NOTE: Libref BFLIB successfully assigned from logical server.
NOTE: Libref PILIB2 successfully assigned from logical server.
NOTE: Libref TMPLIB2 successfully assigned from logical server.
NOTE: Libref DMLIB2 successfully assigned from logical server.
NOTE: Libref ARCLIB successfully assigned from logical server.
NOTE: Libref IADM successfully assigned from logical server.
NOTE: Libref IATMP successfully assigned from logical server.
NOTE: Libref AUTODIAL successfully assigned from logical server.
NOTE: Libref BCSDM successfully assigned from logical server.
NOTE: Libref BLDM successfully assigned from logical server.
NOTE: Libref BLTMP successfully assigned from logical server.
NOTE: Libref BADM successfully assigned from logical server.
NOTE: Libref BATMP successfully assigned from logical server.
NOTE: Libref CCDM successfully assigned from logical server.
NOTE: Libref CCDM2 successfully assigned from logical server.
NOTE: Libref CMPDM successfully assigned from logical server.
5                                                          The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Libref CPSFRC successfully assigned from logical server.
NOTE: Libref CPSHRLY successfully assigned from logical server.
NOTE: Libref CPSREG successfully assigned from logical server.
NOTE: Libref CPSUST successfully assigned from logical server.
NOTE: Libref CXDM successfully assigned from logical server.
NOTE: Libref DBALIB successfully assigned from logical server.
NOTE: Libref DSTDM successfully assigned from logical server.
NOTE: Libref DSTTMP successfully assigned from logical server.
NOTE: Libref DYMDM successfully assigned from logical server.
NOTE: Libref DYMTMP successfully assigned from logical server.
NOTE: Libref EAP_ETY successfully assigned from logical server.
NOTE: Libref EAP_PAY successfully assigned from logical server.
NOTE: Libref EAP_PR successfully assigned from logical server.
NOTE: Libref EPYDM successfully assigned from logical server.
NOTE: Libref EPYTMP successfully assigned from logical server.
NOTE: Libref ETSDM successfully assigned from logical server.
NOTE: Libref FADM successfully assigned from logical server.
NOTE: Libref FPCLIB successfully assigned from logical server.
NOTE: Libref FPCTMP successfully assigned from logical server.
NOTE: Libref HRDM successfully assigned from logical server.
NOTE: Libref KMHMDM successfully assigned from logical server.
NOTE: Libref CSSLIB successfully assigned from logical server.
NOTE: Libref MDLIB successfully assigned from logical server.
NOTE: Libref MHMAYEDS successfully assigned from logical server.
NOTE: Libref MHMDM successfully assigned from logical server.
NOTE: Libref MIGLIB2 successfully assigned from logical server.
NOTE: Libref MSADM successfully assigned from logical server.
NOTE: Libref MSATMP successfully assigned from logical server.
NOTE: Libref MTHEO successfully assigned from logical server.
NOTE: Libref MTHKA successfully assigned from logical server.
NOTE: Libref MTHMA successfully assigned from logical server.
NOTE: Libref MTHSO successfully assigned from logical server.
NOTE: Libref MTHTMP successfully assigned from logical server.
NOTE: Libref D2DLIB successfully assigned from logical server.
NOTE: Libref OKMDM successfully assigned from logical server.
NOTE: Libref OKMTMP successfully assigned from logical server.
NOTE: Libref PMDM successfully assigned from logical server.
NOTE: Libref CNPRCDM successfully assigned from logical server.
NOTE: Libref CNPRCTMP successfully assigned from logical server.
NOTE: Libref EDULIB successfully assigned from logical server.
NOTE: Libref PRCDM successfully assigned from logical server.
NOTE: Libref PRCDM2 successfully assigned from logical server.
NOTE: Libref PRCTMP successfully assigned from logical server.
NOTE: Libref PRFTBLIB successfully assigned from logical server.
NOTE: Libref TMPLIB successfully assigned from logical server.
NOTE: Libref FRCARC successfully assigned from logical server.
NOTE: Libref FRCPRD successfully assigned from logical server.
NOTE: Libref PRCHARC successfully assigned from logical server.
NOTE: Libref PRCHPRD successfully assigned from logical server.
NOTE: Libref PRICARC successfully assigned from logical server.
NOTE: Libref PRICPRD successfully assigned from logical server.
NOTE: Libref QL_SALES successfully assigned from logical server.
NOTE: Libref RAPOUT successfully assigned from logical server.
NOTE: Libref RAPREF successfully assigned from logical server.
NOTE: Libref RAPTEST successfully assigned from logical server.
NOTE: Libref RAPTMP successfully assigned from logical server.
NOTE: Libref RAPVAS successfully assigned from logical server.
NOTE: Libref REFCPS successfully assigned from logical server.
6                                                          The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Libref RMCDM successfully assigned from logical server.
NOTE: Libref RMCTMP successfully assigned from logical server.
NOTE: Libref SDLIB successfully assigned from logical server.
NOTE: Libref SOMLIB successfully assigned from logical server.
NOTE: Libref SHFDM successfully assigned from logical server.
NOTE: Libref SODM successfully assigned from logical server.
NOTE: Libref SOPDM successfully assigned from logical server.
NOTE: Libref SOSUF successfully assigned from logical server.
NOTE: Libref SOTMP successfully assigned from logical server.
NOTE: Libref SPDM successfully assigned from logical server.
NOTE: Libref SSIMDM successfully assigned from logical server.
NOTE: Libref STLF successfully assigned from logical server.
NOTE: Libref SMDM successfully assigned from logical server.
NOTE: Libref SMTMP successfully assigned from logical server.
NOTE: Libref TALDM successfully assigned from logical server.
NOTE: Libref TKDM successfully assigned from logical server.
NOTE: Libref TSDM successfully assigned from logical server.
NOTE: Libref QVYDM successfully assigned from logical server.
NOTE: Libref STJVYDM successfully assigned from logical server.
NOTE: Libref VYDM successfully assigned from logical server.
NOTE: Libref VYDMKVKK successfully assigned from logical server.
NOTE: Libref OGMDM successfully assigned from logical server.
NOTE: Libref OGMTMP successfully assigned from logical server.
NOTE: Libref CRLIB successfully assigned from logical server.
NOTE: Libref RASTMP successfully assigned from logical server.
NOTE: Libref SOSEC successfully assigned from logical server.
NOTE: Libref STATLIB successfully assigned from logical server.
ERROR: Libref SMARTHMP failed to assign from logical server.
ERROR: ORACLE connection error: ORA-12514: TNS: Dinleyici þu anda baðlantý açýklayýcýsýnda belirtilen hizmeti tanýmýyor..
ERROR: Libref SMARTHMT failed to assign from logical server.
ERROR: ORACLE connection error: ORA-12514: TNS: Dinleyici þu anda baðlantý açýklayýcýsýnda belirtilen hizmeti tanýmýyor..
ERROR: Libref SMSPRD failed to assign from logical server.
ERROR: ORACLE connection error: ORA-12170: TNS: Baðlantý zaman aþýmý oluþtu.
NOTE: Libref RAPARCH successfully assigned from logical server.
NOTE: Libref SAHOL successfully assigned from logical server.
NOTE: Libref MKVR successfully assigned from logical server.
NOTE: Libref RODQLIK successfully assigned from logical server.
NOTE: Libref UTFLIB successfully assigned from logical server.

NOTE: AUTOEXEC processing beginning; file is /sas/config/Lev1/SASApp/BatchServer/autoexec.sas.


NOTE: AUTOEXEC processing completed.

1          /****************************************************************************
2           * Job:             Extract RWP D2D Tables - 1            A57BXQB4.BT00008A *
3           * Description:                                                             *
4           *                                                                          *
5           * Metadata Server: ersupa0.enerjisa.local                                  *
6           * Port:            8561                                                    *
7           * Location:        /Data Integration/Jobs/9. Extraction_Tr/3. Master Data  *
8           *                   - RWP                                                  *
9           *                                                                          *
10          * Server:          SASApp                                A57BXQB4.AS000002 *
11          *                                                                          *
12          * Source Tables:   _BIC_TZMUSTTIPC - -                   A57BXQB4.BE0001S9 *
13          *                   SAPrwp./BIC/TZMUSTTIPC                                 *
14          *                  _BI0_TUCRATEFAKT - Texts: Char. Rate  A57BXQB4.BE0001S7 *
7                                                          The SAS System                          09:30 Wednesday, December 2, 2020

15          *                   Fact Group - SAPrwp./BI0/TUCRATEFAKT                   *
16          *                  _BI0_TCRM_USSTAT - -                  A57BXQB4.BE0001S5 *
17          *                   SAPrwp./BI0/TCRM_USSTAT                                *
18          *                  _BI0_TCRM_PRCTYP - -                  A57BXQB4.BE0001S3 *
19          *                   SAPrwp./BI0/TCRM_PRCTYP                                *
20          *                  _BI0_TCAT_CODE - -                    A57BXQB4.BE0001S1 *
21          *                   SAPrwp./BI0/TCAT_CODE                                  *
22          *                  _BI0_TBPARTNER - Texts: Char.         A57BXQB4.BE0001RZ *
23          *                  Business Partner -                                      *
24          *                   SAPrwp./BI0/TBPARTNER                                  *
25          *                  _BI0_TCAT_GROUP - -                   A57BXQB4.BE0001SB *
26          *                   SAPrwp./BI0/TCAT_GROUP                                 *
27          *                  _BI0_TCAT_TYPE - -                    A57BXQB4.BE0001SD *
28          *                   SAPrwp./BI0/TCAT_TYPE                                  *
29          *                  _BIC_AZCRMHB00 - -                    A57BXQB4.BE0001SF *
30          *                   SAPrwp./BIC/AZCRMHB00                                  *
31          *                  _BIC_TZCALLTYP - -                    A57BXQB4.BE0001SH *
32          *                   SAPrwp./BIC/TZCALLTYP                                  *
33          *                  _BIC_TZCASETYPE - -                   A57BXQB4.BE0001SJ *
34          *                   SAPrwp./BIC/TZCASETYPE                                 *
35          *                  _BIC_TZINPUTC - -                     A57BXQB4.BE0001SL *
36          *                   SAPrwp./BIC/TZINPUTC                                   *
37          *                  _BIC_TZZAFLD02 - -                    A57BXQB4.BE0001SN *
38          *                   SAPrwp./BIC/TZZAFLD02                                  *
39          *                  _BIC_AZCRMD2D00 - -                   A57BXQB4.BE00058B *
40          *                   SAPrwp./BIC/AZCRMD2D00                                 *
41          * Target Tables:   RWP_TZMUSTTIPC -                      A57BXQB4.BE0001SA *
42          *                   PODSLIB1.RWP_TZMUSTTIPC                                *
43          *                  RWP_TUCRATEFAKT -                     A57BXQB4.BE0001S8 *
44          *                   PODSLIB1.RWP_TUCRATEFAKT                               *
45          *                  RWP_TCRM_USSTAT -                     A57BXQB4.BE0001S6 *
46          *                   PODSLIB1.RWP_TCRM_USSTAT                               *
47          *                  RWP_TCRM_PRCTYP -                     A57BXQB4.BE0001S4 *
48          *                   PODSLIB1.RWP_TCRM_PRCTYP                               *
49          *                  RWP_TCAT_CODE -                       A57BXQB4.BE0001S2 *
50          *                   PODSLIB1.RWP_TCAT_CODE                                 *
51          *                  RWP_TBPARTNER -                       A57BXQB4.BE0001S0 *
52          *                   PODSLIB1.RWP_TBPARTNER                                 *
53          *                  RWP_TCAT_GROUP -                      A57BXQB4.BE0001SC *
54          *                   PODSLIB1.RWP_TCAT_GROUP                                *
55          *                  RWP_TCAT_TYPE -                       A57BXQB4.BE0001SE *
56          *                   PODSLIB1.RWP_TCAT_TYPE                                 *
57          *                  RWP_AZCRMHB00 -                       A57BXQB4.BE0001SG *
58          *                   PODSLIB1.RWP_AZCRMHB00                                 *
59          *                  RWP_TZCALLTYP -                       A57BXQB4.BE0001SI *
60          *                   PODSLIB1.RWP_TZCALLTYP                                 *
61          *                  RWP_TZCASETYPE -                      A57BXQB4.BE0001SK *
62          *                   PODSLIB1.RWP_TZCASETYPE                                *
63          *                  RWP_TZINPUTC - PODSLIB1.RWP_TZINPUTC  A57BXQB4.BE0001SM *
64          *                  RWP_TZZAFLD02 -                       A57BXQB4.BE0001SO *
65          *                   PODSLIB1.RWP_TZZAFLD02                                 *
66          *                  RWP_AZCRMD2D00 -                      A57BXQB4.BE0001SQ *
67          *                   PODSLIB1.RWP_AZCRMD2D00                                *
68          *                                                                          *
69          * Generated on:    Thursday, September 17, 2020 4:50:40 PM EET             *
70          * Generated by:    sas                                                     *
71          * Version:         SAS Data Integration Studio 4.904                       *
72          ****************************************************************************/
8                                                          The SAS System                          09:30 Wednesday, December 2, 2020

73         
74         /* Generate the process id for job  */
75         %put Process ID: &SYSJOBID;
Process ID: 6881920
76         
77         /* General macro variables  */
78         %let jobID = %quote(A57BXQB4.BT00008A);
79         %let etls_jobName = %nrquote(Extract RWP D2D Tables - 1);
80         %let etls_userID = %nrquote(sas);
81         
82         /* Setup to capture return codes  */
83         %global job_rc trans_rc sqlrc;
84         %let sysrc = 0;
85         %let job_rc = 0;
86         %let trans_rc = 0;
87         %let sqlrc = 0;
88         %global etls_stepStartTime;
89         /* initialize syserr to 0 */
90         data _null_; run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

91         
92         %macro rcSet(error);
93            %if (&error gt &trans_rc) %then
94               %let trans_rc = &error;
95            %if (&error gt &job_rc) %then
96               %let job_rc = &error;
97         %mend rcSet;
98         
99         %macro rcSetDS(error);
100           if &error gt input(symget('trans_rc'),12.) then
101              call symput('trans_rc',trim(left(put(&error,12.))));
102           if &error gt input(symget('job_rc'),12.) then
103              call symput('job_rc',trim(left(put(&error,12.))));
104        %mend rcSetDS;
105        
106        /* Create metadata macro variables */
107        %let IOMServer      = %nrquote(SASApp);
108        %let metaPort       = %nrquote(8561);
109        %let metaServer     = %nrquote(ersupa0.enerjisa.local);
110        
111        /* Setup for capturing job status  */
112        %let etls_startTime = %sysfunc(datetime(),datetime.);
113        %let etls_recordsBefore = 0;
114        %let etls_recordsAfter = 0;
115        %let etls_lib = 0;
116        %let etls_table = 0;
117        
118        %global etls_debug;
119        %macro etls_setDebug;
120           %if %str(&etls_debug) ne 0 %then
121              OPTIONS MPRINT%str(;);
122        %mend;
123        %etls_setDebug;
9                                                          The SAS System                          09:30 Wednesday, December 2, 2020

124        
125        /*==========================================================================*
126         * Step:            Table Loader                          A57BXQB4.BV00012L *
127         * Transform:       Table Loader (Version 2.1)                              *
128         * Description:                                                             *
129         *                                                                          *
130         * Source Table:    _BI0_TBPARTNER - Texts: Char.         A57BXQB4.BE0001RZ *
131         *                  Business Partner -                                      *
132         *                   SAPrwp./BI0/TBPARTNER                                  *
133         * Target Table:    RWP_TBPARTNER -                       A57BXQB4.BE0001S0 *
134         *                   PODSLIB1.RWP_TBPARTNER                                 *
135         *==========================================================================*/
136        
137        %let transformID = %quote(A57BXQB4.BV00012L);
138        %let trans_rc = 0;
139        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
140        
141        /* Access the data for RWP  */
142        LIBNAME SAPrwp SASIOSR3  ashost="errwpa0.enerjisa.retail"  sysnr=30  BatchMode=1  trace=0  language=EN  Client=500
142      ! AUTHDOMAIN="RWP" ;
NOTE:  Credential obtained from SAS metadata server.
NOTE: Libref SAPRWP was successfully assigned as follows: 
      Engine:        R3 
      Physical Name: errwpa0.enerjisa.retail
143        %rcSet(&syslibrc);
144        
145        %let SYSLAST = %nrquote(SAPrwp."/BI0/TBPARTNER"n);
146        
147        %global etls_sql_pushDown;
148        %let etls_sql_pushDown = -1;
149        option DBIDIRECTEXEC;
150        
151        %global etls_tableExist;
152        %global etls_numIndex;
153        %global etls_lastTable;
154        %let etls_tableExist = -1;
155        %let etls_numIndex = -1;
156        %let etls_lastTable = &SYSLAST;
157        
158        /*---- Define load data macro  ----*/
159        
160        /* --------------------------------------------------------------
161           Load Technique Selection: Replace - EntireTable
162           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
163           Additional options selections...
164              Set unmapped to missing on updates: false
165           -------------------------------------------------------------- */
166        %macro etls_loader;
167        
168           %let etls_tableOptions = ;
169        
170           /* Determine if the target table exists  */
171           %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TBPARTNER"n, DATA)) or
172                 %sysfunc(exist(PODSLIB1."RWP_TBPARTNER"n, VIEW)));
173        
174           %if &etls_tableExist %then
175           %do;/* table exists  */
176              %let etls_hasPreExistingConstraint=0;
10                                                         The SAS System                          09:30 Wednesday, December 2, 2020

177        
178              proc datasets lib = work nolist nowarn memtype = (data view);
179                 delete etls_commands etls_commands_F;
180              quit;
181        
182              %let etls_otherTablesReferToThisTable=0;
183        
184              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
185                 %put NOTE: Building table listing Constraints and Indexes for: &table;
186                 proc datasets lib=work nolist; delete &workTableOut; quit;
187                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
188        
189                 data &workTableOut;
190                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
191                    name = '';
192                    type = '';
193                    icown = '';
194                    idxUnique = '';
195                    idxNoMiss = '';
196                    recreate = '';
197                    set &workTableOut;
198                    ref = '';
199                    type=upcase(type);
200                    if type eq 'REFERENTIAL' then
201                    do;
202                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
203                            " another table: " ref;
204                       call symput('etls_otherTablesReferToThisTable','1');
205                       delete;
206                    end;
207                    if type='INDEX' and ICOwn eq 'YES' then delete;
208                 run;
209                 %rcSet(&syserr);
210        
211              %mend etls_CIContents;
212        
213              %etls_CIContents(table=PODSLIB1."RWP_TBPARTNER"n, workTableOut=etls_commands, inDSOptions=);
214        
215              %if &etls_otherTablesReferToThisTable %then
216                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
216      ! constraints.;
217              %else
218              %do; /* okay - remove foreign keys  */
219        
220                 data etls_commands_F;
221                    set etls_commands;
222                    if upcase(type)="FOREIGN KEY" then
223                    do;
224                       command='ic delete '||trim(name)||';';
225                       output etls_commands_F;
226                    end;
227                 run;
228        
229                 %put %str(NOTE: Removing foreign keys before dropping table...);
230                 data _null_;
231                    set etls_commands_F end=eof;
232                    if _n_=1 then
233                       call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TBPARTNER"n;');
11                                                         The SAS System                          09:30 Wednesday, December 2, 2020

234                    call execute(command);
235                    if eof then call execute('; quit;');
236                 run;
237                 %rcSet(&syserr);
238        
239           %end; /* okay - remove foreign keys  */
240        
241           proc datasets lib = work nolist nowarn memtype = (data view);
242              delete etls_commands etls_commands_F;
243           quit;
244        
245           /*---- Drop a table  ----*/
246           %put %str(NOTE: Dropping table ...);
247           proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
248              delete "RWP_TBPARTNER"n;
249           quit;
250        
251           %rcSet(&syserr);
252        
253           %let etls_tableExist = 0;
254        
255        %end; /* table exists  */
256        
257        /*---- Create a new table  ----*/
258        %if (&etls_tableExist eq 0) %then
259        %do;  /* if table does not exist  */
260        
261           %put %str(NOTE: Creating table ...);
262        
263           data PODSLIB1."RWP_TBPARTNER"n
264                   (label = 'Texts: Char. Business Partner'
265                    COMPRESS = YES);
266              attrib "BPARTNER"n length = $10
267                 format = $10.
268                 label = 'Business Partner';
269              attrib "TXTSH"n length = $20
270                 format = $20.
271                 label = 'Short description';
272              attrib "TXTMD"n length = $40
273                 format = $40.
274                 label = 'Medium description';
275              attrib "TXTLG"n length = $60
276                 format = $60.
277                 label = 'Long description';
278              call missing(of _all_);
279              stop;
280           run;
281        
282           %rcSet(&syserr);
283        
284        %end;  /* if table does not exist  */
285        
286        /*---- Append  ----*/
287        %put %str(NOTE: Appending data ...);
288        
289        proc append base = PODSLIB1."RWP_TBPARTNER"n(COMPRESS = YES)
290           data = &etls_lastTable (&etls_tableOptions)  force ;
291         run;
12                                                         The SAS System                          09:30 Wednesday, December 2, 2020

292        
293        %rcSet(&syserr);
294        
295        %mend etls_loader;
296        %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.03 seconds
      cpu time            0.02 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TBPARTNER"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TBPARTNER"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
13                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TBPARTNER"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TBPARTNER"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TBPARTNER (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           2.31 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
14                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TBPARTNER"n (label = 'Texts: Char. Business Partner' COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "BPARTNER"n length = $10 format = $10. label = 'Business Partner';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TBPARTNER has 0 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TBPARTNER"n(COMPRESS = YES) data = SAPRWP.'/BI0/TBPARTNER'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TBPARTNER'n to PODSLIB1.RWP_TBPARTNER.
WARNING: Some character data was lost during transcoding in the dataset SAPRWP.'/BI0/TBPARTNER'n. Either the data contains 
         characters that are not representable in the new encoding or truncation occurred during transcoding.
NOTE: There were 2278084 observations read from the data set SAPRWP.'/BI0/TBPARTNER'n.
NOTE: 13182839 observations added.
NOTE: The data set PODSLIB1.RWP_TBPARTNER has 13182839 observations and 4 variables.
NOTE: Compressing data set PODSLIB1.RWP_TBPARTNER decreased size by 58.94 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           3:08.50
      cpu time            26.53 seconds
      

MPRINT(ETLS_LOADER):  ;
297        
298        %let etls_recCheckExist = 0;
299        %let etls_recnt = 0;
300        %macro etls_recordCheck;
301           %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TBPARTNER"n, DATA)) or
302                 %sysfunc(exist(PODSLIB1."RWP_TBPARTNER"n, VIEW)));
303        
304           %if (&etls_recCheckExist) %then
305           %do;
306              %local etls_syntaxcheck;
307              %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
308              /* Turn off syntaxcheck option to perform following steps  */
309              options nosyntaxcheck;
310        
311              proc contents data = PODSLIB1."RWP_TBPARTNER"n out = work.etls_contents(keep = nobs) noprint;
312              run;
313        
314              data _null_;
315                 set work.etls_contents (obs = 1);
316                 call symput("etls_recnt", left(put(nobs,32.)));
317              run;
318        
319              proc datasets lib = work nolist nowarn memtype = (data view);
320                 delete etls_contents;
321              quit;
15                                                         The SAS System                          09:30 Wednesday, December 2, 2020

322        
323              /* Reset syntaxcheck option to previous setting  */
324              options &etls_syntaxcheck;
325           %end;
326        %mend etls_recordCheck;
327        %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TBPARTNER"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 4 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
328        
329        
330        
331        /** Step end Table Loader **/
332        
333        /*==========================================================================*
334         * Step:            Table Loader                          A57BXQB4.BV00012M *
335         * Transform:       Table Loader (Version 2.1)                              *
336         * Description:                                                             *
337         *                                                                          *
338         * Source Table:    _BI0_TCAT_CODE - -                    A57BXQB4.BE0001S1 *
339         *                   SAPrwp."/BI0/TCAT_CODE"n                               *
340         * Target Table:    RWP_TCAT_CODE -                       A57BXQB4.BE0001S2 *
341         *                   PODSLIB1."RWP_TCAT_CODE"n                              *
342         *==========================================================================*/
343        
344        %let transformID = %quote(A57BXQB4.BV00012M);
345        %let trans_rc = 0;
346        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
347        
16                                                         The SAS System                          09:30 Wednesday, December 2, 2020

348        %let SYSLAST = %nrquote(SAPrwp."/BI0/TCAT_CODE"n);
349        
350        %global etls_sql_pushDown;
351        %let etls_sql_pushDown = -1;
352        option DBIDIRECTEXEC;
353        
354        %global etls_tableExist;
355        %global etls_numIndex;
356        %global etls_lastTable;
357        %let etls_tableExist = -1;
358        %let etls_numIndex = -1;
359        %let etls_lastTable = &SYSLAST;
360        
361        /*---- Define load data macro  ----*/
362        
363        /* --------------------------------------------------------------
364           Load Technique Selection: Replace - EntireTable
365           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
366           Additional options selections...
367              Set unmapped to missing on updates: false
368           -------------------------------------------------------------- */
369        %macro etls_loader;
370        
371           %let etls_tableOptions = ;
372        
373           /* Determine if the target table exists  */
374           %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCAT_CODE"n, DATA)) or
375                 %sysfunc(exist(PODSLIB1."RWP_TCAT_CODE"n, VIEW)));
376        
377           %if &etls_tableExist %then
378           %do;/* table exists  */
379              %let etls_hasPreExistingConstraint=0;
380        
381              proc datasets lib = work nolist nowarn memtype = (data view);
382                 delete etls_commands etls_commands_F;
383              quit;
384        
385              %let etls_otherTablesReferToThisTable=0;
386        
387              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
388                 %put NOTE: Building table listing Constraints and Indexes for: &table;
389                 proc datasets lib=work nolist; delete &workTableOut; quit;
390                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
391        
392                 data &workTableOut;
393                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
394                    name = '';
395                    type = '';
396                    icown = '';
397                    idxUnique = '';
398                    idxNoMiss = '';
399                    recreate = '';
400                    set &workTableOut;
401                    ref = '';
402                    type=upcase(type);
403                    if type eq 'REFERENTIAL' then
404                    do;
405                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
17                                                         The SAS System                          09:30 Wednesday, December 2, 2020

406                            " another table: " ref;
407                       call symput('etls_otherTablesReferToThisTable','1');
408                       delete;
409                    end;
410                    if type='INDEX' and ICOwn eq 'YES' then delete;
411                 run;
412                 %rcSet(&syserr);
413        
414              %mend etls_CIContents;
415        
416              %etls_CIContents(table=PODSLIB1."RWP_TCAT_CODE"n, workTableOut=etls_commands, inDSOptions=);
417        
418              %if &etls_otherTablesReferToThisTable %then
419                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
419      ! constraints.;
420              %else
421              %do; /* okay - remove foreign keys  */
422        
423                 data etls_commands_F;
424                    set etls_commands;
425                    if upcase(type)="FOREIGN KEY" then
426                    do;
427                       command='ic delete '||trim(name)||';';
428                       output etls_commands_F;
429                    end;
430                 run;
431        
432                 %put %str(NOTE: Removing foreign keys before dropping table...);
433                 data _null_;
434                    set etls_commands_F end=eof;
435                    if _n_=1 then
436                       call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCAT_CODE"n;');
437                    call execute(command);
438                    if eof then call execute('; quit;');
439                 run;
440                 %rcSet(&syserr);
441        
442           %end; /* okay - remove foreign keys  */
443        
444           proc datasets lib = work nolist nowarn memtype = (data view);
445              delete etls_commands etls_commands_F;
446           quit;
447        
448           /*---- Drop a table  ----*/
449           %put %str(NOTE: Dropping table ...);
450           proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
451              delete "RWP_TCAT_CODE"n;
452           quit;
453        
454           %rcSet(&syserr);
455        
456           %let etls_tableExist = 0;
457        
458        %end; /* table exists  */
459        
460        /*---- Create a new table  ----*/
461        %if (&etls_tableExist eq 0) %then
462        %do;  /* if table does not exist  */
18                                                         The SAS System                          09:30 Wednesday, December 2, 2020

463        
464           %put %str(NOTE: Creating table ...);
465        
466           data PODSLIB1."RWP_TCAT_CODE"n
467                   (COMPRESS = YES);
468              attrib "CAT_TYPE"n length = $2
469                 format = $2.
470                 label = 'Catalog';
471              attrib "CAT_GROUP"n length = $8
472                 format = $8.
473                 label = 'Code Group';
474              attrib "CAT_CODE"n length = $4
475                 format = $4.
476                 label = 'Code';
477              attrib "LANGU"n length = $1
478                 format = $1.
479                 label = 'Language Key';
480              attrib "TXTMD"n length = $40
481                 format = $40.
482                 label = 'Medium description';
483              call missing(of _all_);
484              stop;
485           run;
486        
487           %rcSet(&syserr);
488        
489        %end;  /* if table does not exist  */
490        
491        /*---- Append  ----*/
492        %put %str(NOTE: Appending data ...);
493        
494        proc append base = PODSLIB1."RWP_TCAT_CODE"n(COMPRESS = YES)
495           data = &etls_lastTable (&etls_tableOptions)  force ;
496         run;
497        
498        %rcSet(&syserr);
499        
500        %mend etls_loader;
501        %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TCAT_CODE"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
19                                                         The SAS System                          09:30 Wednesday, December 2, 2020


MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TCAT_CODE"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCAT_CODE"n;');
MPRINT(ETLS_LOADER):   call execute(command);
20                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TCAT_CODE"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TCAT_CODE (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           1.86 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TCAT_CODE"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "CAT_TYPE"n length = $2 format = $2. label = 'Catalog';
MPRINT(ETLS_LOADER):   attrib "CAT_GROUP"n length = $8 format = $8. label = 'Code Group';
MPRINT(ETLS_LOADER):   attrib "CAT_CODE"n length = $4 format = $4. label = 'Code';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TCAT_CODE has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TCAT_CODE"n(COMPRESS = YES) data = SAPRWP.'/BI0/TCAT_CODE'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TCAT_CODE'n to PODSLIB1.RWP_TCAT_CODE.
WARNING: Some character data was lost during transcoding in the dataset SAPRWP.'/BI0/TCAT_CODE'n. Either the data contains 
         characters that are not representable in the new encoding or truncation occurred during transcoding.
21                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: There were 540 observations read from the data set SAPRWP.'/BI0/TCAT_CODE'n.
NOTE: 4352 observations added.
NOTE: The data set PODSLIB1.RWP_TCAT_CODE has 4352 observations and 5 variables.
NOTE: Compressing data set PODSLIB1.RWP_TCAT_CODE decreased size by 33.66 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.68 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
502        
503        %let etls_recCheckExist = 0;
504        %let etls_recnt = 0;
505        %macro etls_recordCheck;
506           %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCAT_CODE"n, DATA)) or
507                 %sysfunc(exist(PODSLIB1."RWP_TCAT_CODE"n, VIEW)));
508        
509           %if (&etls_recCheckExist) %then
510           %do;
511              %local etls_syntaxcheck;
512              %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
513              /* Turn off syntaxcheck option to perform following steps  */
514              options nosyntaxcheck;
515        
516              proc contents data = PODSLIB1."RWP_TCAT_CODE"n out = work.etls_contents(keep = nobs) noprint;
517              run;
518        
519              data _null_;
520                 set work.etls_contents (obs = 1);
521                 call symput("etls_recnt", left(put(nobs,32.)));
522              run;
523        
524              proc datasets lib = work nolist nowarn memtype = (data view);
525                 delete etls_contents;
526              quit;
527        
528              /* Reset syntaxcheck option to previous setting  */
529              options &etls_syntaxcheck;
530           %end;
531        %mend etls_recordCheck;
532        %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TCAT_CODE"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 5 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
22                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
533        
534        
535        
536        /** Step end Table Loader **/
537        
538        /*==========================================================================*
539         * Step:            Table Loader                          A57BXQB4.BV00012N *
540         * Transform:       Table Loader (Version 2.1)                              *
541         * Description:                                                             *
542         *                                                                          *
543         * Source Table:    _BI0_TCRM_PRCTYP - -                  A57BXQB4.BE0001S3 *
544         *                   SAPrwp."/BI0/TCRM_PRCTYP"n                             *
545         * Target Table:    RWP_TCRM_PRCTYP -                     A57BXQB4.BE0001S4 *
546         *                   PODSLIB1."RWP_TCRM_PRCTYP"n                            *
547         *==========================================================================*/
548        
549        %let transformID = %quote(A57BXQB4.BV00012N);
550        %let trans_rc = 0;
551        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
552        
553        %let SYSLAST = %nrquote(SAPrwp."/BI0/TCRM_PRCTYP"n);
554        
555        %global etls_sql_pushDown;
556        %let etls_sql_pushDown = -1;
557        option DBIDIRECTEXEC;
558        
559        %global etls_tableExist;
560        %global etls_numIndex;
561        %global etls_lastTable;
562        %let etls_tableExist = -1;
563        %let etls_numIndex = -1;
564        %let etls_lastTable = &SYSLAST;
565        
566        /*---- Define load data macro  ----*/
567        
568        /* --------------------------------------------------------------
569           Load Technique Selection: Replace - EntireTable
570           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
571           Additional options selections...
572              Set unmapped to missing on updates: false
573           -------------------------------------------------------------- */
574        %macro etls_loader;
575        
23                                                         The SAS System                          09:30 Wednesday, December 2, 2020

576           %let etls_tableOptions = ;
577        
578           /* Determine if the target table exists  */
579           %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCRM_PRCTYP"n, DATA)) or
580                 %sysfunc(exist(PODSLIB1."RWP_TCRM_PRCTYP"n, VIEW)));
581        
582           %if &etls_tableExist %then
583           %do;/* table exists  */
584              %let etls_hasPreExistingConstraint=0;
585        
586              proc datasets lib = work nolist nowarn memtype = (data view);
587                 delete etls_commands etls_commands_F;
588              quit;
589        
590              %let etls_otherTablesReferToThisTable=0;
591        
592              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
593                 %put NOTE: Building table listing Constraints and Indexes for: &table;
594                 proc datasets lib=work nolist; delete &workTableOut; quit;
595                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
596        
597                 data &workTableOut;
598                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
599                    name = '';
600                    type = '';
601                    icown = '';
602                    idxUnique = '';
603                    idxNoMiss = '';
604                    recreate = '';
605                    set &workTableOut;
606                    ref = '';
607                    type=upcase(type);
608                    if type eq 'REFERENTIAL' then
609                    do;
610                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
611                            " another table: " ref;
612                       call symput('etls_otherTablesReferToThisTable','1');
613                       delete;
614                    end;
615                    if type='INDEX' and ICOwn eq 'YES' then delete;
616                 run;
617                 %rcSet(&syserr);
618        
619              %mend etls_CIContents;
620        
621              %etls_CIContents(table=PODSLIB1."RWP_TCRM_PRCTYP"n, workTableOut=etls_commands, inDSOptions=);
622        
623              %if &etls_otherTablesReferToThisTable %then
624                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
624      ! constraints.;
625              %else
626              %do; /* okay - remove foreign keys  */
627        
628                 data etls_commands_F;
629                    set etls_commands;
630                    if upcase(type)="FOREIGN KEY" then
631                    do;
632                       command='ic delete '||trim(name)||';';
24                                                         The SAS System                          09:30 Wednesday, December 2, 2020

633                       output etls_commands_F;
634                    end;
635                 run;
636        
637                 %put %str(NOTE: Removing foreign keys before dropping table...);
638                 data _null_;
639                    set etls_commands_F end=eof;
640                    if _n_=1 then
641                       call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCRM_PRCTYP"n;');
642                    call execute(command);
643                    if eof then call execute('; quit;');
644                 run;
645                 %rcSet(&syserr);
646        
647           %end; /* okay - remove foreign keys  */
648        
649           proc datasets lib = work nolist nowarn memtype = (data view);
650              delete etls_commands etls_commands_F;
651           quit;
652        
653           /*---- Drop a table  ----*/
654           %put %str(NOTE: Dropping table ...);
655           proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
656              delete "RWP_TCRM_PRCTYP"n;
657           quit;
658        
659           %rcSet(&syserr);
660        
661           %let etls_tableExist = 0;
662        
663        %end; /* table exists  */
664        
665        /*---- Create a new table  ----*/
666        %if (&etls_tableExist eq 0) %then
667        %do;  /* if table does not exist  */
668        
669           %put %str(NOTE: Creating table ...);
670        
671           data PODSLIB1."RWP_TCRM_PRCTYP"n
672                   (COMPRESS = YES);
673              attrib "CRM_PRCTYP"n length = $4
674                 format = $4.
675                 label = 'Business Transaction Type';
676              attrib "LANGU"n length = $1
677                 format = $1.
678                 label = 'Language Key';
679              attrib "TXTSH"n length = $20
680                 format = $20.
681                 label = 'Short description';
682              attrib "TXTMD"n length = $40
683                 format = $40.
684                 label = 'Medium description';
685              call missing(of _all_);
686              stop;
687           run;
688        
689           %rcSet(&syserr);
690        
25                                                         The SAS System                          09:30 Wednesday, December 2, 2020

691        %end;  /* if table does not exist  */
692        
693        /*---- Append  ----*/
694        %put %str(NOTE: Appending data ...);
695        
696        proc append base = PODSLIB1."RWP_TCRM_PRCTYP"n(COMPRESS = YES)
697           data = &etls_lastTable (&etls_tableOptions)  force ;
698         run;
699        
700        %rcSet(&syserr);
701        
702        %mend etls_loader;
703        %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TCRM_PRCTYP"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TCRM_PRCTYP"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
26                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCRM_PRCTYP"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TCRM_PRCTYP"n;
MPRINT(ETLS_LOADER):   quit;

27                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Deleting PODSLIB1.RWP_TCRM_PRCTYP (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.06 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TCRM_PRCTYP"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "CRM_PRCTYP"n length = $4 format = $4. label = 'Business Transaction Type';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TCRM_PRCTYP has 0 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TCRM_PRCTYP"n(COMPRESS = YES) data = SAPRWP.'/BI0/TCRM_PRCTYP'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TCRM_PRCTYP'n to PODSLIB1.RWP_TCRM_PRCTYP.
NOTE: There were 1011 observations read from the data set SAPRWP.'/BI0/TCRM_PRCTYP'n.
NOTE: 1011 observations added.
NOTE: The data set PODSLIB1.RWP_TCRM_PRCTYP has 1011 observations and 4 variables.
NOTE: Compressing data set PODSLIB1.RWP_TCRM_PRCTYP decreased size by 27.16 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.82 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
704        
705        %let etls_recCheckExist = 0;
706        %let etls_recnt = 0;
707        %macro etls_recordCheck;
708           %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCRM_PRCTYP"n, DATA)) or
709                 %sysfunc(exist(PODSLIB1."RWP_TCRM_PRCTYP"n, VIEW)));
710        
711           %if (&etls_recCheckExist) %then
712           %do;
713              %local etls_syntaxcheck;
714              %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
715              /* Turn off syntaxcheck option to perform following steps  */
716              options nosyntaxcheck;
717        
718              proc contents data = PODSLIB1."RWP_TCRM_PRCTYP"n out = work.etls_contents(keep = nobs) noprint;
719              run;
720        
721              data _null_;
722                 set work.etls_contents (obs = 1);
28                                                         The SAS System                          09:30 Wednesday, December 2, 2020

723                 call symput("etls_recnt", left(put(nobs,32.)));
724              run;
725        
726              proc datasets lib = work nolist nowarn memtype = (data view);
727                 delete etls_contents;
728              quit;
729        
730              /* Reset syntaxcheck option to previous setting  */
731              options &etls_syntaxcheck;
732           %end;
733        %mend etls_recordCheck;
734        %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TCRM_PRCTYP"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 4 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
735        
736        
737        
738        /** Step end Table Loader **/
739        
740        /*==========================================================================*
741         * Step:            Table Loader                          A57BXQB4.BV00012O *
742         * Transform:       Table Loader (Version 2.1)                              *
743         * Description:                                                             *
744         *                                                                          *
745         * Source Table:    _BI0_TCRM_USSTAT - -                  A57BXQB4.BE0001S5 *
746         *                   SAPrwp."/BI0/TCRM_USSTAT"n                             *
747         * Target Table:    RWP_TCRM_USSTAT -                     A57BXQB4.BE0001S6 *
748         *                   PODSLIB1."RWP_TCRM_USSTAT"n                            *
29                                                         The SAS System                          09:30 Wednesday, December 2, 2020

749         *==========================================================================*/
750        
751        %let transformID = %quote(A57BXQB4.BV00012O);
752        %let trans_rc = 0;
753        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
754        
755        %let SYSLAST = %nrquote(SAPrwp."/BI0/TCRM_USSTAT"n);
756        
757        %global etls_sql_pushDown;
758        %let etls_sql_pushDown = -1;
759        option DBIDIRECTEXEC;
760        
761        %global etls_tableExist;
762        %global etls_numIndex;
763        %global etls_lastTable;
764        %let etls_tableExist = -1;
765        %let etls_numIndex = -1;
766        %let etls_lastTable = &SYSLAST;
767        
768        /*---- Define load data macro  ----*/
769        
770        /* --------------------------------------------------------------
771           Load Technique Selection: Replace - EntireTable
772           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
773           Additional options selections...
774              Set unmapped to missing on updates: false
775           -------------------------------------------------------------- */
776        %macro etls_loader;
777        
778           %let etls_tableOptions = ;
779        
780           /* Determine if the target table exists  */
781           %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCRM_USSTAT"n, DATA)) or
782                 %sysfunc(exist(PODSLIB1."RWP_TCRM_USSTAT"n, VIEW)));
783        
784           %if &etls_tableExist %then
785           %do;/* table exists  */
786              %let etls_hasPreExistingConstraint=0;
787        
788              proc datasets lib = work nolist nowarn memtype = (data view);
789                 delete etls_commands etls_commands_F;
790              quit;
791        
792              %let etls_otherTablesReferToThisTable=0;
793        
794              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
795                 %put NOTE: Building table listing Constraints and Indexes for: &table;
796                 proc datasets lib=work nolist; delete &workTableOut; quit;
797                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
798        
799                 data &workTableOut;
800                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
801                    name = '';
802                    type = '';
803                    icown = '';
804                    idxUnique = '';
805                    idxNoMiss = '';
806                    recreate = '';
30                                                         The SAS System                          09:30 Wednesday, December 2, 2020

807                    set &workTableOut;
808                    ref = '';
809                    type=upcase(type);
810                    if type eq 'REFERENTIAL' then
811                    do;
812                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
813                            " another table: " ref;
814                       call symput('etls_otherTablesReferToThisTable','1');
815                       delete;
816                    end;
817                    if type='INDEX' and ICOwn eq 'YES' then delete;
818                 run;
819                 %rcSet(&syserr);
820        
821              %mend etls_CIContents;
822        
823              %etls_CIContents(table=PODSLIB1."RWP_TCRM_USSTAT"n, workTableOut=etls_commands, inDSOptions=);
824        
825              %if &etls_otherTablesReferToThisTable %then
826                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
826      ! constraints.;
827              %else
828              %do; /* okay - remove foreign keys  */
829        
830                 data etls_commands_F;
831                    set etls_commands;
832                    if upcase(type)="FOREIGN KEY" then
833                    do;
834                       command='ic delete '||trim(name)||';';
835                       output etls_commands_F;
836                    end;
837                 run;
838        
839                 %put %str(NOTE: Removing foreign keys before dropping table...);
840                 data _null_;
841                    set etls_commands_F end=eof;
842                    if _n_=1 then
843                       call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCRM_USSTAT"n;');
844                    call execute(command);
845                    if eof then call execute('; quit;');
846                 run;
847                 %rcSet(&syserr);
848        
849           %end; /* okay - remove foreign keys  */
850        
851           proc datasets lib = work nolist nowarn memtype = (data view);
852              delete etls_commands etls_commands_F;
853           quit;
854        
855           /*---- Drop a table  ----*/
856           %put %str(NOTE: Dropping table ...);
857           proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
858              delete "RWP_TCRM_USSTAT"n;
859           quit;
860        
861           %rcSet(&syserr);
862        
863           %let etls_tableExist = 0;
31                                                         The SAS System                          09:30 Wednesday, December 2, 2020

864        
865        %end; /* table exists  */
866        
867        /*---- Create a new table  ----*/
868        %if (&etls_tableExist eq 0) %then
869        %do;  /* if table does not exist  */
870        
871           %put %str(NOTE: Creating table ...);
872        
873           data PODSLIB1."RWP_TCRM_USSTAT"n
874                   (COMPRESS = YES);
875              attrib "CRM_STSMA"n length = $8
876                 format = $8.
877                 label = 'Status Profile';
878              attrib "CRM_USSTAT"n length = $5
879                 format = $5.
880                 label = 'User Status';
881              attrib "LANGU"n length = $1
882                 format = $1.
883                 label = 'Language Key';
884              attrib "TXTSH"n length = $20
885                 format = $20.
886                 label = 'Short description';
887              attrib "TXTMD"n length = $40
888                 format = $40.
889                 label = 'Medium description';
890              attrib "TXTLG"n length = $60
891                 format = $60.
892                 label = 'Long description';
893              call missing(of _all_);
894              stop;
895           run;
896        
897           %rcSet(&syserr);
898        
899        %end;  /* if table does not exist  */
900        
901        /*---- Append  ----*/
902        %put %str(NOTE: Appending data ...);
903        
904        proc append base = PODSLIB1."RWP_TCRM_USSTAT"n(COMPRESS = YES)
905           data = &etls_lastTable (&etls_tableOptions)  force ;
906         run;
907        
908        %rcSet(&syserr);
909        
910        %mend etls_loader;
911        %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TCRM_USSTAT"n
32                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TCRM_USSTAT"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
33                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCRM_USSTAT"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TCRM_USSTAT"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TCRM_USSTAT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.05 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TCRM_USSTAT"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "CRM_STSMA"n length = $8 format = $8. label = 'Status Profile';
MPRINT(ETLS_LOADER):   attrib "CRM_USSTAT"n length = $5 format = $5. label = 'User Status';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TCRM_USSTAT has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
34                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TCRM_USSTAT"n(COMPRESS = YES) data = SAPRWP.'/BI0/TCRM_USSTAT'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TCRM_USSTAT'n to PODSLIB1.RWP_TCRM_USSTAT.
WARNING: Some character data was lost during transcoding in the dataset SAPRWP.'/BI0/TCRM_USSTAT'n. Either the data contains 
         characters that are not representable in the new encoding or truncation occurred during transcoding.
NOTE: There were 787 observations read from the data set SAPRWP.'/BI0/TCRM_USSTAT'n.
NOTE: 958 observations added.
NOTE: The data set PODSLIB1.RWP_TCRM_USSTAT has 958 observations and 6 variables.
NOTE: Compressing data set PODSLIB1.RWP_TCRM_USSTAT decreased size by 60.12 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.97 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
912        
913        %let etls_recCheckExist = 0;
914        %let etls_recnt = 0;
915        %macro etls_recordCheck;
916           %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCRM_USSTAT"n, DATA)) or
917                 %sysfunc(exist(PODSLIB1."RWP_TCRM_USSTAT"n, VIEW)));
918        
919           %if (&etls_recCheckExist) %then
920           %do;
921              %local etls_syntaxcheck;
922              %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
923              /* Turn off syntaxcheck option to perform following steps  */
924              options nosyntaxcheck;
925        
926              proc contents data = PODSLIB1."RWP_TCRM_USSTAT"n out = work.etls_contents(keep = nobs) noprint;
927              run;
928        
929              data _null_;
930                 set work.etls_contents (obs = 1);
931                 call symput("etls_recnt", left(put(nobs,32.)));
932              run;
933        
934              proc datasets lib = work nolist nowarn memtype = (data view);
935                 delete etls_contents;
936              quit;
937        
938              /* Reset syntaxcheck option to previous setting  */
939              options &etls_syntaxcheck;
940           %end;
941        %mend etls_recordCheck;
942        %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TCRM_USSTAT"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
35                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
943        
944        
945        
946        /** Step end Table Loader **/
947        
948        /*==========================================================================*
949         * Step:            Table Loader                          A57BXQB4.BV00012P *
950         * Transform:       Table Loader (Version 2.1)                              *
951         * Description:                                                             *
952         *                                                                          *
953         * Source Table:    _BI0_TUCRATEFAKT - Texts: Char. Rate  A57BXQB4.BE0001S7 *
954         *                  Fact Group -                                            *
955         *                   SAPrwp."/BI0/TUCRATEFAKT"n                             *
956         * Target Table:    RWP_TUCRATEFAKT -                     A57BXQB4.BE0001S8 *
957         *                   PODSLIB1."RWP_TUCRATEFAKT"n                            *
958         *==========================================================================*/
959        
960        %let transformID = %quote(A57BXQB4.BV00012P);
961        %let trans_rc = 0;
962        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
963        
964        %let SYSLAST = %nrquote(SAPrwp."/BI0/TUCRATEFAKT"n);
965        
966        %global etls_sql_pushDown;
967        %let etls_sql_pushDown = -1;
968        option DBIDIRECTEXEC;
969        
970        %global etls_tableExist;
971        %global etls_numIndex;
972        %global etls_lastTable;
973        %let etls_tableExist = -1;
974        %let etls_numIndex = -1;
975        %let etls_lastTable = &SYSLAST;
36                                                         The SAS System                          09:30 Wednesday, December 2, 2020

976        
977        /*---- Define load data macro  ----*/
978        
979        /* --------------------------------------------------------------
980           Load Technique Selection: Replace - EntireTable
981           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
982           Additional options selections...
983              Set unmapped to missing on updates: false
984           -------------------------------------------------------------- */
985        %macro etls_loader;
986        
987           %let etls_tableOptions = ;
988        
989           /* Determine if the target table exists  */
990           %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TUCRATEFAKT"n, DATA)) or
991                 %sysfunc(exist(PODSLIB1."RWP_TUCRATEFAKT"n, VIEW)));
992        
993           %if &etls_tableExist %then
994           %do;/* table exists  */
995              %let etls_hasPreExistingConstraint=0;
996        
997              proc datasets lib = work nolist nowarn memtype = (data view);
998                 delete etls_commands etls_commands_F;
999              quit;
1000       
1001             %let etls_otherTablesReferToThisTable=0;
1002       
1003             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1004                %put NOTE: Building table listing Constraints and Indexes for: &table;
1005                proc datasets lib=work nolist; delete &workTableOut; quit;
1006                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1007       
1008                data &workTableOut;
1009                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1010                   name = '';
1011                   type = '';
1012                   icown = '';
1013                   idxUnique = '';
1014                   idxNoMiss = '';
1015                   recreate = '';
1016                   set &workTableOut;
1017                   ref = '';
1018                   type=upcase(type);
1019                   if type eq 'REFERENTIAL' then
1020                   do;
1021                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1022                           " another table: " ref;
1023                      call symput('etls_otherTablesReferToThisTable','1');
1024                      delete;
1025                   end;
1026                   if type='INDEX' and ICOwn eq 'YES' then delete;
1027                run;
1028                %rcSet(&syserr);
1029       
1030             %mend etls_CIContents;
1031       
1032             %etls_CIContents(table=PODSLIB1."RWP_TUCRATEFAKT"n, workTableOut=etls_commands, inDSOptions=);
1033       
37                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1034             %if &etls_otherTablesReferToThisTable %then
1035                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1035     ! constraints.;
1036             %else
1037             %do; /* okay - remove foreign keys  */
1038       
1039                data etls_commands_F;
1040                   set etls_commands;
1041                   if upcase(type)="FOREIGN KEY" then
1042                   do;
1043                      command='ic delete '||trim(name)||';';
1044                      output etls_commands_F;
1045                   end;
1046                run;
1047       
1048                %put %str(NOTE: Removing foreign keys before dropping table...);
1049                data _null_;
1050                   set etls_commands_F end=eof;
1051                   if _n_=1 then
1052                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TUCRATEFAKT"n;');
1053                   call execute(command);
1054                   if eof then call execute('; quit;');
1055                run;
1056                %rcSet(&syserr);
1057       
1058          %end; /* okay - remove foreign keys  */
1059       
1060          proc datasets lib = work nolist nowarn memtype = (data view);
1061             delete etls_commands etls_commands_F;
1062          quit;
1063       
1064          /*---- Drop a table  ----*/
1065          %put %str(NOTE: Dropping table ...);
1066          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
1067             delete "RWP_TUCRATEFAKT"n;
1068          quit;
1069       
1070          %rcSet(&syserr);
1071       
1072          %let etls_tableExist = 0;
1073       
1074       %end; /* table exists  */
1075       
1076       /*---- Create a new table  ----*/
1077       %if (&etls_tableExist eq 0) %then
1078       %do;  /* if table does not exist  */
1079       
1080          %put %str(NOTE: Creating table ...);
1081       
1082          data PODSLIB1."RWP_TUCRATEFAKT"n
1083                  (label = 'Texts: Char. Rate Fact Group'
1084                   COMPRESS = YES);
1085             attrib "UCRATEFAKT"n length = $10
1086                format = $10.
1087                label = 'Rate Fact Group';
1088             attrib "LANGU"n length = $1
1089                format = $1.
1090                label = 'Language Key';
38                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1091             attrib "TXTMD"n length = $40
1092                format = $40.
1093                label = 'Medium description';
1094             call missing(of _all_);
1095             stop;
1096          run;
1097       
1098          %rcSet(&syserr);
1099       
1100       %end;  /* if table does not exist  */
1101       
1102       /*---- Append  ----*/
1103       %put %str(NOTE: Appending data ...);
1104       
1105       proc append base = PODSLIB1."RWP_TUCRATEFAKT"n(COMPRESS = YES)
1106          data = &etls_lastTable (&etls_tableOptions)  force ;
1107        run;
1108       
1109       %rcSet(&syserr);
1110       
1111       %mend etls_loader;
1112       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TUCRATEFAKT"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TUCRATEFAKT"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
39                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TUCRATEFAKT"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
40                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TUCRATEFAKT"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TUCRATEFAKT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.05 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TUCRATEFAKT"n (label = 'Texts: Char. Rate Fact Group' COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "UCRATEFAKT"n length = $10 format = $10. label = 'Rate Fact Group';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TUCRATEFAKT has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TUCRATEFAKT"n(COMPRESS = YES) data = SAPRWP.'/BI0/TUCRATEFAKT'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TUCRATEFAKT'n to PODSLIB1.RWP_TUCRATEFAKT.
NOTE: There were 149 observations read from the data set SAPRWP.'/BI0/TUCRATEFAKT'n.
NOTE: 149 observations added.
NOTE: The data set PODSLIB1.RWP_TUCRATEFAKT has 149 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TUCRATEFAKT decreased size by 35.50 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.71 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
1113       
1114       %let etls_recCheckExist = 0;
1115       %let etls_recnt = 0;
1116       %macro etls_recordCheck;
1117          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TUCRATEFAKT"n, DATA)) or
1118                %sysfunc(exist(PODSLIB1."RWP_TUCRATEFAKT"n, VIEW)));
1119       
1120          %if (&etls_recCheckExist) %then
1121          %do;
1122             %local etls_syntaxcheck;
1123             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
41                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1124             /* Turn off syntaxcheck option to perform following steps  */
1125             options nosyntaxcheck;
1126       
1127             proc contents data = PODSLIB1."RWP_TUCRATEFAKT"n out = work.etls_contents(keep = nobs) noprint;
1128             run;
1129       
1130             data _null_;
1131                set work.etls_contents (obs = 1);
1132                call symput("etls_recnt", left(put(nobs,32.)));
1133             run;
1134       
1135             proc datasets lib = work nolist nowarn memtype = (data view);
1136                delete etls_contents;
1137             quit;
1138       
1139             /* Reset syntaxcheck option to previous setting  */
1140             options &etls_syntaxcheck;
1141          %end;
1142       %mend etls_recordCheck;
1143       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TUCRATEFAKT"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1144       
1145       
1146       
1147       /** Step end Table Loader **/
1148       
1149       /*==========================================================================*
42                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1150        * Step:            Table Loader                          A57BXQB4.BV00012Q *
1151        * Transform:       Table Loader (Version 2.1)                              *
1152        * Description:                                                             *
1153        *                                                                          *
1154        * Source Table:    _BIC_TZMUSTTIPC - -                   A57BXQB4.BE0001S9 *
1155        *                   SAPrwp."/BIC/TZMUSTTIPC"n                              *
1156        * Target Table:    RWP_TZMUSTTIPC -                      A57BXQB4.BE0001SA *
1157        *                   PODSLIB1."RWP_TZMUSTTIPC"n                             *
1158        *==========================================================================*/
1159       
1160       %let transformID = %quote(A57BXQB4.BV00012Q);
1161       %let trans_rc = 0;
1162       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1163       
1164       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZMUSTTIPC"n);
1165       
1166       %global etls_sql_pushDown;
1167       %let etls_sql_pushDown = -1;
1168       option DBIDIRECTEXEC;
1169       
1170       %global etls_tableExist;
1171       %global etls_numIndex;
1172       %global etls_lastTable;
1173       %let etls_tableExist = -1;
1174       %let etls_numIndex = -1;
1175       %let etls_lastTable = &SYSLAST;
1176       
1177       /*---- Define load data macro  ----*/
1178       
1179       /* --------------------------------------------------------------
1180          Load Technique Selection: Replace - EntireTable
1181          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1182          Additional options selections...
1183             Set unmapped to missing on updates: false
1184          -------------------------------------------------------------- */
1185       %macro etls_loader;
1186       
1187          %let etls_tableOptions = ;
1188       
1189          /* Determine if the target table exists  */
1190          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZMUSTTIPC"n, DATA)) or
1191                %sysfunc(exist(PODSLIB1."RWP_TZMUSTTIPC"n, VIEW)));
1192       
1193          %if &etls_tableExist %then
1194          %do;/* table exists  */
1195             %let etls_hasPreExistingConstraint=0;
1196       
1197             proc datasets lib = work nolist nowarn memtype = (data view);
1198                delete etls_commands etls_commands_F;
1199             quit;
1200       
1201             %let etls_otherTablesReferToThisTable=0;
1202       
1203             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1204                %put NOTE: Building table listing Constraints and Indexes for: &table;
1205                proc datasets lib=work nolist; delete &workTableOut; quit;
1206                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1207       
43                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1208                data &workTableOut;
1209                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1210                   name = '';
1211                   type = '';
1212                   icown = '';
1213                   idxUnique = '';
1214                   idxNoMiss = '';
1215                   recreate = '';
1216                   set &workTableOut;
1217                   ref = '';
1218                   type=upcase(type);
1219                   if type eq 'REFERENTIAL' then
1220                   do;
1221                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1222                           " another table: " ref;
1223                      call symput('etls_otherTablesReferToThisTable','1');
1224                      delete;
1225                   end;
1226                   if type='INDEX' and ICOwn eq 'YES' then delete;
1227                run;
1228                %rcSet(&syserr);
1229       
1230             %mend etls_CIContents;
1231       
1232             %etls_CIContents(table=PODSLIB1."RWP_TZMUSTTIPC"n, workTableOut=etls_commands, inDSOptions=);
1233       
1234             %if &etls_otherTablesReferToThisTable %then
1235                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1235     ! constraints.;
1236             %else
1237             %do; /* okay - remove foreign keys  */
1238       
1239                data etls_commands_F;
1240                   set etls_commands;
1241                   if upcase(type)="FOREIGN KEY" then
1242                   do;
1243                      command='ic delete '||trim(name)||';';
1244                      output etls_commands_F;
1245                   end;
1246                run;
1247       
1248                %put %str(NOTE: Removing foreign keys before dropping table...);
1249                data _null_;
1250                   set etls_commands_F end=eof;
1251                   if _n_=1 then
1252                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZMUSTTIPC"n;');
1253                   call execute(command);
1254                   if eof then call execute('; quit;');
1255                run;
1256                %rcSet(&syserr);
1257       
1258          %end; /* okay - remove foreign keys  */
1259       
1260          proc datasets lib = work nolist nowarn memtype = (data view);
1261             delete etls_commands etls_commands_F;
1262          quit;
1263       
1264          /*---- Drop a table  ----*/
44                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1265          %put %str(NOTE: Dropping table ...);
1266          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
1267             delete "RWP_TZMUSTTIPC"n;
1268          quit;
1269       
1270          %rcSet(&syserr);
1271       
1272          %let etls_tableExist = 0;
1273       
1274       %end; /* table exists  */
1275       
1276       /*---- Create a new table  ----*/
1277       %if (&etls_tableExist eq 0) %then
1278       %do;  /* if table does not exist  */
1279       
1280          %put %str(NOTE: Creating table ...);
1281       
1282          data PODSLIB1."RWP_TZMUSTTIPC"n
1283                  (COMPRESS = YES);
1284             attrib "_BIC_ZMUSTTIPC"n length = $2
1285                format = $2.;
1286             attrib "TXTSH"n length = $20
1287                format = $20.
1288                label = 'Short description';
1289             attrib "TXTMD"n length = $40
1290                format = $40.
1291                label = 'Medium description';
1292             attrib "TXTLG"n length = $60
1293                format = $60.
1294                label = 'Long description';
1295             call missing(of _all_);
1296             stop;
1297          run;
1298       
1299          %rcSet(&syserr);
1300       
1301       %end;  /* if table does not exist  */
1302       
1303       /*---- Append  ----*/
1304       %put %str(NOTE: Appending data ...);
1305       
1306       proc append base = PODSLIB1."RWP_TZMUSTTIPC"n(COMPRESS = YES)
1307          data = &etls_lastTable (&etls_tableOptions)  force ;
1308        run;
1309       
1310       %rcSet(&syserr);
1311       
1312       %mend etls_loader;
1313       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

45                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZMUSTTIPC"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZMUSTTIPC"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
46                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZMUSTTIPC"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZMUSTTIPC"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZMUSTTIPC (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.07 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZMUSTTIPC"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZMUSTTIPC"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZMUSTTIPC has 0 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
47                                                         The SAS System                          09:30 Wednesday, December 2, 2020


MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZMUSTTIPC"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZMUSTTIPC'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZMUSTTIPC'n to PODSLIB1.RWP_TZMUSTTIPC.
NOTE: There were 0 observations read from the data set SAPRWP.'/BIC/TZMUSTTIPC'n.
NOTE: 0 observations added.
NOTE: The data set PODSLIB1.RWP_TZMUSTTIPC has 0 observations and 4 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.70 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
1314       
1315       %let etls_recCheckExist = 0;
1316       %let etls_recnt = 0;
1317       %macro etls_recordCheck;
1318          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZMUSTTIPC"n, DATA)) or
1319                %sysfunc(exist(PODSLIB1."RWP_TZMUSTTIPC"n, VIEW)));
1320       
1321          %if (&etls_recCheckExist) %then
1322          %do;
1323             %local etls_syntaxcheck;
1324             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1325             /* Turn off syntaxcheck option to perform following steps  */
1326             options nosyntaxcheck;
1327       
1328             proc contents data = PODSLIB1."RWP_TZMUSTTIPC"n out = work.etls_contents(keep = nobs) noprint;
1329             run;
1330       
1331             data _null_;
1332                set work.etls_contents (obs = 1);
1333                call symput("etls_recnt", left(put(nobs,32.)));
1334             run;
1335       
1336             proc datasets lib = work nolist nowarn memtype = (data view);
1337                delete etls_contents;
1338             quit;
1339       
1340             /* Reset syntaxcheck option to previous setting  */
1341             options &etls_syntaxcheck;
1342          %end;
1343       %mend etls_recordCheck;
1344       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZMUSTTIPC"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 4 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
48                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1345       
1346       
1347       
1348       /** Step end Table Loader **/
1349       
1350       /*==========================================================================*
1351        * Step:            Table Loader                          A57BXQB4.BV00012R *
1352        * Transform:       Table Loader (Version 2.1)                              *
1353        * Description:                                                             *
1354        *                                                                          *
1355        * Source Table:    _BI0_TCAT_GROUP - -                   A57BXQB4.BE0001SB *
1356        *                   SAPrwp."/BI0/TCAT_GROUP"n                              *
1357        * Target Table:    RWP_TCAT_GROUP -                      A57BXQB4.BE0001SC *
1358        *                   PODSLIB1."RWP_TCAT_GROUP"n                             *
1359        *==========================================================================*/
1360       
1361       %let transformID = %quote(A57BXQB4.BV00012R);
1362       %let trans_rc = 0;
1363       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1364       
1365       %let SYSLAST = %nrquote(SAPrwp."/BI0/TCAT_GROUP"n);
1366       
1367       %global etls_sql_pushDown;
1368       %let etls_sql_pushDown = -1;
1369       option DBIDIRECTEXEC;
1370       
1371       %global etls_tableExist;
1372       %global etls_numIndex;
1373       %global etls_lastTable;
1374       %let etls_tableExist = -1;
1375       %let etls_numIndex = -1;
1376       %let etls_lastTable = &SYSLAST;
1377       
1378       /*---- Define load data macro  ----*/
1379       
1380       /* --------------------------------------------------------------
1381          Load Technique Selection: Replace - EntireTable
49                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1382          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1383          Additional options selections...
1384             Set unmapped to missing on updates: false
1385          -------------------------------------------------------------- */
1386       %macro etls_loader;
1387       
1388          %let etls_tableOptions = ;
1389       
1390          /* Determine if the target table exists  */
1391          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCAT_GROUP"n, DATA)) or
1392                %sysfunc(exist(PODSLIB1."RWP_TCAT_GROUP"n, VIEW)));
1393       
1394          %if &etls_tableExist %then
1395          %do;/* table exists  */
1396             %let etls_hasPreExistingConstraint=0;
1397       
1398             proc datasets lib = work nolist nowarn memtype = (data view);
1399                delete etls_commands etls_commands_F;
1400             quit;
1401       
1402             %let etls_otherTablesReferToThisTable=0;
1403       
1404             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1405                %put NOTE: Building table listing Constraints and Indexes for: &table;
1406                proc datasets lib=work nolist; delete &workTableOut; quit;
1407                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1408       
1409                data &workTableOut;
1410                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1411                   name = '';
1412                   type = '';
1413                   icown = '';
1414                   idxUnique = '';
1415                   idxNoMiss = '';
1416                   recreate = '';
1417                   set &workTableOut;
1418                   ref = '';
1419                   type=upcase(type);
1420                   if type eq 'REFERENTIAL' then
1421                   do;
1422                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1423                           " another table: " ref;
1424                      call symput('etls_otherTablesReferToThisTable','1');
1425                      delete;
1426                   end;
1427                   if type='INDEX' and ICOwn eq 'YES' then delete;
1428                run;
1429                %rcSet(&syserr);
1430       
1431             %mend etls_CIContents;
1432       
1433             %etls_CIContents(table=PODSLIB1."RWP_TCAT_GROUP"n, workTableOut=etls_commands, inDSOptions=);
1434       
1435             %if &etls_otherTablesReferToThisTable %then
1436                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1436     ! constraints.;
1437             %else
1438             %do; /* okay - remove foreign keys  */
50                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1439       
1440                data etls_commands_F;
1441                   set etls_commands;
1442                   if upcase(type)="FOREIGN KEY" then
1443                   do;
1444                      command='ic delete '||trim(name)||';';
1445                      output etls_commands_F;
1446                   end;
1447                run;
1448       
1449                %put %str(NOTE: Removing foreign keys before dropping table...);
1450                data _null_;
1451                   set etls_commands_F end=eof;
1452                   if _n_=1 then
1453                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCAT_GROUP"n;');
1454                   call execute(command);
1455                   if eof then call execute('; quit;');
1456                run;
1457                %rcSet(&syserr);
1458       
1459          %end; /* okay - remove foreign keys  */
1460       
1461          proc datasets lib = work nolist nowarn memtype = (data view);
1462             delete etls_commands etls_commands_F;
1463          quit;
1464       
1465          /*---- Drop a table  ----*/
1466          %put %str(NOTE: Dropping table ...);
1467          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
1468             delete "RWP_TCAT_GROUP"n;
1469          quit;
1470       
1471          %rcSet(&syserr);
1472       
1473          %let etls_tableExist = 0;
1474       
1475       %end; /* table exists  */
1476       
1477       /*---- Create a new table  ----*/
1478       %if (&etls_tableExist eq 0) %then
1479       %do;  /* if table does not exist  */
1480       
1481          %put %str(NOTE: Creating table ...);
1482       
1483          data PODSLIB1."RWP_TCAT_GROUP"n
1484                  (COMPRESS = YES);
1485             attrib "CAT_TYPE"n length = $2
1486                format = $2.
1487                label = 'Catalog';
1488             attrib "CAT_GROUP"n length = $8
1489                format = $8.
1490                label = 'Code Group';
1491             attrib "LANGU"n length = $1
1492                format = $1.
1493                label = 'Language Key';
1494             attrib "TXTMD"n length = $40
1495                format = $40.
1496                label = 'Medium description';
51                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1497             call missing(of _all_);
1498             stop;
1499          run;
1500       
1501          %rcSet(&syserr);
1502       
1503       %end;  /* if table does not exist  */
1504       
1505       /*---- Append  ----*/
1506       %put %str(NOTE: Appending data ...);
1507       
1508       proc append base = PODSLIB1."RWP_TCAT_GROUP"n(COMPRESS = YES)
1509          data = &etls_lastTable (&etls_tableOptions)  force ;
1510        run;
1511       
1512       %rcSet(&syserr);
1513       
1514       %mend etls_loader;
1515       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TCAT_GROUP"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TCAT_GROUP"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
52                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCAT_GROUP"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
53                                                         The SAS System                          09:30 Wednesday, December 2, 2020


NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TCAT_GROUP"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TCAT_GROUP (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TCAT_GROUP"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "CAT_TYPE"n length = $2 format = $2. label = 'Catalog';
MPRINT(ETLS_LOADER):   attrib "CAT_GROUP"n length = $8 format = $8. label = 'Code Group';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TCAT_GROUP has 0 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TCAT_GROUP"n(COMPRESS = YES) data = SAPRWP.'/BI0/TCAT_GROUP'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TCAT_GROUP'n to PODSLIB1.RWP_TCAT_GROUP.
NOTE: There were 652 observations read from the data set SAPRWP.'/BI0/TCAT_GROUP'n.
NOTE: 652 observations added.
NOTE: The data set PODSLIB1.RWP_TCAT_GROUP has 652 observations and 4 variables.
NOTE: Compressing data set PODSLIB1.RWP_TCAT_GROUP decreased size by 29.75 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.48 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
1516       
1517       %let etls_recCheckExist = 0;
1518       %let etls_recnt = 0;
1519       %macro etls_recordCheck;
1520          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCAT_GROUP"n, DATA)) or
1521                %sysfunc(exist(PODSLIB1."RWP_TCAT_GROUP"n, VIEW)));
1522       
1523          %if (&etls_recCheckExist) %then
1524          %do;
1525             %local etls_syntaxcheck;
1526             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1527             /* Turn off syntaxcheck option to perform following steps  */
1528             options nosyntaxcheck;
54                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1529       
1530             proc contents data = PODSLIB1."RWP_TCAT_GROUP"n out = work.etls_contents(keep = nobs) noprint;
1531             run;
1532       
1533             data _null_;
1534                set work.etls_contents (obs = 1);
1535                call symput("etls_recnt", left(put(nobs,32.)));
1536             run;
1537       
1538             proc datasets lib = work nolist nowarn memtype = (data view);
1539                delete etls_contents;
1540             quit;
1541       
1542             /* Reset syntaxcheck option to previous setting  */
1543             options &etls_syntaxcheck;
1544          %end;
1545       %mend etls_recordCheck;
1546       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TCAT_GROUP"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 4 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1547       
1548       
1549       
1550       /** Step end Table Loader **/
1551       
1552       /*==========================================================================*
1553        * Step:            Table Loader                          A57BXQB4.BV00012S *
1554        * Transform:       Table Loader (Version 2.1)                              *
55                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1555        * Description:                                                             *
1556        *                                                                          *
1557        * Source Table:    _BI0_TCAT_TYPE - -                    A57BXQB4.BE0001SD *
1558        *                   SAPrwp."/BI0/TCAT_TYPE"n                               *
1559        * Target Table:    RWP_TCAT_TYPE -                       A57BXQB4.BE0001SE *
1560        *                   PODSLIB1."RWP_TCAT_TYPE"n                              *
1561        *==========================================================================*/
1562       
1563       %let transformID = %quote(A57BXQB4.BV00012S);
1564       %let trans_rc = 0;
1565       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1566       
1567       %let SYSLAST = %nrquote(SAPrwp."/BI0/TCAT_TYPE"n);
1568       
1569       %global etls_sql_pushDown;
1570       %let etls_sql_pushDown = -1;
1571       option DBIDIRECTEXEC;
1572       
1573       %global etls_tableExist;
1574       %global etls_numIndex;
1575       %global etls_lastTable;
1576       %let etls_tableExist = -1;
1577       %let etls_numIndex = -1;
1578       %let etls_lastTable = &SYSLAST;
1579       
1580       /*---- Define load data macro  ----*/
1581       
1582       /* --------------------------------------------------------------
1583          Load Technique Selection: Replace - EntireTable
1584          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1585          Additional options selections...
1586             Set unmapped to missing on updates: false
1587          -------------------------------------------------------------- */
1588       %macro etls_loader;
1589       
1590          %let etls_tableOptions = ;
1591       
1592          /* Determine if the target table exists  */
1593          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCAT_TYPE"n, DATA)) or
1594                %sysfunc(exist(PODSLIB1."RWP_TCAT_TYPE"n, VIEW)));
1595       
1596          %if &etls_tableExist %then
1597          %do;/* table exists  */
1598             %let etls_hasPreExistingConstraint=0;
1599       
1600             proc datasets lib = work nolist nowarn memtype = (data view);
1601                delete etls_commands etls_commands_F;
1602             quit;
1603       
1604             %let etls_otherTablesReferToThisTable=0;
1605       
1606             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1607                %put NOTE: Building table listing Constraints and Indexes for: &table;
1608                proc datasets lib=work nolist; delete &workTableOut; quit;
1609                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1610       
1611                data &workTableOut;
1612                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
56                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1613                   name = '';
1614                   type = '';
1615                   icown = '';
1616                   idxUnique = '';
1617                   idxNoMiss = '';
1618                   recreate = '';
1619                   set &workTableOut;
1620                   ref = '';
1621                   type=upcase(type);
1622                   if type eq 'REFERENTIAL' then
1623                   do;
1624                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1625                           " another table: " ref;
1626                      call symput('etls_otherTablesReferToThisTable','1');
1627                      delete;
1628                   end;
1629                   if type='INDEX' and ICOwn eq 'YES' then delete;
1630                run;
1631                %rcSet(&syserr);
1632       
1633             %mend etls_CIContents;
1634       
1635             %etls_CIContents(table=PODSLIB1."RWP_TCAT_TYPE"n, workTableOut=etls_commands, inDSOptions=);
1636       
1637             %if &etls_otherTablesReferToThisTable %then
1638                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1638     ! constraints.;
1639             %else
1640             %do; /* okay - remove foreign keys  */
1641       
1642                data etls_commands_F;
1643                   set etls_commands;
1644                   if upcase(type)="FOREIGN KEY" then
1645                   do;
1646                      command='ic delete '||trim(name)||';';
1647                      output etls_commands_F;
1648                   end;
1649                run;
1650       
1651                %put %str(NOTE: Removing foreign keys before dropping table...);
1652                data _null_;
1653                   set etls_commands_F end=eof;
1654                   if _n_=1 then
1655                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCAT_TYPE"n;');
1656                   call execute(command);
1657                   if eof then call execute('; quit;');
1658                run;
1659                %rcSet(&syserr);
1660       
1661          %end; /* okay - remove foreign keys  */
1662       
1663          proc datasets lib = work nolist nowarn memtype = (data view);
1664             delete etls_commands etls_commands_F;
1665          quit;
1666       
1667          /*---- Drop a table  ----*/
1668          %put %str(NOTE: Dropping table ...);
1669          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
57                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1670             delete "RWP_TCAT_TYPE"n;
1671          quit;
1672       
1673          %rcSet(&syserr);
1674       
1675          %let etls_tableExist = 0;
1676       
1677       %end; /* table exists  */
1678       
1679       /*---- Create a new table  ----*/
1680       %if (&etls_tableExist eq 0) %then
1681       %do;  /* if table does not exist  */
1682       
1683          %put %str(NOTE: Creating table ...);
1684       
1685          data PODSLIB1."RWP_TCAT_TYPE"n
1686                  (COMPRESS = YES);
1687             attrib "CAT_TYPE"n length = $2
1688                format = $2.
1689                label = 'Catalog';
1690             attrib "LANGU"n length = $1
1691                format = $1.
1692                label = 'Language Key';
1693             attrib "TXTSH"n length = $20
1694                format = $20.
1695                label = 'Short description';
1696             attrib "TXTMD"n length = $40
1697                format = $40.
1698                label = 'Medium description';
1699             call missing(of _all_);
1700             stop;
1701          run;
1702       
1703          %rcSet(&syserr);
1704       
1705       %end;  /* if table does not exist  */
1706       
1707       /*---- Append  ----*/
1708       %put %str(NOTE: Appending data ...);
1709       
1710       proc append base = PODSLIB1."RWP_TCAT_TYPE"n(COMPRESS = YES)
1711          data = &etls_lastTable (&etls_tableOptions)  force ;
1712        run;
1713       
1714       %rcSet(&syserr);
1715       
1716       %mend etls_loader;
1717       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TCAT_TYPE"n
58                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TCAT_TYPE"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
59                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCAT_TYPE"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TCAT_TYPE"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TCAT_TYPE (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.05 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TCAT_TYPE"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "CAT_TYPE"n length = $2 format = $2. label = 'Catalog';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TCAT_TYPE has 0 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

60                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TCAT_TYPE"n(COMPRESS = YES) data = SAPRWP.'/BI0/TCAT_TYPE'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TCAT_TYPE'n to PODSLIB1.RWP_TCAT_TYPE.
NOTE: There were 0 observations read from the data set SAPRWP.'/BI0/TCAT_TYPE'n.
NOTE: 0 observations added.
NOTE: The data set PODSLIB1.RWP_TCAT_TYPE has 0 observations and 4 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.47 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
1718       
1719       %let etls_recCheckExist = 0;
1720       %let etls_recnt = 0;
1721       %macro etls_recordCheck;
1722          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCAT_TYPE"n, DATA)) or
1723                %sysfunc(exist(PODSLIB1."RWP_TCAT_TYPE"n, VIEW)));
1724       
1725          %if (&etls_recCheckExist) %then
1726          %do;
1727             %local etls_syntaxcheck;
1728             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1729             /* Turn off syntaxcheck option to perform following steps  */
1730             options nosyntaxcheck;
1731       
1732             proc contents data = PODSLIB1."RWP_TCAT_TYPE"n out = work.etls_contents(keep = nobs) noprint;
1733             run;
1734       
1735             data _null_;
1736                set work.etls_contents (obs = 1);
1737                call symput("etls_recnt", left(put(nobs,32.)));
1738             run;
1739       
1740             proc datasets lib = work nolist nowarn memtype = (data view);
1741                delete etls_contents;
1742             quit;
1743       
1744             /* Reset syntaxcheck option to previous setting  */
1745             options &etls_syntaxcheck;
1746          %end;
1747       %mend etls_recordCheck;
1748       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TCAT_TYPE"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 4 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
61                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1749       
1750       
1751       
1752       /** Step end Table Loader **/
1753       
1754       /*==========================================================================*
1755        * Step:            Table Loader                          A57BXQB4.BV00012T *
1756        * Transform:       Table Loader (Version 2.1)                              *
1757        * Description:                                                             *
1758        *                                                                          *
1759        * Source Table:    _BIC_AZCRMHB00 - -                    A57BXQB4.BE0001SF *
1760        *                   SAPrwp."/BIC/AZCRMHB00"n                               *
1761        * Target Table:    RWP_AZCRMHB00 -                       A57BXQB4.BE0001SG *
1762        *                   PODSLIB1."RWP_AZCRMHB00"n                              *
1763        *==========================================================================*/
1764       
1765       %let transformID = %quote(A57BXQB4.BV00012T);
1766       %let trans_rc = 0;
1767       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1768       
1769       %let SYSLAST = %nrquote(SAPrwp."/BIC/AZCRMHB00"n);
1770       
1771       %global etls_sql_pushDown;
1772       %let etls_sql_pushDown = -1;
1773       option DBIDIRECTEXEC;
1774       
1775       %global etls_tableExist;
1776       %global etls_numIndex;
1777       %global etls_lastTable;
1778       %let etls_tableExist = -1;
1779       %let etls_numIndex = -1;
1780       %let etls_lastTable = &SYSLAST;
1781       
1782       /*---- Define load data macro  ----*/
1783       
1784       /* --------------------------------------------------------------
1785          Load Technique Selection: Replace - EntireTable
1786          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
62                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1787          Additional options selections...
1788             Set unmapped to missing on updates: false
1789          -------------------------------------------------------------- */
1790       %macro etls_loader;
1791       
1792          %let etls_tableOptions = ;
1793       
1794          /* Determine if the target table exists  */
1795          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_AZCRMHB00"n, DATA)) or
1796                %sysfunc(exist(PODSLIB1."RWP_AZCRMHB00"n, VIEW)));
1797       
1798          %if &etls_tableExist %then
1799          %do;/* table exists  */
1800             %let etls_hasPreExistingConstraint=0;
1801       
1802             proc datasets lib = work nolist nowarn memtype = (data view);
1803                delete etls_commands etls_commands_F;
1804             quit;
1805       
1806             %let etls_otherTablesReferToThisTable=0;
1807       
1808             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1809                %put NOTE: Building table listing Constraints and Indexes for: &table;
1810                proc datasets lib=work nolist; delete &workTableOut; quit;
1811                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1812       
1813                data &workTableOut;
1814                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1815                   name = '';
1816                   type = '';
1817                   icown = '';
1818                   idxUnique = '';
1819                   idxNoMiss = '';
1820                   recreate = '';
1821                   set &workTableOut;
1822                   ref = '';
1823                   type=upcase(type);
1824                   if type eq 'REFERENTIAL' then
1825                   do;
1826                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1827                           " another table: " ref;
1828                      call symput('etls_otherTablesReferToThisTable','1');
1829                      delete;
1830                   end;
1831                   if type='INDEX' and ICOwn eq 'YES' then delete;
1832                run;
1833                %rcSet(&syserr);
1834       
1835             %mend etls_CIContents;
1836       
1837             %etls_CIContents(table=PODSLIB1."RWP_AZCRMHB00"n, workTableOut=etls_commands, inDSOptions=);
1838       
1839             %if &etls_otherTablesReferToThisTable %then
1840                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1840     ! constraints.;
1841             %else
1842             %do; /* okay - remove foreign keys  */
1843       
63                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1844                data etls_commands_F;
1845                   set etls_commands;
1846                   if upcase(type)="FOREIGN KEY" then
1847                   do;
1848                      command='ic delete '||trim(name)||';';
1849                      output etls_commands_F;
1850                   end;
1851                run;
1852       
1853                %put %str(NOTE: Removing foreign keys before dropping table...);
1854                data _null_;
1855                   set etls_commands_F end=eof;
1856                   if _n_=1 then
1857                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_AZCRMHB00"n;');
1858                   call execute(command);
1859                   if eof then call execute('; quit;');
1860                run;
1861                %rcSet(&syserr);
1862       
1863          %end; /* okay - remove foreign keys  */
1864       
1865          proc datasets lib = work nolist nowarn memtype = (data view);
1866             delete etls_commands etls_commands_F;
1867          quit;
1868       
1869          /*---- Drop a table  ----*/
1870          %put %str(NOTE: Dropping table ...);
1871          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
1872             delete "RWP_AZCRMHB00"n;
1873          quit;
1874       
1875          %rcSet(&syserr);
1876       
1877          %let etls_tableExist = 0;
1878       
1879       %end; /* table exists  */
1880       
1881       /*---- Create a new table  ----*/
1882       %if (&etls_tableExist eq 0) %then
1883       %do;  /* if table does not exist  */
1884       
1885          %put %str(NOTE: Creating table ...);
1886       
1887          data PODSLIB1."RWP_AZCRMHB00"n
1888                  (COMPRESS = YES);
1889             attrib "CRM_OHGUID"n length = $32
1890                format = $32.
1891                label = 'GUID of a CRM Order Object';
1892             attrib "RECORDMODE"n length = $1
1893                format = $1.
1894                label = 'BW Delta Process: Record Mode';
1895             attrib "CRM_OBJ_ID"n length = $10
1896                format = $10.
1897                label = 'Transaction Number';
1898             attrib "_BIC_ZCCREBY"n length = $12
1899                format = $12.
1900                label = 'Created By';
1901             attrib "CRM_CHD_BY"n length = $12
64                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1902                format = $12.
1903                label = 'Transaction Last Changed By';
1904             attrib "CRM_CHD_AT"n length = 8
1905                format = DATE9.
1906                label = 'Time of Last Change to the Transaction';
1907             attrib "_BIC_ZINPUTC"n length = $3
1908                format = $3.
1909                label = 'Input channel';
1910             attrib "CRM_SOLDTO"n length = $10
1911                format = $10.
1912                label = 'Sold-To Party';
1913             attrib "CRM_CTYP_C"n length = $2
1914                format = $2.
1915                label = 'Catalog Type: Catalog Category C (Damage/Defects/Reasons)';
1916             attrib "CRM_CDGR_C"n length = $8
1917                format = $8.
1918                label = 'Code Group: Catalog Category C (Damage/Defects/Reasons)';
1919             attrib "CRM_CODE_C"n length = $4
1920                format = $4.
1921                label = 'Code: Catalog Category C (Damage/Defects/Reasons)';
1922             attrib "PSTNG_DATE"n length = 8
1923                format = DATE9.
1924                label = 'Posting date in the document';
1925             attrib "_BIC_ZCASE_NO"n length = $12
1926                format = $12.;
1927             attrib "BP_RESPPER"n length = $10
1928                format = $10.
1929                label = 'Employee Responsible';
1930             attrib "CRM_CTYP_D"n length = $2
1931                format = $2.
1932                label = 'Catalog Type:Catalog Category D (Defect Locations/Obj.Parts)';
1933             attrib "CRM_CDGR_D"n length = $8
1934                format = $8.
1935                label = 'Code Group: Catalog Category D(Defect Location/Object Parts)';
1936             attrib "CRM_CODE_D"n length = $4
1937                format = $4.
1938                label = 'Code: Catalog Category D (Defect Location/Object Parts)';
1939             attrib "CRM_CTYP_E"n length = $2
1940                format = $2.
1941                label = 'Catalog Type: Catalog Category E (Causes)';
1942             attrib "CRM_CDGR_E"n length = $8
1943                format = $8.
1944                label = 'Code Group: Catalog Category E (Causes)';
1945             attrib "CRM_CODE_E"n length = $4
1946                format = $4.
1947                label = 'Code: Catalog Category E (Causes)';
1948             attrib "_BIC_ZZAFLD02"n length = $4
1949                format = $4.
1950                label = 'Gidiþ Kanalý';
1951             attrib "CRM_DESCR"n length = $40
1952                format = $40.
1953                label = 'Description of a Transaction';
1954             attrib "_BIC_ZEPDKD"n length = 8
1955                format = DATE9.
1956                label = 'EPDK Date';
1957             attrib "_BIC_ZPLAND"n length = 8
1958                format = DATE9.
1959                label = 'Plan Date';
65                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1960             attrib "_BIC_ZCLOD"n length = 8
1961                format = DATE9.
1962                label = 'Closed Date';
1963             attrib "_BIC_ZSTNZSRV"n length = $2
1964                format = $2.;
1965             attrib "_BIC_ZSTNZSRS"n length = $2
1966                format = $2.;
1967             attrib "_BIC_ZSTNZSIP"n length = $2
1968                format = $2.;
1969             attrib "DATE0"n length = 8
1970                format = DATE9.
1971                label = 'Date';
1972             attrib "_BIC_ZATTR2"n length = $40
1973                format = $40.;
1974             attrib "_BIC_ZATTR3"n length = $40
1975                format = $40.;
1976             attrib "_BIC_ZKANAL"n length = $4
1977                format = $4.
1978                label = 'Kanal';
1979             attrib "_BIC_ZCRMMTP"n length = $2
1980                format = $2.;
1981             attrib "_BIC_ZATTR1"n length = $40
1982                format = $40.;
1983             attrib "CALMONTH"n length = $6
1984                format = $6.
1985                label = 'Calendar year/month';
1986             attrib "CALYEAR"n length = $4
1987                format = $4.
1988                label = 'Calendar year';
1989             attrib "CACONT_ACC"n length = $12
1990                format = $12.
1991                label = 'Contract Account (Partner-Independent Data)';
1992             attrib "_BIC_ZZCC1"n length = $4
1993                format = $4.;
1994             attrib "_BIC_ZZCT1"n length = $2
1995                format = $2.;
1996             attrib "_BIC_ZZCG1"n length = $8
1997                format = $8.;
1998             attrib "CRM_PRCTYP"n length = $4
1999                format = $4.
2000                label = 'Business Transaction Type';
2001             attrib "CRM_USSTAT"n length = $5
2002                format = $5.
2003                label = 'User Status';
2004             attrib "CRM_STSMA"n length = $8
2005                format = $8.
2006                label = 'Status Profile';
2007             attrib "UCCONTRACT"n length = $10
2008                format = $10.
2009                label = 'Contract Number: Utilities Industry';
2010             attrib "UCINSTALLA"n length = $10
2011                format = $10.
2012                label = 'Installation Number: Utilities Industry';
2013             attrib "UCRATEFAKT"n length = $10
2014                format = $10.
2015                label = 'Rate Fact Group';
2016             attrib "_BIC_ZFLAG1"n length = $5
2017                format = $5.;
66                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2018             attrib "_BIC_ZCALLTYP"n length = $5
2019                format = $5.
2020                label = 'ZWM_CALLTYPE';
2021             attrib "BPARTNER"n length = $10
2022                format = $10.
2023                label = 'Business Partner';
2024             attrib "_BIC_ZCASETYPE"n length = $4
2025                format = $4.
2026                label = 'Olay türü';
2027             attrib "_BIC_ZCRM_OBJ2"n length = $10
2028                format = $10.;
2029             attrib "_BIC_ZCCCHR"n length = $45
2030                format = $45.
2031                label = 'CCC Organization Code';
2032             attrib "FC_VKONT"n length = $12
2033                format = $12.
2034                label = 'Contract Account (Partner-Independent Data) - item';
2035             attrib "BBP_DOGUID"n length = $32
2036                format = $32.
2037                label = 'Doc. GUID';
2038             attrib "_BIC_ZCANCELD"n length = 8
2039                format = DATE9.;
2040             attrib "_BIC_ZMAILD"n length = 8
2041                format = DATE9.;
2042             attrib "_BIC_ZCRMKF8"n length = 8
2043                format = BEST12.
2044                label = 'T0 Discount';
2045             attrib "_BIC_ZHBBRM"n length = $45
2046                format = $45.;
2047             attrib "_BIC_ZCRMSTSMA"n length = $8
2048                format = $8.;
2049             attrib "_BIC_ZCRMSTAT"n length = $5
2050                format = $5.;
2051             attrib "_BIC_ZHB_IN"n length = 8
2052                format = TIME8.;
2053             attrib "_BIC_ZHB_OUT"n length = 8
2054                format = TIME8.;
2055             attrib "CRM_CTYP_T"n length = $2
2056                format = $2.
2057                label = 'Catalog Type: Catalog Category T (Tasks)';
2058             attrib "CRM_CDGR_T"n length = $8
2059                format = $8.
2060                label = 'Code Group: Catalog Category T (Tasks)';
2061             attrib "CRM_CODE_T"n length = $4
2062                format = $4.
2063                label = 'Code: Catalog Category T (Tasks)';
2064             attrib "_BIC_ZSRSTIP"n length = $10
2065                format = $10.;
2066             attrib "_BIC_ZCCREBY1"n length = $12
2067                format = $12.
2068                label = 'Created by';
2069             attrib "UCMOVEOUTD"n length = 8
2070                format = DATE9.
2071                label = 'Move-Out Date';
2072             attrib "_BIC_ZFLAG2"n length = $1
2073                format = $1.;
2074             attrib "_BIC_ZCCREBY3"n length = $12
2075                format = $12.;
67                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2076             attrib "_BIC_ZYAKINLIK"n length = $2
2077                format = $2.;
2078             attrib "CRM_CTD_BY"n length = $12
2079                format = $12.
2080                label = 'User that Created the Transaction';
2081             attrib "CRM_PRIDAT"n length = 8
2082                format = DATE9.
2083                label = 'Pricing Date';
2084             attrib "_BIC_ZBARKODNO"n length = $50
2085                format = $50.;
2086             attrib "_BIC_ZSORORG"n length = $10
2087                format = $10.;
2088             attrib "_BIC_ZAORG2"n length = $10
2089                format = $10.;
2090             attrib "CPR_CREATE"n length = 8
2091                format = DATE9.
2092                label = 'Created On';
2093             attrib "_BIC_ZERZEIT"n length = 8
2094                format = TIME8.;
2095             attrib "_BIC_ZZFAGE"n length = $2
2096                format = $2.
2097                label = 'Age';
2098             attrib "_BIC_ZVIPCIP"n length = $2
2099                format = $2.;
2100             attrib "EE_SNAME"n length = $30
2101                format = $30.
2102                label = 'Employee''s Name (Sortable by LAST NAME FIRST NAME)';
2103             attrib "_BIC_ZCRM_LOK"n length = $35
2104                format = $35.;
2105             attrib "_BIC_ZCRMBOLGE"n length = $2
2106                format = $2.;
2107             attrib "REGION"n length = $3
2108                format = $3.
2109                label = 'Region (State, Province, County)';
2110             attrib "_BIC_ZUCCOUNTY"n length = $8
2111                format = $8.
2112                label = 'County Code';
2113             attrib "COUNTRY"n length = $3
2114                format = $3.
2115                label = 'Country Key';
2116             attrib "CITY_CODE"n length = $12
2117                format = $12.
2118                label = 'BAS: City Code';
2119             attrib "CRMCHANNEL"n length = $4
2120                format = $4.
2121                label = 'Communication Medium';
2122             attrib "CPR_NAME"n length = $12
2123                format = $12.
2124                label = 'User Name';
2125             attrib "_BIC_Z_EMPLYEE"n length = $80
2126                format = $80.;
2127             attrib "_BIC_ZREF_TYPE"n length = $2
2128                format = $2.;
2129             call missing(of _all_);
2130             stop;
2131          run;
2132       
2133          %rcSet(&syserr);
68                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2134       
2135       %end;  /* if table does not exist  */
2136       
2137       /*---- Append  ----*/
2138       %put %str(NOTE: Appending data ...);
2139       
2140       proc append base = PODSLIB1."RWP_AZCRMHB00"n(COMPRESS = YES)
2141          data = &etls_lastTable (&etls_tableOptions)  force ;
2142        run;
2143       
2144       %rcSet(&syserr);
2145       
2146       %mend etls_loader;
2147       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_AZCRMHB00"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_AZCRMHB00"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
69                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_AZCRMHB00"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_AZCRMHB00"n;
MPRINT(ETLS_LOADER):   quit;
70                                                         The SAS System                          09:30 Wednesday, December 2, 2020


NOTE: Deleting PODSLIB1.RWP_AZCRMHB00 (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           2.23 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_AZCRMHB00"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "CRM_OHGUID"n length = $32 format = $32. label = 'GUID of a CRM Order Object';
MPRINT(ETLS_LOADER):   attrib "RECORDMODE"n length = $1 format = $1. label = 'BW Delta Process: Record Mode';
MPRINT(ETLS_LOADER):   attrib "CRM_OBJ_ID"n length = $10 format = $10. label = 'Transaction Number';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCCREBY"n length = $12 format = $12. label = 'Created By';
MPRINT(ETLS_LOADER):   attrib "CRM_CHD_BY"n length = $12 format = $12. label = 'Transaction Last Changed By';
MPRINT(ETLS_LOADER):   attrib "CRM_CHD_AT"n length = 8 format = DATE9. label = 'Time of Last Change to the Transaction';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZINPUTC"n length = $3 format = $3. label = 'Input channel';
MPRINT(ETLS_LOADER):   attrib "CRM_SOLDTO"n length = $10 format = $10. label = 'Sold-To Party';
MPRINT(ETLS_LOADER):   attrib "CRM_CTYP_C"n length = $2 format = $2. label = 'Catalog Type: Catalog Category C 
(Damage/Defects/Reasons)';
MPRINT(ETLS_LOADER):   attrib "CRM_CDGR_C"n length = $8 format = $8. label = 'Code Group: Catalog Category C 
(Damage/Defects/Reasons)';
MPRINT(ETLS_LOADER):   attrib "CRM_CODE_C"n length = $4 format = $4. label = 'Code: Catalog Category C (Damage/Defects/Reasons)';
MPRINT(ETLS_LOADER):   attrib "PSTNG_DATE"n length = 8 format = DATE9. label = 'Posting date in the document';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCASE_NO"n length = $12 format = $12.;
MPRINT(ETLS_LOADER):   attrib "BP_RESPPER"n length = $10 format = $10. label = 'Employee Responsible';
MPRINT(ETLS_LOADER):   attrib "CRM_CTYP_D"n length = $2 format = $2. label = 'Catalog Type:Catalog Category D (Defect 
Locations/Obj.Parts)';
MPRINT(ETLS_LOADER):   attrib "CRM_CDGR_D"n length = $8 format = $8. label = 'Code Group: Catalog Category D(Defect Location/Object 
Parts)';
MPRINT(ETLS_LOADER):   attrib "CRM_CODE_D"n length = $4 format = $4. label = 'Code: Catalog Category D (Defect Location/Object 
Parts)';
MPRINT(ETLS_LOADER):   attrib "CRM_CTYP_E"n length = $2 format = $2. label = 'Catalog Type: Catalog Category E (Causes)';
MPRINT(ETLS_LOADER):   attrib "CRM_CDGR_E"n length = $8 format = $8. label = 'Code Group: Catalog Category E (Causes)';
MPRINT(ETLS_LOADER):   attrib "CRM_CODE_E"n length = $4 format = $4. label = 'Code: Catalog Category E (Causes)';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZAFLD02"n length = $4 format = $4. label = 'Gidiþ Kanalý';
MPRINT(ETLS_LOADER):   attrib "CRM_DESCR"n length = $40 format = $40. label = 'Description of a Transaction';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZEPDKD"n length = 8 format = DATE9. label = 'EPDK Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPLAND"n length = 8 format = DATE9. label = 'Plan Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCLOD"n length = 8 format = DATE9. label = 'Closed Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSTNZSRV"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSTNZSRS"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSTNZSIP"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "DATE0"n length = 8 format = DATE9. label = 'Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR2"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR3"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZKANAL"n length = $4 format = $4. label = 'Kanal';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMMTP"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR1"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "CALMONTH"n length = $6 format = $6. label = 'Calendar year/month';
MPRINT(ETLS_LOADER):   attrib "CALYEAR"n length = $4 format = $4. label = 'Calendar year';
MPRINT(ETLS_LOADER):   attrib "CACONT_ACC"n length = $12 format = $12. label = 'Contract Account (Partner-Independent Data)';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZCC1"n length = $4 format = $4.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZCT1"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZCG1"n length = $8 format = $8.;
MPRINT(ETLS_LOADER):   attrib "CRM_PRCTYP"n length = $4 format = $4. label = 'Business Transaction Type';
MPRINT(ETLS_LOADER):   attrib "CRM_USSTAT"n length = $5 format = $5. label = 'User Status';
MPRINT(ETLS_LOADER):   attrib "CRM_STSMA"n length = $8 format = $8. label = 'Status Profile';
71                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   attrib "UCCONTRACT"n length = $10 format = $10. label = 'Contract Number: Utilities Industry';
MPRINT(ETLS_LOADER):   attrib "UCINSTALLA"n length = $10 format = $10. label = 'Installation Number: Utilities Industry';
MPRINT(ETLS_LOADER):   attrib "UCRATEFAKT"n length = $10 format = $10. label = 'Rate Fact Group';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZFLAG1"n length = $5 format = $5.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCALLTYP"n length = $5 format = $5. label = 'ZWM_CALLTYPE';
MPRINT(ETLS_LOADER):   attrib "BPARTNER"n length = $10 format = $10. label = 'Business Partner';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCASETYPE"n length = $4 format = $4. label = 'Olay türü';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRM_OBJ2"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCCCHR"n length = $45 format = $45. label = 'CCC Organization Code';
MPRINT(ETLS_LOADER):   attrib "FC_VKONT"n length = $12 format = $12. label = 'Contract Account (Partner-Independent Data) - item';
MPRINT(ETLS_LOADER):   attrib "BBP_DOGUID"n length = $32 format = $32. label = 'Doc. GUID';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCANCELD"n length = 8 format = DATE9.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZMAILD"n length = 8 format = DATE9.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKF8"n length = 8 format = BEST12. label = 'T0 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZHBBRM"n length = $45 format = $45.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMSTSMA"n length = $8 format = $8.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMSTAT"n length = $5 format = $5.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZHB_IN"n length = 8 format = TIME8.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZHB_OUT"n length = 8 format = TIME8.;
MPRINT(ETLS_LOADER):   attrib "CRM_CTYP_T"n length = $2 format = $2. label = 'Catalog Type: Catalog Category T (Tasks)';
MPRINT(ETLS_LOADER):   attrib "CRM_CDGR_T"n length = $8 format = $8. label = 'Code Group: Catalog Category T (Tasks)';
MPRINT(ETLS_LOADER):   attrib "CRM_CODE_T"n length = $4 format = $4. label = 'Code: Catalog Category T (Tasks)';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSRSTIP"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCCREBY1"n length = $12 format = $12. label = 'Created by';
MPRINT(ETLS_LOADER):   attrib "UCMOVEOUTD"n length = 8 format = DATE9. label = 'Move-Out Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZFLAG2"n length = $1 format = $1.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCCREBY3"n length = $12 format = $12.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZYAKINLIK"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "CRM_CTD_BY"n length = $12 format = $12. label = 'User that Created the Transaction';
MPRINT(ETLS_LOADER):   attrib "CRM_PRIDAT"n length = 8 format = DATE9. label = 'Pricing Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZBARKODNO"n length = $50 format = $50.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSORORG"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZAORG2"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "CPR_CREATE"n length = 8 format = DATE9. label = 'Created On';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZERZEIT"n length = 8 format = TIME8.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZFAGE"n length = $2 format = $2. label = 'Age';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZVIPCIP"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "EE_SNAME"n length = $30 format = $30. label = 'Employee''s Name (Sortable by LAST NAME FIRST NAME)';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRM_LOK"n length = $35 format = $35.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMBOLGE"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "REGION"n length = $3 format = $3. label = 'Region (State, Province, County)';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZUCCOUNTY"n length = $8 format = $8. label = 'County Code';
MPRINT(ETLS_LOADER):   attrib "COUNTRY"n length = $3 format = $3. label = 'Country Key';
MPRINT(ETLS_LOADER):   attrib "CITY_CODE"n length = $12 format = $12. label = 'BAS: City Code';
MPRINT(ETLS_LOADER):   attrib "CRMCHANNEL"n length = $4 format = $4. label = 'Communication Medium';
MPRINT(ETLS_LOADER):   attrib "CPR_NAME"n length = $12 format = $12. label = 'User Name';
MPRINT(ETLS_LOADER):   attrib "_BIC_Z_EMPLYEE"n length = $80 format = $80.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZREF_TYPE"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_AZCRMHB00 has 0 observations and 91 variables.
NOTE: DATA statement used (Total process time):
      real time           0.07 seconds
      cpu time            0.01 seconds
      

72                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_AZCRMHB00"n(COMPRESS = YES) data = SAPRWP.'/BIC/AZCRMHB00'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/AZCRMHB00'n to PODSLIB1.RWP_AZCRMHB00.
WARNING: Variable _BIC_ZDIGI was not found on BASE file. The variable will not be added to the BASE file.
WARNING: Variable _BIC_ZKAPAMA was not found on BASE file. The variable will not be added to the BASE file.
WARNING: Variable CRM_URGENC was not found on BASE file. The variable will not be added to the BASE file.
WARNING: Variable _BIC_ZLST_CLS was not found on BASE file. The variable will not be added to the BASE file.
WARNING: Variable _BIC_ZSONUC was not found on BASE file. The variable will not be added to the BASE file.
WARNING: Variable _BIC_ZGDK was not found on BASE file. The variable will not be added to the BASE file.
WARNING: Variable _BIC_ZKAYNAK was not found on BASE file. The variable will not be added to the BASE file.
NOTE: FORCE is specified, so dropping/truncating will occur.
WARNING: Some character data was lost during transcoding in the dataset SAPRWP.'/BIC/AZCRMHB00'n. Either the data contains 
         characters that are not representable in the new encoding or truncation occurred during transcoding.
NOTE: There were 11015565 observations read from the data set SAPRWP.'/BIC/AZCRMHB00'n.
NOTE: 16182015 observations added.
NOTE: The data set PODSLIB1.RWP_AZCRMHB00 has 16182015 observations and 91 variables.
NOTE: Compressing data set PODSLIB1.RWP_AZCRMHB00 decreased size by 63.31 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           32:08.11
      cpu time            4:58.23
      

MPRINT(ETLS_LOADER):  ;
2148       
2149       %let etls_recCheckExist = 0;
2150       %let etls_recnt = 0;
2151       %macro etls_recordCheck;
2152          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_AZCRMHB00"n, DATA)) or
2153                %sysfunc(exist(PODSLIB1."RWP_AZCRMHB00"n, VIEW)));
2154       
2155          %if (&etls_recCheckExist) %then
2156          %do;
2157             %local etls_syntaxcheck;
2158             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2159             /* Turn off syntaxcheck option to perform following steps  */
2160             options nosyntaxcheck;
2161       
2162             proc contents data = PODSLIB1."RWP_AZCRMHB00"n out = work.etls_contents(keep = nobs) noprint;
2163             run;
2164       
2165             data _null_;
2166                set work.etls_contents (obs = 1);
2167                call symput("etls_recnt", left(put(nobs,32.)));
2168             run;
2169       
2170             proc datasets lib = work nolist nowarn memtype = (data view);
2171                delete etls_contents;
2172             quit;
2173       
2174             /* Reset syntaxcheck option to previous setting  */
2175             options &etls_syntaxcheck;
2176          %end;
2177       %mend etls_recordCheck;
2178       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
73                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_AZCRMHB00"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 91 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2179       
2180       
2181       
2182       /** Step end Table Loader **/
2183       
2184       /*==========================================================================*
2185        * Step:            Table Loader                          A57BXQB4.BV00012U *
2186        * Transform:       Table Loader (Version 2.1)                              *
2187        * Description:                                                             *
2188        *                                                                          *
2189        * Source Table:    _BIC_TZCALLTYP - -                    A57BXQB4.BE0001SH *
2190        *                   SAPrwp."/BIC/TZCALLTYP"n                               *
2191        * Target Table:    RWP_TZCALLTYP -                       A57BXQB4.BE0001SI *
2192        *                   PODSLIB1."RWP_TZCALLTYP"n                              *
2193        *==========================================================================*/
2194       
2195       %let transformID = %quote(A57BXQB4.BV00012U);
2196       %let trans_rc = 0;
2197       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2198       
2199       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZCALLTYP"n);
2200       
2201       %global etls_sql_pushDown;
2202       %let etls_sql_pushDown = -1;
2203       option DBIDIRECTEXEC;
2204       
2205       %global etls_tableExist;
74                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2206       %global etls_numIndex;
2207       %global etls_lastTable;
2208       %let etls_tableExist = -1;
2209       %let etls_numIndex = -1;
2210       %let etls_lastTable = &SYSLAST;
2211       
2212       /*---- Define load data macro  ----*/
2213       
2214       /* --------------------------------------------------------------
2215          Load Technique Selection: Replace - EntireTable
2216          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2217          Additional options selections...
2218             Set unmapped to missing on updates: false
2219          -------------------------------------------------------------- */
2220       %macro etls_loader;
2221       
2222          %let etls_tableOptions = ;
2223       
2224          /* Determine if the target table exists  */
2225          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCALLTYP"n, DATA)) or
2226                %sysfunc(exist(PODSLIB1."RWP_TZCALLTYP"n, VIEW)));
2227       
2228          %if &etls_tableExist %then
2229          %do;/* table exists  */
2230             %let etls_hasPreExistingConstraint=0;
2231       
2232             proc datasets lib = work nolist nowarn memtype = (data view);
2233                delete etls_commands etls_commands_F;
2234             quit;
2235       
2236             %let etls_otherTablesReferToThisTable=0;
2237       
2238             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2239                %put NOTE: Building table listing Constraints and Indexes for: &table;
2240                proc datasets lib=work nolist; delete &workTableOut; quit;
2241                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2242       
2243                data &workTableOut;
2244                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2245                   name = '';
2246                   type = '';
2247                   icown = '';
2248                   idxUnique = '';
2249                   idxNoMiss = '';
2250                   recreate = '';
2251                   set &workTableOut;
2252                   ref = '';
2253                   type=upcase(type);
2254                   if type eq 'REFERENTIAL' then
2255                   do;
2256                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2257                           " another table: " ref;
2258                      call symput('etls_otherTablesReferToThisTable','1');
2259                      delete;
2260                   end;
2261                   if type='INDEX' and ICOwn eq 'YES' then delete;
2262                run;
2263                %rcSet(&syserr);
75                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2264       
2265             %mend etls_CIContents;
2266       
2267             %etls_CIContents(table=PODSLIB1."RWP_TZCALLTYP"n, workTableOut=etls_commands, inDSOptions=);
2268       
2269             %if &etls_otherTablesReferToThisTable %then
2270                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2270     ! constraints.;
2271             %else
2272             %do; /* okay - remove foreign keys  */
2273       
2274                data etls_commands_F;
2275                   set etls_commands;
2276                   if upcase(type)="FOREIGN KEY" then
2277                   do;
2278                      command='ic delete '||trim(name)||';';
2279                      output etls_commands_F;
2280                   end;
2281                run;
2282       
2283                %put %str(NOTE: Removing foreign keys before dropping table...);
2284                data _null_;
2285                   set etls_commands_F end=eof;
2286                   if _n_=1 then
2287                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCALLTYP"n;');
2288                   call execute(command);
2289                   if eof then call execute('; quit;');
2290                run;
2291                %rcSet(&syserr);
2292       
2293          %end; /* okay - remove foreign keys  */
2294       
2295          proc datasets lib = work nolist nowarn memtype = (data view);
2296             delete etls_commands etls_commands_F;
2297          quit;
2298       
2299          /*---- Drop a table  ----*/
2300          %put %str(NOTE: Dropping table ...);
2301          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
2302             delete "RWP_TZCALLTYP"n;
2303          quit;
2304       
2305          %rcSet(&syserr);
2306       
2307          %let etls_tableExist = 0;
2308       
2309       %end; /* table exists  */
2310       
2311       /*---- Create a new table  ----*/
2312       %if (&etls_tableExist eq 0) %then
2313       %do;  /* if table does not exist  */
2314       
2315          %put %str(NOTE: Creating table ...);
2316       
2317          data PODSLIB1."RWP_TZCALLTYP"n
2318                  (COMPRESS = YES);
2319             attrib "_BIC_ZCASETYPE"n length = $4
2320                format = $4.
76                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2321                label = 'Olay türü';
2322             attrib "_BIC_ZCALLTYP"n length = $5
2323                format = $5.
2324                label = 'ZWM_CALLTYPE';
2325             attrib "LANGU"n length = $1
2326                format = $1.
2327                label = 'Language Key';
2328             attrib "TXTSH"n length = $20
2329                format = $20.
2330                label = 'Short description';
2331             attrib "TXTMD"n length = $40
2332                format = $40.
2333                label = 'Medium description';
2334             attrib "TXTLG"n length = $60
2335                format = $60.
2336                label = 'Long description';
2337             call missing(of _all_);
2338             stop;
2339          run;
2340       
2341          %rcSet(&syserr);
2342       
2343       %end;  /* if table does not exist  */
2344       
2345       /*---- Append  ----*/
2346       %put %str(NOTE: Appending data ...);
2347       
2348       proc append base = PODSLIB1."RWP_TZCALLTYP"n(COMPRESS = YES)
2349          data = &etls_lastTable (&etls_tableOptions)  force ;
2350        run;
2351       
2352       %rcSet(&syserr);
2353       
2354       %mend etls_loader;
2355       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZCALLTYP"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZCALLTYP"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

77                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCALLTYP"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
78                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZCALLTYP"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZCALLTYP (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           2.14 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZCALLTYP"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCASETYPE"n length = $4 format = $4. label = 'Olay türü';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCALLTYP"n length = $5 format = $5. label = 'ZWM_CALLTYPE';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZCALLTYP has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZCALLTYP"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZCALLTYP'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZCALLTYP'n to PODSLIB1.RWP_TZCALLTYP.
WARNING: Some character data was lost during transcoding in the dataset SAPRWP.'/BIC/TZCALLTYP'n. Either the data contains 
         characters that are not representable in the new encoding or truncation occurred during transcoding.
NOTE: There were 364 observations read from the data set SAPRWP.'/BIC/TZCALLTYP'n.
NOTE: 365 observations added.
NOTE: The data set PODSLIB1.RWP_TZCALLTYP has 365 observations and 6 variables.
79                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Compressing data set PODSLIB1.RWP_TZCALLTYP decreased size by 34.43 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.59 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
2356       
2357       %let etls_recCheckExist = 0;
2358       %let etls_recnt = 0;
2359       %macro etls_recordCheck;
2360          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCALLTYP"n, DATA)) or
2361                %sysfunc(exist(PODSLIB1."RWP_TZCALLTYP"n, VIEW)));
2362       
2363          %if (&etls_recCheckExist) %then
2364          %do;
2365             %local etls_syntaxcheck;
2366             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2367             /* Turn off syntaxcheck option to perform following steps  */
2368             options nosyntaxcheck;
2369       
2370             proc contents data = PODSLIB1."RWP_TZCALLTYP"n out = work.etls_contents(keep = nobs) noprint;
2371             run;
2372       
2373             data _null_;
2374                set work.etls_contents (obs = 1);
2375                call symput("etls_recnt", left(put(nobs,32.)));
2376             run;
2377       
2378             proc datasets lib = work nolist nowarn memtype = (data view);
2379                delete etls_contents;
2380             quit;
2381       
2382             /* Reset syntaxcheck option to previous setting  */
2383             options &etls_syntaxcheck;
2384          %end;
2385       %mend etls_recordCheck;
2386       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZCALLTYP"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 6 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
80                                                         The SAS System                          09:30 Wednesday, December 2, 2020


MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2387       
2388       
2389       
2390       /** Step end Table Loader **/
2391       
2392       /*==========================================================================*
2393        * Step:            Table Loader                          A57BXQB4.BV00012V *
2394        * Transform:       Table Loader (Version 2.1)                              *
2395        * Description:                                                             *
2396        *                                                                          *
2397        * Source Table:    _BIC_TZCASETYPE - -                   A57BXQB4.BE0001SJ *
2398        *                   SAPrwp."/BIC/TZCASETYPE"n                              *
2399        * Target Table:    RWP_TZCASETYPE -                      A57BXQB4.BE0001SK *
2400        *                   PODSLIB1."RWP_TZCASETYPE"n                             *
2401        *==========================================================================*/
2402       
2403       %let transformID = %quote(A57BXQB4.BV00012V);
2404       %let trans_rc = 0;
2405       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2406       
2407       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZCASETYPE"n);
2408       
2409       %global etls_sql_pushDown;
2410       %let etls_sql_pushDown = -1;
2411       option DBIDIRECTEXEC;
2412       
2413       %global etls_tableExist;
2414       %global etls_numIndex;
2415       %global etls_lastTable;
2416       %let etls_tableExist = -1;
2417       %let etls_numIndex = -1;
2418       %let etls_lastTable = &SYSLAST;
2419       
2420       /*---- Define load data macro  ----*/
2421       
2422       /* --------------------------------------------------------------
2423          Load Technique Selection: Replace - EntireTable
2424          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2425          Additional options selections...
2426             Set unmapped to missing on updates: false
2427          -------------------------------------------------------------- */
2428       %macro etls_loader;
2429       
2430          %let etls_tableOptions = ;
2431       
2432          /* Determine if the target table exists  */
81                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2433          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCASETYPE"n, DATA)) or
2434                %sysfunc(exist(PODSLIB1."RWP_TZCASETYPE"n, VIEW)));
2435       
2436          %if &etls_tableExist %then
2437          %do;/* table exists  */
2438             %let etls_hasPreExistingConstraint=0;
2439       
2440             proc datasets lib = work nolist nowarn memtype = (data view);
2441                delete etls_commands etls_commands_F;
2442             quit;
2443       
2444             %let etls_otherTablesReferToThisTable=0;
2445       
2446             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2447                %put NOTE: Building table listing Constraints and Indexes for: &table;
2448                proc datasets lib=work nolist; delete &workTableOut; quit;
2449                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2450       
2451                data &workTableOut;
2452                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2453                   name = '';
2454                   type = '';
2455                   icown = '';
2456                   idxUnique = '';
2457                   idxNoMiss = '';
2458                   recreate = '';
2459                   set &workTableOut;
2460                   ref = '';
2461                   type=upcase(type);
2462                   if type eq 'REFERENTIAL' then
2463                   do;
2464                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2465                           " another table: " ref;
2466                      call symput('etls_otherTablesReferToThisTable','1');
2467                      delete;
2468                   end;
2469                   if type='INDEX' and ICOwn eq 'YES' then delete;
2470                run;
2471                %rcSet(&syserr);
2472       
2473             %mend etls_CIContents;
2474       
2475             %etls_CIContents(table=PODSLIB1."RWP_TZCASETYPE"n, workTableOut=etls_commands, inDSOptions=);
2476       
2477             %if &etls_otherTablesReferToThisTable %then
2478                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2478     ! constraints.;
2479             %else
2480             %do; /* okay - remove foreign keys  */
2481       
2482                data etls_commands_F;
2483                   set etls_commands;
2484                   if upcase(type)="FOREIGN KEY" then
2485                   do;
2486                      command='ic delete '||trim(name)||';';
2487                      output etls_commands_F;
2488                   end;
2489                run;
82                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2490       
2491                %put %str(NOTE: Removing foreign keys before dropping table...);
2492                data _null_;
2493                   set etls_commands_F end=eof;
2494                   if _n_=1 then
2495                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCASETYPE"n;');
2496                   call execute(command);
2497                   if eof then call execute('; quit;');
2498                run;
2499                %rcSet(&syserr);
2500       
2501          %end; /* okay - remove foreign keys  */
2502       
2503          proc datasets lib = work nolist nowarn memtype = (data view);
2504             delete etls_commands etls_commands_F;
2505          quit;
2506       
2507          /*---- Drop a table  ----*/
2508          %put %str(NOTE: Dropping table ...);
2509          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
2510             delete "RWP_TZCASETYPE"n;
2511          quit;
2512       
2513          %rcSet(&syserr);
2514       
2515          %let etls_tableExist = 0;
2516       
2517       %end; /* table exists  */
2518       
2519       /*---- Create a new table  ----*/
2520       %if (&etls_tableExist eq 0) %then
2521       %do;  /* if table does not exist  */
2522       
2523          %put %str(NOTE: Creating table ...);
2524       
2525          data PODSLIB1."RWP_TZCASETYPE"n
2526                  (COMPRESS = YES);
2527             attrib "_BIC_ZCASETYPE"n length = $4
2528                format = $4.
2529                label = 'Olay türü';
2530             attrib "LANGU"n length = $1
2531                format = $1.
2532                label = 'Language Key';
2533             attrib "TXTSH"n length = $20
2534                format = $20.
2535                label = 'Short description';
2536             attrib "TXTMD"n length = $40
2537                format = $40.
2538                label = 'Medium description';
2539             attrib "TXTLG"n length = $60
2540                format = $60.
2541                label = 'Long description';
2542             call missing(of _all_);
2543             stop;
2544          run;
2545       
2546          %rcSet(&syserr);
2547       
83                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2548       %end;  /* if table does not exist  */
2549       
2550       /*---- Append  ----*/
2551       %put %str(NOTE: Appending data ...);
2552       
2553       proc append base = PODSLIB1."RWP_TZCASETYPE"n(COMPRESS = YES)
2554          data = &etls_lastTable (&etls_tableOptions)  force ;
2555        run;
2556       
2557       %rcSet(&syserr);
2558       
2559       %mend etls_loader;
2560       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZCASETYPE"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZCASETYPE"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
84                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCASETYPE"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZCASETYPE"n;
MPRINT(ETLS_LOADER):   quit;

85                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Deleting PODSLIB1.RWP_TZCASETYPE (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.05 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZCASETYPE"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCASETYPE"n length = $4 format = $4. label = 'Olay türü';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZCASETYPE has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZCASETYPE"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZCASETYPE'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZCASETYPE'n to PODSLIB1.RWP_TZCASETYPE.
NOTE: There were 3 observations read from the data set SAPRWP.'/BIC/TZCASETYPE'n.
NOTE: 3 observations added.
NOTE: The data set PODSLIB1.RWP_TZCASETYPE has 3 observations and 5 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZCASETYPE decreased size by 44.53 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.41 seconds
      cpu time            0.02 seconds
      

MPRINT(ETLS_LOADER):  ;
2561       
2562       %let etls_recCheckExist = 0;
2563       %let etls_recnt = 0;
2564       %macro etls_recordCheck;
2565          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCASETYPE"n, DATA)) or
2566                %sysfunc(exist(PODSLIB1."RWP_TZCASETYPE"n, VIEW)));
2567       
2568          %if (&etls_recCheckExist) %then
2569          %do;
2570             %local etls_syntaxcheck;
2571             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2572             /* Turn off syntaxcheck option to perform following steps  */
2573             options nosyntaxcheck;
2574       
2575             proc contents data = PODSLIB1."RWP_TZCASETYPE"n out = work.etls_contents(keep = nobs) noprint;
2576             run;
2577       
2578             data _null_;
86                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2579                set work.etls_contents (obs = 1);
2580                call symput("etls_recnt", left(put(nobs,32.)));
2581             run;
2582       
2583             proc datasets lib = work nolist nowarn memtype = (data view);
2584                delete etls_contents;
2585             quit;
2586       
2587             /* Reset syntaxcheck option to previous setting  */
2588             options &etls_syntaxcheck;
2589          %end;
2590       %mend etls_recordCheck;
2591       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZCASETYPE"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 5 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2592       
2593       
2594       
2595       /** Step end Table Loader **/
2596       
2597       /*==========================================================================*
2598        * Step:            Table Loader                          A57BXQB4.BV00012W *
2599        * Transform:       Table Loader (Version 2.1)                              *
2600        * Description:                                                             *
2601        *                                                                          *
2602        * Source Table:    _BIC_TZINPUTC - -                     A57BXQB4.BE0001SL *
2603        *                   SAPrwp."/BIC/TZINPUTC"n                                *
2604        * Target Table:    RWP_TZINPUTC -                        A57BXQB4.BE0001SM *
87                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2605        *                   PODSLIB1."RWP_TZINPUTC"n                               *
2606        *==========================================================================*/
2607       
2608       %let transformID = %quote(A57BXQB4.BV00012W);
2609       %let trans_rc = 0;
2610       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2611       
2612       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZINPUTC"n);
2613       
2614       %global etls_sql_pushDown;
2615       %let etls_sql_pushDown = -1;
2616       option DBIDIRECTEXEC;
2617       
2618       %global etls_tableExist;
2619       %global etls_numIndex;
2620       %global etls_lastTable;
2621       %let etls_tableExist = -1;
2622       %let etls_numIndex = -1;
2623       %let etls_lastTable = &SYSLAST;
2624       
2625       /*---- Define load data macro  ----*/
2626       
2627       /* --------------------------------------------------------------
2628          Load Technique Selection: Replace - EntireTable
2629          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2630          Additional options selections...
2631             Set unmapped to missing on updates: false
2632          -------------------------------------------------------------- */
2633       %macro etls_loader;
2634       
2635          %let etls_tableOptions = ;
2636       
2637          /* Determine if the target table exists  */
2638          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZINPUTC"n, DATA)) or
2639                %sysfunc(exist(PODSLIB1."RWP_TZINPUTC"n, VIEW)));
2640       
2641          %if &etls_tableExist %then
2642          %do;/* table exists  */
2643             %let etls_hasPreExistingConstraint=0;
2644       
2645             proc datasets lib = work nolist nowarn memtype = (data view);
2646                delete etls_commands etls_commands_F;
2647             quit;
2648       
2649             %let etls_otherTablesReferToThisTable=0;
2650       
2651             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2652                %put NOTE: Building table listing Constraints and Indexes for: &table;
2653                proc datasets lib=work nolist; delete &workTableOut; quit;
2654                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2655       
2656                data &workTableOut;
2657                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2658                   name = '';
2659                   type = '';
2660                   icown = '';
2661                   idxUnique = '';
2662                   idxNoMiss = '';
88                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2663                   recreate = '';
2664                   set &workTableOut;
2665                   ref = '';
2666                   type=upcase(type);
2667                   if type eq 'REFERENTIAL' then
2668                   do;
2669                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2670                           " another table: " ref;
2671                      call symput('etls_otherTablesReferToThisTable','1');
2672                      delete;
2673                   end;
2674                   if type='INDEX' and ICOwn eq 'YES' then delete;
2675                run;
2676                %rcSet(&syserr);
2677       
2678             %mend etls_CIContents;
2679       
2680             %etls_CIContents(table=PODSLIB1."RWP_TZINPUTC"n, workTableOut=etls_commands, inDSOptions=);
2681       
2682             %if &etls_otherTablesReferToThisTable %then
2683                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2683     ! constraints.;
2684             %else
2685             %do; /* okay - remove foreign keys  */
2686       
2687                data etls_commands_F;
2688                   set etls_commands;
2689                   if upcase(type)="FOREIGN KEY" then
2690                   do;
2691                      command='ic delete '||trim(name)||';';
2692                      output etls_commands_F;
2693                   end;
2694                run;
2695       
2696                %put %str(NOTE: Removing foreign keys before dropping table...);
2697                data _null_;
2698                   set etls_commands_F end=eof;
2699                   if _n_=1 then
2700                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZINPUTC"n;');
2701                   call execute(command);
2702                   if eof then call execute('; quit;');
2703                run;
2704                %rcSet(&syserr);
2705       
2706          %end; /* okay - remove foreign keys  */
2707       
2708          proc datasets lib = work nolist nowarn memtype = (data view);
2709             delete etls_commands etls_commands_F;
2710          quit;
2711       
2712          /*---- Drop a table  ----*/
2713          %put %str(NOTE: Dropping table ...);
2714          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
2715             delete "RWP_TZINPUTC"n;
2716          quit;
2717       
2718          %rcSet(&syserr);
2719       
89                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2720          %let etls_tableExist = 0;
2721       
2722       %end; /* table exists  */
2723       
2724       /*---- Create a new table  ----*/
2725       %if (&etls_tableExist eq 0) %then
2726       %do;  /* if table does not exist  */
2727       
2728          %put %str(NOTE: Creating table ...);
2729       
2730          data PODSLIB1."RWP_TZINPUTC"n
2731                  (COMPRESS = YES);
2732             attrib "_BIC_ZINPUTC"n length = $3
2733                format = $3.
2734                label = 'Input channel';
2735             attrib "LANGU"n length = $1
2736                format = $1.
2737                label = 'Language Key';
2738             attrib "TXTSH"n length = $20
2739                format = $20.
2740                label = 'Short description';
2741             call missing(of _all_);
2742             stop;
2743          run;
2744       
2745          %rcSet(&syserr);
2746       
2747       %end;  /* if table does not exist  */
2748       
2749       /*---- Append  ----*/
2750       %put %str(NOTE: Appending data ...);
2751       
2752       proc append base = PODSLIB1."RWP_TZINPUTC"n(COMPRESS = YES)
2753          data = &etls_lastTable (&etls_tableOptions)  force ;
2754        run;
2755       
2756       %rcSet(&syserr);
2757       
2758       %mend etls_loader;
2759       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZINPUTC"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
90                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZINPUTC"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZINPUTC"n;');
91                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZINPUTC"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZINPUTC (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.06 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZINPUTC"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZINPUTC"n length = $3 format = $3. label = 'Input channel';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZINPUTC has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZINPUTC"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZINPUTC'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZINPUTC'n to PODSLIB1.RWP_TZINPUTC.
NOTE: There were 201 observations read from the data set SAPRWP.'/BIC/TZINPUTC'n.
NOTE: 201 observations added.
NOTE: The data set PODSLIB1.RWP_TZINPUTC has 201 observations and 3 variables.
92                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Compressing data set PODSLIB1.RWP_TZINPUTC decreased size by 28.46 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.56 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
2760       
2761       %let etls_recCheckExist = 0;
2762       %let etls_recnt = 0;
2763       %macro etls_recordCheck;
2764          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZINPUTC"n, DATA)) or
2765                %sysfunc(exist(PODSLIB1."RWP_TZINPUTC"n, VIEW)));
2766       
2767          %if (&etls_recCheckExist) %then
2768          %do;
2769             %local etls_syntaxcheck;
2770             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2771             /* Turn off syntaxcheck option to perform following steps  */
2772             options nosyntaxcheck;
2773       
2774             proc contents data = PODSLIB1."RWP_TZINPUTC"n out = work.etls_contents(keep = nobs) noprint;
2775             run;
2776       
2777             data _null_;
2778                set work.etls_contents (obs = 1);
2779                call symput("etls_recnt", left(put(nobs,32.)));
2780             run;
2781       
2782             proc datasets lib = work nolist nowarn memtype = (data view);
2783                delete etls_contents;
2784             quit;
2785       
2786             /* Reset syntaxcheck option to previous setting  */
2787             options &etls_syntaxcheck;
2788          %end;
2789       %mend etls_recordCheck;
2790       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZINPUTC"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
93                                                         The SAS System                          09:30 Wednesday, December 2, 2020


MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2791       
2792       
2793       
2794       /** Step end Table Loader **/
2795       
2796       /*==========================================================================*
2797        * Step:            Table Loader                          A57BXQB4.BV00012X *
2798        * Transform:       Table Loader (Version 2.1)                              *
2799        * Description:                                                             *
2800        *                                                                          *
2801        * Source Table:    _BIC_TZZAFLD02 - -                    A57BXQB4.BE0001SN *
2802        *                   SAPrwp."/BIC/TZZAFLD02"n                               *
2803        * Target Table:    RWP_TZZAFLD02 -                       A57BXQB4.BE0001SO *
2804        *                   PODSLIB1."RWP_TZZAFLD02"n                              *
2805        *==========================================================================*/
2806       
2807       %let transformID = %quote(A57BXQB4.BV00012X);
2808       %let trans_rc = 0;
2809       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2810       
2811       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZZAFLD02"n);
2812       
2813       %global etls_sql_pushDown;
2814       %let etls_sql_pushDown = -1;
2815       option DBIDIRECTEXEC;
2816       
2817       %global etls_tableExist;
2818       %global etls_numIndex;
2819       %global etls_lastTable;
2820       %let etls_tableExist = -1;
2821       %let etls_numIndex = -1;
2822       %let etls_lastTable = &SYSLAST;
2823       
2824       /*---- Define load data macro  ----*/
2825       
2826       /* --------------------------------------------------------------
2827          Load Technique Selection: Replace - EntireTable
2828          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2829          Additional options selections...
2830             Set unmapped to missing on updates: false
2831          -------------------------------------------------------------- */
2832       %macro etls_loader;
2833       
2834          %let etls_tableOptions = ;
2835       
2836          /* Determine if the target table exists  */
94                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2837          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZZAFLD02"n, DATA)) or
2838                %sysfunc(exist(PODSLIB1."RWP_TZZAFLD02"n, VIEW)));
2839       
2840          %if &etls_tableExist %then
2841          %do;/* table exists  */
2842             %let etls_hasPreExistingConstraint=0;
2843       
2844             proc datasets lib = work nolist nowarn memtype = (data view);
2845                delete etls_commands etls_commands_F;
2846             quit;
2847       
2848             %let etls_otherTablesReferToThisTable=0;
2849       
2850             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2851                %put NOTE: Building table listing Constraints and Indexes for: &table;
2852                proc datasets lib=work nolist; delete &workTableOut; quit;
2853                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2854       
2855                data &workTableOut;
2856                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2857                   name = '';
2858                   type = '';
2859                   icown = '';
2860                   idxUnique = '';
2861                   idxNoMiss = '';
2862                   recreate = '';
2863                   set &workTableOut;
2864                   ref = '';
2865                   type=upcase(type);
2866                   if type eq 'REFERENTIAL' then
2867                   do;
2868                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2869                           " another table: " ref;
2870                      call symput('etls_otherTablesReferToThisTable','1');
2871                      delete;
2872                   end;
2873                   if type='INDEX' and ICOwn eq 'YES' then delete;
2874                run;
2875                %rcSet(&syserr);
2876       
2877             %mend etls_CIContents;
2878       
2879             %etls_CIContents(table=PODSLIB1."RWP_TZZAFLD02"n, workTableOut=etls_commands, inDSOptions=);
2880       
2881             %if &etls_otherTablesReferToThisTable %then
2882                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2882     ! constraints.;
2883             %else
2884             %do; /* okay - remove foreign keys  */
2885       
2886                data etls_commands_F;
2887                   set etls_commands;
2888                   if upcase(type)="FOREIGN KEY" then
2889                   do;
2890                      command='ic delete '||trim(name)||';';
2891                      output etls_commands_F;
2892                   end;
2893                run;
95                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2894       
2895                %put %str(NOTE: Removing foreign keys before dropping table...);
2896                data _null_;
2897                   set etls_commands_F end=eof;
2898                   if _n_=1 then
2899                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZZAFLD02"n;');
2900                   call execute(command);
2901                   if eof then call execute('; quit;');
2902                run;
2903                %rcSet(&syserr);
2904       
2905          %end; /* okay - remove foreign keys  */
2906       
2907          proc datasets lib = work nolist nowarn memtype = (data view);
2908             delete etls_commands etls_commands_F;
2909          quit;
2910       
2911          /*---- Drop a table  ----*/
2912          %put %str(NOTE: Dropping table ...);
2913          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
2914             delete "RWP_TZZAFLD02"n;
2915          quit;
2916       
2917          %rcSet(&syserr);
2918       
2919          %let etls_tableExist = 0;
2920       
2921       %end; /* table exists  */
2922       
2923       /*---- Create a new table  ----*/
2924       %if (&etls_tableExist eq 0) %then
2925       %do;  /* if table does not exist  */
2926       
2927          %put %str(NOTE: Creating table ...);
2928       
2929          data PODSLIB1."RWP_TZZAFLD02"n
2930                  (COMPRESS = YES);
2931             attrib "_BIC_ZZAFLD02"n length = $4
2932                format = $4.
2933                label = 'Gidiþ Kanalý';
2934             attrib "LANGU"n length = $1
2935                format = $1.
2936                label = 'Language Key';
2937             attrib "TXTSH"n length = $20
2938                format = $20.
2939                label = 'Short description';
2940             attrib "TXTMD"n length = $40
2941                format = $40.
2942                label = 'Medium description';
2943             call missing(of _all_);
2944             stop;
2945          run;
2946       
2947          %rcSet(&syserr);
2948       
2949       %end;  /* if table does not exist  */
2950       
2951       /*---- Append  ----*/
96                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2952       %put %str(NOTE: Appending data ...);
2953       
2954       proc append base = PODSLIB1."RWP_TZZAFLD02"n(COMPRESS = YES)
2955          data = &etls_lastTable (&etls_tableOptions)  force ;
2956        run;
2957       
2958       %rcSet(&syserr);
2959       
2960       %mend etls_loader;
2961       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZZAFLD02"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZZAFLD02"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

97                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZZAFLD02"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZZAFLD02"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZZAFLD02 (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.06 seconds
98                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZZAFLD02"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZAFLD02"n length = $4 format = $4. label = 'Gidiþ Kanalý';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZZAFLD02 has 0 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZZAFLD02"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZZAFLD02'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZZAFLD02'n to PODSLIB1.RWP_TZZAFLD02.
NOTE: There were 15 observations read from the data set SAPRWP.'/BIC/TZZAFLD02'n.
NOTE: 15 observations added.
NOTE: The data set PODSLIB1.RWP_TZZAFLD02 has 15 observations and 4 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZZAFLD02 decreased size by 68.51 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.44 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
2962       
2963       %let etls_recCheckExist = 0;
2964       %let etls_recnt = 0;
2965       %macro etls_recordCheck;
2966          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZZAFLD02"n, DATA)) or
2967                %sysfunc(exist(PODSLIB1."RWP_TZZAFLD02"n, VIEW)));
2968       
2969          %if (&etls_recCheckExist) %then
2970          %do;
2971             %local etls_syntaxcheck;
2972             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2973             /* Turn off syntaxcheck option to perform following steps  */
2974             options nosyntaxcheck;
2975       
2976             proc contents data = PODSLIB1."RWP_TZZAFLD02"n out = work.etls_contents(keep = nobs) noprint;
2977             run;
2978       
2979             data _null_;
2980                set work.etls_contents (obs = 1);
2981                call symput("etls_recnt", left(put(nobs,32.)));
2982             run;
2983       
99                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2984             proc datasets lib = work nolist nowarn memtype = (data view);
2985                delete etls_contents;
2986             quit;
2987       
2988             /* Reset syntaxcheck option to previous setting  */
2989             options &etls_syntaxcheck;
2990          %end;
2991       %mend etls_recordCheck;
2992       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZZAFLD02"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 4 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2993       
2994       
2995       
2996       /** Step end Table Loader **/
2997       
2998       /*==========================================================================*
2999        * Step:            Table Loader                          A57BXQB4.BV00012Y *
3000        * Transform:       Table Loader (Version 2.1)                              *
3001        * Description:                                                             *
3002        *                                                                          *
3003        * Source Table:    _BIC_AZCRMD2D00 - -                   A57BXQB4.BE00058B *
3004        *                   SAPrwp."/BIC/AZCRMD2D00"n                              *
3005        * Target Table:    RWP_AZCRMD2D00 -                      A57BXQB4.BE0001SQ *
3006        *                   PODSLIB1."RWP_AZCRMD2D00"n                             *
3007        *==========================================================================*/
3008       
3009       %let transformID = %quote(A57BXQB4.BV00012Y);
100                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3010       %let trans_rc = 0;
3011       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
3012       
3013       %let SYSLAST = %nrquote(SAPrwp."/BIC/AZCRMD2D00"n);
3014       
3015       %global etls_sql_pushDown;
3016       %let etls_sql_pushDown = -1;
3017       option DBIDIRECTEXEC;
3018       
3019       %global etls_tableExist;
3020       %global etls_numIndex;
3021       %global etls_lastTable;
3022       %let etls_tableExist = -1;
3023       %let etls_numIndex = -1;
3024       %let etls_lastTable = &SYSLAST;
3025       
3026       /*---- Define load data macro  ----*/
3027       
3028       /* --------------------------------------------------------------
3029          Load Technique Selection: Replace - EntireTable
3030          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
3031          Additional options selections...
3032             Set unmapped to missing on updates: false
3033          -------------------------------------------------------------- */
3034       %macro etls_loader;
3035       
3036          %let etls_tableOptions = ;
3037       
3038          /* Determine if the target table exists  */
3039          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_AZCRMD2D00"n, DATA)) or
3040                %sysfunc(exist(PODSLIB1."RWP_AZCRMD2D00"n, VIEW)));
3041       
3042          %if &etls_tableExist %then
3043          %do;/* table exists  */
3044             %let etls_hasPreExistingConstraint=0;
3045       
3046             proc datasets lib = work nolist nowarn memtype = (data view);
3047                delete etls_commands etls_commands_F;
3048             quit;
3049       
3050             %let etls_otherTablesReferToThisTable=0;
3051       
3052             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
3053                %put NOTE: Building table listing Constraints and Indexes for: &table;
3054                proc datasets lib=work nolist; delete &workTableOut; quit;
3055                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
3056       
3057                data &workTableOut;
3058                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
3059                   name = '';
3060                   type = '';
3061                   icown = '';
3062                   idxUnique = '';
3063                   idxNoMiss = '';
3064                   recreate = '';
3065                   set &workTableOut;
3066                   ref = '';
3067                   type=upcase(type);
101                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3068                   if type eq 'REFERENTIAL' then
3069                   do;
3070                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
3071                           " another table: " ref;
3072                      call symput('etls_otherTablesReferToThisTable','1');
3073                      delete;
3074                   end;
3075                   if type='INDEX' and ICOwn eq 'YES' then delete;
3076                run;
3077                %rcSet(&syserr);
3078       
3079             %mend etls_CIContents;
3080       
3081             %etls_CIContents(table=PODSLIB1."RWP_AZCRMD2D00"n, workTableOut=etls_commands, inDSOptions=);
3082       
3083             %if &etls_otherTablesReferToThisTable %then
3084                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
3084     ! constraints.;
3085             %else
3086             %do; /* okay - remove foreign keys  */
3087       
3088                data etls_commands_F;
3089                   set etls_commands;
3090                   if upcase(type)="FOREIGN KEY" then
3091                   do;
3092                      command='ic delete '||trim(name)||';';
3093                      output etls_commands_F;
3094                   end;
3095                run;
3096       
3097                %put %str(NOTE: Removing foreign keys before dropping table...);
3098                data _null_;
3099                   set etls_commands_F end=eof;
3100                   if _n_=1 then
3101                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_AZCRMD2D00"n;');
3102                   call execute(command);
3103                   if eof then call execute('; quit;');
3104                run;
3105                %rcSet(&syserr);
3106       
3107          %end; /* okay - remove foreign keys  */
3108       
3109          proc datasets lib = work nolist nowarn memtype = (data view);
3110             delete etls_commands etls_commands_F;
3111          quit;
3112       
3113          /*---- Drop a table  ----*/
3114          %put %str(NOTE: Dropping table ...);
3115          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
3116             delete "RWP_AZCRMD2D00"n;
3117          quit;
3118       
3119          %rcSet(&syserr);
3120       
3121          %let etls_tableExist = 0;
3122       
3123       %end; /* table exists  */
3124       
102                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3125       /*---- Create a new table  ----*/
3126       %if (&etls_tableExist eq 0) %then
3127       %do;  /* if table does not exist  */
3128       
3129          %put %str(NOTE: Creating table ...);
3130       
3131          data PODSLIB1."RWP_AZCRMD2D00"n
3132                  (COMPRESS = YES);
3133             attrib "CRM_OBJ_ID"n length = $10
3134                format = $10.
3135                label = 'Transaction Number';
3136             attrib "RECORDMODE"n length = $1
3137                format = $1.
3138                label = 'BW Delta Process: Record Mode';
3139             attrib "CALDAY"n length = 8
3140                format = DATE9.
3141                label = 'Calendar day';
3142             attrib "BP_ACTIVIT"n length = $10
3143                format = $10.
3144                label = 'Contact Partner';
3145             attrib "CRM_RCO"n length = $4
3146                format = $4.
3147                label = 'Current Code: Reasons';
3148             attrib "CRM_RCA"n length = $2
3149                format = $2.
3150                label = 'Current Catalog: Reasons';
3151             attrib "CRM_RG"n length = $8
3152                format = $8.
3153                label = 'Current Code Group: Reasons';
3154             attrib "CRM_USSTAT"n length = $5
3155                format = $5.
3156                label = 'User Status';
3157             attrib "CRM_PLTO"n length = 8
3158                format = DATE9.
3159                label = 'Planned Date To';
3160             attrib "_BIC_ZOPEND"n length = 8
3161                format = DATE9.
3162                label = 'Open Date';
3163             attrib "_BIC_ZEPDKD"n length = 8
3164                format = DATE9.
3165                label = 'EPDK Date';
3166             attrib "_BIC_ZPAIDD"n length = 8
3167                format = DATE9.
3168                label = 'Paid Date';
3169             attrib "_BIC_ZPLAND"n length = 8
3170                format = DATE9.
3171                label = 'Plan Date';
3172             attrib "_BIC_ZD2DTRH"n length = 8
3173                format = DATE9.;
3174             attrib "BP_RESPPER"n length = $10
3175                format = $10.
3176                label = 'Employee Responsible';
3177             attrib "UCINSTALLA"n length = $10
3178                format = $10.
3179                label = 'Installation Number: Utilities Industry';
3180             attrib "CRM_STSMA"n length = $8
3181                format = $8.
3182                label = 'Status Profile';
103                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3183             attrib "_BIC_ZEXACTID"n length = $20
3184                format = $20.;
3185             attrib "_BIC_ZEXT_UI"n length = $50
3186                format = $50.
3187                label = 'Meter ETSO Code';
3188             attrib "_BIC_ZTERIMZM"n length = $10
3189                format = $10.;
3190             attrib "_BIC_ZMUSTTIPC"n length = $2
3191                format = $2.;
3192             attrib "_BIC_ZSAYSERI"n length = $18
3193                format = $18.;
3194             attrib "CRM_DESCR"n length = $40
3195                format = $40.
3196                label = 'Description of a Transaction';
3197             attrib "CRM_PRCTYP"n length = $4
3198                format = $4.
3199                label = 'Business Transaction Type';
3200             attrib "CRM_PRIO_A"n length = $1
3201                format = $1.
3202                label = 'Priority';
3203             attrib "CRM_ACFR"n length = 8
3204                format = DATE9.
3205                label = 'Actual Date From';
3206             attrib "CREATEDON"n length = 8
3207                format = DATE9.
3208                label = 'Date on which the record was created';
3209             attrib "_BIC_ZCRMOBJID"n length = $10
3210                format = $10.;
3211             attrib "CACONT_ACC"n length = $12
3212                format = $12.
3213                label = 'Contract Account (Partner-Independent Data)';
3214             attrib "_BIC_ZPOD_GUID"n length = $22
3215                format = $22.;
3216             attrib "UCCONTRACT"n length = $10
3217                format = $10.
3218                label = 'Contract Number: Utilities Industry';
3219             attrib "_BIC_ZCCREBY"n length = $12
3220                format = $12.
3221                label = 'Created By';
3222             attrib "UC_CONNOBJ"n length = $30
3223                format = $30.
3224                label = 'Connection Object in the Utilities Industry';
3225             attrib "_BIC_ZWMADR01"n length = $60
3226                format = $60.
3227                label = 'Tükeim yeri adres (2)';
3228             attrib "CALMONTH"n length = $6
3229                format = $6.
3230                label = 'Calendar year/month';
3231             attrib "_BIC_ZRTEFAKT3"n length = $10
3232                format = $10.;
3233             attrib "UCRATEFAKT"n length = $10
3234                format = $10.
3235                label = 'Rate Fact Group';
3236             attrib "_BIC_ZCRM_OBJ2"n length = $10
3237                format = $10.;
3238             attrib "_BIC_ZCRMSTAT2"n length = $5
3239                format = $5.;
3240             attrib "_BIC_ZCCCHR"n length = $45
104                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3241                format = $45.
3242                label = 'CCC Organization Code';
3243             attrib "ST_UP_DTE"n length = 8
3244                format = DATE9.
3245                label = 'Update Date Statistics';
3246             attrib "GCC_UPDTM"n length = 8
3247                format = TIME8.
3248                label = 'Update Time';
3249             attrib "CRM_OHGUID"n length = $32
3250                format = $32.
3251                label = 'GUID of a CRM Order Object';
3252             attrib "_BIC_ZD2D_ADR"n length = $100
3253                format = $100.;
3254             attrib "_BIC_ZCRMSTSMA"n length = $8
3255                format = $8.;
3256             attrib "_BIC_ZUCDAYCT7"n length = 8
3257                format = 19.3
3258                label = 'Number of Days Billed';
3259             attrib "REGION"n length = $3
3260                format = $3.
3261                label = 'Region (State, Province, County)';
3262             attrib "COUNTRY"n length = $3
3263                format = $3.
3264                label = 'Country Key';
3265             attrib "_BIC_ZCRMSTAT"n length = $5
3266                format = $5.;
3267             attrib "COMP_CODE"n length = $4
3268                format = $4.
3269                label = 'Company code';
3270             attrib "_BIC_ZCRMG"n length = $1
3271                format = $1.
3272                label = 'CRM Group';
3273             attrib "_BIC_ZALTNEDEN"n length = $50
3274                format = $50.;
3275             attrib "CRM_RSN_CO"n length = $4
3276                format = $4.
3277                label = 'Activity Reason (Code)';
3278             attrib "CRM_RSN_GR"n length = $8
3279                format = $8.
3280                label = 'Activity Reason (Code Group)';
3281             attrib "CRM_RSN_TY"n length = $2
3282                format = $2.
3283                label = 'Activity Reason (Catalog)';
3284             attrib "CRM_ACTTIM"n length = 8
3285                format = TIME8.
3286                label = 'Activity time (Planned/Actual from)';
3287             attrib "_BIC_ZSORORG"n length = $10
3288                format = $10.;
3289             attrib "_BIC_ZAORG2"n length = $10
3290                format = $10.;
3291             attrib "_BIC_ZSECNEDEN"n length = $4
3292                format = $4.;
3293             attrib "_BIC_ZVEKBP"n length = $10
3294                format = $10.;
3295             attrib "_BIC_ZVEK"n length = $2
3296                format = $2.;
3297             attrib "_BIC_ZSECASH"n length = $1
3298                format = $1.;
105                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3299             attrib "_BIC_ZEVS"n length = $2
3300                format = $2.;
3301             attrib "_BIC_ZILG"n length = $10
3302                format = $10.
3303                label = 'Ýlgili kiþi';
3304             attrib "_BIC_ZIDNUMBER"n length = $60
3305                format = $60.
3306                label = 'ID Number';
3307             attrib "_BIC_ZPAKET"n length = $60
3308                format = $60.
3309                label = 'Paket';
3310             attrib "_BIC_ZNEDEN"n length = $40
3311                format = $40.;
3312             attrib "_BIC_ZAGVNCBDL"n length = 8
3313                format = 19.2;
3314             attrib "_BIC_ZAGVNCATP"n length = $4
3315                format = $4.;
3316             attrib "_BIC_ZAGVNCTPI"n length = $1
3317                format = $1.;
3318             attrib "_BIC_ZMGTURTT"n length = $6
3319                format = $6.;
3320             attrib "_BIC_ZMGVNCBDL"n length = 8
3321                format = 19.2;
3322             attrib "_BIC_ZIMZA"n length = 8
3323                format = DATE9.;
3324             attrib "_BIC_ZD2D_RATE"n length = $10
3325                format = $10.;
3326             attrib "_BIC_ZZRMSCORE"n length = $10
3327                format = $10.;
3328             attrib "UCBILL_CLA"n length = $4
3329                format = $4.
3330                label = 'Billing Class';
3331             attrib "UCSGR_CONT"n length = $2
3332                format = $2.
3333                label = 'Statistic Group Contract';
3334             attrib "_BIC_ZMAX1"n length = 8
3335                format = 19.3;
3336             attrib "_BIC_ZMAX2"n length = 8
3337                format = 19.3;
3338             attrib "UCPREMISTY"n length = $8
3339                format = $8.
3340                label = 'Type of Premise';
3341             attrib "_BIC_ZZEIL"n length = $12
3342                format = $12.;
3343             attrib "_BIC_ZZFLD003K"n length = $34
3344                format = $34.;
3345             attrib "_BIC_ZD2D_SON"n length = 8
3346                format = DATE9.;
3347             call missing(of _all_);
3348             stop;
3349          run;
3350       
3351          %rcSet(&syserr);
3352       
3353       %end;  /* if table does not exist  */
3354       
3355       /*---- Append  ----*/
3356       %put %str(NOTE: Appending data ...);
106                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3357       
3358       proc append base = PODSLIB1."RWP_AZCRMD2D00"n(COMPRESS = YES)
3359          data = &etls_lastTable (&etls_tableOptions)  force ;
3360        run;
3361       
3362       %rcSet(&syserr);
3363       
3364       %mend etls_loader;
3365       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_AZCRMD2D00"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_AZCRMD2D00"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
107                                                        The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_AZCRMD2D00"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_AZCRMD2D00"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_AZCRMD2D00 (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           2.04 seconds
      cpu time            0.01 seconds
108                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_AZCRMD2D00"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "CRM_OBJ_ID"n length = $10 format = $10. label = 'Transaction Number';
MPRINT(ETLS_LOADER):   attrib "RECORDMODE"n length = $1 format = $1. label = 'BW Delta Process: Record Mode';
MPRINT(ETLS_LOADER):   attrib "CALDAY"n length = 8 format = DATE9. label = 'Calendar day';
MPRINT(ETLS_LOADER):   attrib "BP_ACTIVIT"n length = $10 format = $10. label = 'Contact Partner';
MPRINT(ETLS_LOADER):   attrib "CRM_RCO"n length = $4 format = $4. label = 'Current Code: Reasons';
MPRINT(ETLS_LOADER):   attrib "CRM_RCA"n length = $2 format = $2. label = 'Current Catalog: Reasons';
MPRINT(ETLS_LOADER):   attrib "CRM_RG"n length = $8 format = $8. label = 'Current Code Group: Reasons';
MPRINT(ETLS_LOADER):   attrib "CRM_USSTAT"n length = $5 format = $5. label = 'User Status';
MPRINT(ETLS_LOADER):   attrib "CRM_PLTO"n length = 8 format = DATE9. label = 'Planned Date To';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZOPEND"n length = 8 format = DATE9. label = 'Open Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZEPDKD"n length = 8 format = DATE9. label = 'EPDK Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPAIDD"n length = 8 format = DATE9. label = 'Paid Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPLAND"n length = 8 format = DATE9. label = 'Plan Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZD2DTRH"n length = 8 format = DATE9.;
MPRINT(ETLS_LOADER):   attrib "BP_RESPPER"n length = $10 format = $10. label = 'Employee Responsible';
MPRINT(ETLS_LOADER):   attrib "UCINSTALLA"n length = $10 format = $10. label = 'Installation Number: Utilities Industry';
MPRINT(ETLS_LOADER):   attrib "CRM_STSMA"n length = $8 format = $8. label = 'Status Profile';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZEXACTID"n length = $20 format = $20.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZEXT_UI"n length = $50 format = $50. label = 'Meter ETSO Code';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZTERIMZM"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZMUSTTIPC"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSAYSERI"n length = $18 format = $18.;
MPRINT(ETLS_LOADER):   attrib "CRM_DESCR"n length = $40 format = $40. label = 'Description of a Transaction';
MPRINT(ETLS_LOADER):   attrib "CRM_PRCTYP"n length = $4 format = $4. label = 'Business Transaction Type';
MPRINT(ETLS_LOADER):   attrib "CRM_PRIO_A"n length = $1 format = $1. label = 'Priority';
MPRINT(ETLS_LOADER):   attrib "CRM_ACFR"n length = 8 format = DATE9. label = 'Actual Date From';
MPRINT(ETLS_LOADER):   attrib "CREATEDON"n length = 8 format = DATE9. label = 'Date on which the record was created';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMOBJID"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "CACONT_ACC"n length = $12 format = $12. label = 'Contract Account (Partner-Independent Data)';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPOD_GUID"n length = $22 format = $22.;
MPRINT(ETLS_LOADER):   attrib "UCCONTRACT"n length = $10 format = $10. label = 'Contract Number: Utilities Industry';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCCREBY"n length = $12 format = $12. label = 'Created By';
MPRINT(ETLS_LOADER):   attrib "UC_CONNOBJ"n length = $30 format = $30. label = 'Connection Object in the Utilities Industry';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZWMADR01"n length = $60 format = $60. label = 'Tükeim yeri adres (2)';
MPRINT(ETLS_LOADER):   attrib "CALMONTH"n length = $6 format = $6. label = 'Calendar year/month';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZRTEFAKT3"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "UCRATEFAKT"n length = $10 format = $10. label = 'Rate Fact Group';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRM_OBJ2"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMSTAT2"n length = $5 format = $5.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCCCHR"n length = $45 format = $45. label = 'CCC Organization Code';
MPRINT(ETLS_LOADER):   attrib "ST_UP_DTE"n length = 8 format = DATE9. label = 'Update Date Statistics';
MPRINT(ETLS_LOADER):   attrib "GCC_UPDTM"n length = 8 format = TIME8. label = 'Update Time';
MPRINT(ETLS_LOADER):   attrib "CRM_OHGUID"n length = $32 format = $32. label = 'GUID of a CRM Order Object';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZD2D_ADR"n length = $100 format = $100.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMSTSMA"n length = $8 format = $8.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZUCDAYCT7"n length = 8 format = 19.3 label = 'Number of Days Billed';
MPRINT(ETLS_LOADER):   attrib "REGION"n length = $3 format = $3. label = 'Region (State, Province, County)';
MPRINT(ETLS_LOADER):   attrib "COUNTRY"n length = $3 format = $3. label = 'Country Key';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMSTAT"n length = $5 format = $5.;
MPRINT(ETLS_LOADER):   attrib "COMP_CODE"n length = $4 format = $4. label = 'Company code';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMG"n length = $1 format = $1. label = 'CRM Group';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZALTNEDEN"n length = $50 format = $50.;
MPRINT(ETLS_LOADER):   attrib "CRM_RSN_CO"n length = $4 format = $4. label = 'Activity Reason (Code)';
109                                                        The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   attrib "CRM_RSN_GR"n length = $8 format = $8. label = 'Activity Reason (Code Group)';
MPRINT(ETLS_LOADER):   attrib "CRM_RSN_TY"n length = $2 format = $2. label = 'Activity Reason (Catalog)';
MPRINT(ETLS_LOADER):   attrib "CRM_ACTTIM"n length = 8 format = TIME8. label = 'Activity time (Planned/Actual from)';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSORORG"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZAORG2"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSECNEDEN"n length = $4 format = $4.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZVEKBP"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZVEK"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSECASH"n length = $1 format = $1.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZEVS"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZILG"n length = $10 format = $10. label = 'Ýlgili kiþi';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZIDNUMBER"n length = $60 format = $60. label = 'ID Number';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPAKET"n length = $60 format = $60. label = 'Paket';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZNEDEN"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZAGVNCBDL"n length = 8 format = 19.2;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZAGVNCATP"n length = $4 format = $4.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZAGVNCTPI"n length = $1 format = $1.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZMGTURTT"n length = $6 format = $6.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZMGVNCBDL"n length = 8 format = 19.2;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZIMZA"n length = 8 format = DATE9.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZD2D_RATE"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZRMSCORE"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "UCBILL_CLA"n length = $4 format = $4. label = 'Billing Class';
MPRINT(ETLS_LOADER):   attrib "UCSGR_CONT"n length = $2 format = $2. label = 'Statistic Group Contract';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZMAX1"n length = 8 format = 19.3;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZMAX2"n length = 8 format = 19.3;
MPRINT(ETLS_LOADER):   attrib "UCPREMISTY"n length = $8 format = $8. label = 'Type of Premise';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZEIL"n length = $12 format = $12.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZFLD003K"n length = $34 format = $34.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZD2D_SON"n length = 8 format = DATE9.;
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_AZCRMD2D00 has 0 observations and 83 variables.
NOTE: DATA statement used (Total process time):
      real time           0.08 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_AZCRMD2D00"n(COMPRESS = YES) data = SAPRWP.'/BIC/AZCRMD2D00'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/AZCRMD2D00'n to PODSLIB1.RWP_AZCRMD2D00.
WARNING: Variable _BIC_ZSOZ_BCOD was not found on BASE file. The variable will not be added to the BASE file.
WARNING: Variable _BIC_ZSOZ_VER was not found on BASE file. The variable will not be added to the BASE file.
WARNING: Variable _BIC_ZMUSTTUR was not found on BASE file. The variable will not be added to the BASE file.
NOTE: FORCE is specified, so dropping/truncating will occur.
WARNING: Some character data was lost during transcoding in the dataset SAPRWP.'/BIC/AZCRMD2D00'n. Either the data contains 
         characters that are not representable in the new encoding or truncation occurred during transcoding.
NOTE: There were 7564526 observations read from the data set SAPRWP.'/BIC/AZCRMD2D00'n.
NOTE: 11116960 observations added.
NOTE: The data set PODSLIB1.RWP_AZCRMD2D00 has 11116960 observations and 83 variables.
NOTE: Compressing data set PODSLIB1.RWP_AZCRMD2D00 decreased size by 65.75 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           22:40.75
110                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      cpu time            3:24.35
      

MPRINT(ETLS_LOADER):  ;
3366       
3367       %let etls_recCheckExist = 0;
3368       %let etls_recnt = 0;
3369       %macro etls_recordCheck;
3370          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_AZCRMD2D00"n, DATA)) or
3371                %sysfunc(exist(PODSLIB1."RWP_AZCRMD2D00"n, VIEW)));
3372       
3373          %if (&etls_recCheckExist) %then
3374          %do;
3375             %local etls_syntaxcheck;
3376             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
3377             /* Turn off syntaxcheck option to perform following steps  */
3378             options nosyntaxcheck;
3379       
3380             proc contents data = PODSLIB1."RWP_AZCRMD2D00"n out = work.etls_contents(keep = nobs) noprint;
3381             run;
3382       
3383             data _null_;
3384                set work.etls_contents (obs = 1);
3385                call symput("etls_recnt", left(put(nobs,32.)));
3386             run;
3387       
3388             proc datasets lib = work nolist nowarn memtype = (data view);
3389                delete etls_contents;
3390             quit;
3391       
3392             /* Reset syntaxcheck option to previous setting  */
3393             options &etls_syntaxcheck;
3394          %end;
3395       %mend etls_recordCheck;
3396       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_AZCRMD2D00"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 83 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
111                                                        The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
3397       
3398       
3399       
3400       /** Step end Table Loader **/
3401       
3402       %let etls_endTime = %sysfunc(datetime(),datetime.);
3403       

ERROR: Errors printed on page 6.

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           59:43.84
      cpu time            8:50.77
      


