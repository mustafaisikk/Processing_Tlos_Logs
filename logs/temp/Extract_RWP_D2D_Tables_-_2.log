NOTE: Log file opened at  Wed, 2 Dec 2020 09:30:00.824
1                                                          The SAS System                          09:30 Wednesday, December 2, 2020

ERROR: The SAS System is executing on a processor (CPU) whose model name, 
       model number, and serial number are not included in the setinit data 
       used to initialize the SAS System library in use. This is permitted if 
       this processor is a designated backup processor for a licensed CPU.
For this site, the SAS system is licensed for the following CPU serial 
numbers:
Model  **EEDPA0* Serial Number +4
ERROR: The requested node name EEDPA0 does not match the actual node name 
ERSDPA0.
NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M6) 
      Licensed to ENERJISA -TOROSLAR - DATA MANAGEMENT ADV PROD., Site 70166440.
NOTE: This session is executing on the AIX 7.2 (AIX 64) platform.



NOTE: Analytical products:
      
      SAS/STAT 15.1
      SAS/ETS 15.1

ERROR: The SAS System is executing on a processor (CPU) whose model name, model number, and serial number are not included in the 
       setinit data used to initialize the SAS System library in use. This is permitted if this processor is a designated backup 
       processor for a licensed CPU.
For this site, the SAS system is licensed for the following CPU serial numbers:

Model  **EEDPA0* Serial Number +4
ERROR: The requested node name EEDPA0 does not match the actual node name ERSDPA0.

WARNING: Your system is scheduled to expire on January 5, 2021, which is 34 days from now. The SAS System will no longer function 
         on or after that date. Please contact your SAS Installation Representative to obtain your updated SAS Installation Data 
         (SID) file, which includes SETINIT information.
To locate the name of your SAS Installation Representative go to http://support.sas.com/repfinder and provide your site number 
70166440 and company name as ENERJISA -TOROSLAR - DATA MANAGEMENT ADV PROD.. On the SAS REP list provided, locate the REP for 
operating system AIX 64.
NOTE: Additional host information:

IBM AIX AIX 64 2 7 00C9C0374C00 

You are running SAS 9. Some SAS 8 files will be automatically converted 
by the V9 engine; others are incompatible.  Please see 
http://support.sas.com/rnd/migration/planning/platform/64bit.html

PROC MIGRATE will preserve current SAS file attributes and is 
recommended for converting all your SAS libraries from any 
SAS 8 release to SAS 9.  For details and examples, please see
http://support.sas.com/rnd/migration/index.html


This message is contained in the SAS news file, and is presented upon
initialization.  Edit the file "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.




NOTE: SAS initialization used:
2                                                          The SAS System                          09:30 Wednesday, December 2, 2020

      real time           0.06 seconds
      cpu time            0.01 seconds
      
WARNING: The Base SAS Software product with which IOM CLSID:6E56FD51-CFC1-11D5-87BD-00C04F38F0DB is associated will be expiring 
         soon, and is currently in warning mode to indicate this upcoming expiration. Please run PROC SETINIT to obtain more 
         information on your warning period.
NOTE: This is a SPD 5.4  Engine 
      executing SAS (r) 9.4 (TS1M6) on the AIX platform.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
3                                                          The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
4                                                          The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: User sas(ACL Group ) connected to SPD(AIX) 5.4 server at 10.166.0.39.
NOTE: Libref SASDATA successfully assigned from logical server.
NOTE: Libref STPSAMP successfully assigned from logical server.
NOTE: Libref MIGLIB successfully assigned from logical server.
NOTE: Libref TRNLIB2 successfully assigned from logical server.
NOTE: Libref TRNLIB successfully assigned from logical server.
NOTE: Libref NEDLIB successfully assigned from logical server.
NOTE: Libref PILIB successfully assigned from logical server.
NOTE: Libref DMLIB successfully assigned from logical server.
NOTE: Libref TMPLIB3 successfully assigned from logical server.
NOTE: Libref TMPLIB4 successfully assigned from logical server.
NOTE: Libref ODSLIB successfully assigned from logical server.
NOTE: Libref ODSLIB2 successfully assigned from logical server.
NOTE: Libref ODSLIB3 successfully assigned from logical server.
NOTE: Libref PODSLIB1 successfully assigned from logical server.
NOTE: Libref PODSLIB2 successfully assigned from logical server.
NOTE: Libref PODSLIB3 successfully assigned from logical server.
NOTE: Libref DASHLIBD successfully assigned from logical server.
NOTE: Libref QLIKLIB successfully assigned from logical server.
WARNING: Libref SQLKODA may not have assigned correctly from logical server.
NOTE: The product with which the engine SQLSVR is associated will be expiring soon, and is currently in warning mode to indicate 
this upcoming expiration.  Please run PROC SETINIT to obtain more information on your warning period.
WARNING: Libref RISU may not have assigned correctly from logical server.
NOTE: The product with which the engine SAPHANA is associated will be expiring soon, and is currently in warning mode to indicate 
this upcoming expiration.  Please run PROC SETINIT to obtain more information on your warning period.
WARNING: Libref DQ_ORCL may not have assigned correctly from logical server.
NOTE: The product with which the engine ORACLE is associated will be expiring soon, and is currently in warning mode to indicate 
this upcoming expiration.  Please run PROC SETINIT to obtain more information on your warning period.
NOTE: Library ZGRLIB does not exist.
NOTE: Libref HANARWP successfully assigned from logical server.
NOTE: Libref BFLIB successfully assigned from logical server.
NOTE: Libref PILIB2 successfully assigned from logical server.
NOTE: Libref TMPLIB2 successfully assigned from logical server.
NOTE: Libref DMLIB2 successfully assigned from logical server.
NOTE: Libref ARCLIB successfully assigned from logical server.
NOTE: Libref IADM successfully assigned from logical server.
NOTE: Libref IATMP successfully assigned from logical server.
NOTE: Libref AUTODIAL successfully assigned from logical server.
NOTE: Libref BCSDM successfully assigned from logical server.
NOTE: Libref BLDM successfully assigned from logical server.
NOTE: Libref BLTMP successfully assigned from logical server.
NOTE: Libref BADM successfully assigned from logical server.
NOTE: Libref BATMP successfully assigned from logical server.
NOTE: Libref CCDM successfully assigned from logical server.
NOTE: Libref CCDM2 successfully assigned from logical server.
NOTE: Libref CMPDM successfully assigned from logical server.
5                                                          The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Libref CPSFRC successfully assigned from logical server.
NOTE: Libref CPSHRLY successfully assigned from logical server.
NOTE: Libref CPSREG successfully assigned from logical server.
NOTE: Libref CPSUST successfully assigned from logical server.
NOTE: Libref CXDM successfully assigned from logical server.
NOTE: Libref DBALIB successfully assigned from logical server.
NOTE: Libref DSTDM successfully assigned from logical server.
NOTE: Libref DSTTMP successfully assigned from logical server.
NOTE: Libref DYMDM successfully assigned from logical server.
NOTE: Libref DYMTMP successfully assigned from logical server.
NOTE: Libref EAP_ETY successfully assigned from logical server.
NOTE: Libref EAP_PAY successfully assigned from logical server.
NOTE: Libref EAP_PR successfully assigned from logical server.
NOTE: Libref EPYDM successfully assigned from logical server.
NOTE: Libref EPYTMP successfully assigned from logical server.
NOTE: Libref ETSDM successfully assigned from logical server.
NOTE: Libref FADM successfully assigned from logical server.
NOTE: Libref FPCLIB successfully assigned from logical server.
NOTE: Libref FPCTMP successfully assigned from logical server.
NOTE: Libref HRDM successfully assigned from logical server.
NOTE: Libref KMHMDM successfully assigned from logical server.
NOTE: Libref CSSLIB successfully assigned from logical server.
NOTE: Libref MDLIB successfully assigned from logical server.
NOTE: Libref MHMAYEDS successfully assigned from logical server.
NOTE: Libref MHMDM successfully assigned from logical server.
NOTE: Libref MIGLIB2 successfully assigned from logical server.
NOTE: Libref MSADM successfully assigned from logical server.
NOTE: Libref MSATMP successfully assigned from logical server.
NOTE: Libref MTHEO successfully assigned from logical server.
NOTE: Libref MTHKA successfully assigned from logical server.
NOTE: Libref MTHMA successfully assigned from logical server.
NOTE: Libref MTHSO successfully assigned from logical server.
NOTE: Libref MTHTMP successfully assigned from logical server.
NOTE: Libref D2DLIB successfully assigned from logical server.
NOTE: Libref OKMDM successfully assigned from logical server.
NOTE: Libref OKMTMP successfully assigned from logical server.
NOTE: Libref PMDM successfully assigned from logical server.
NOTE: Libref CNPRCDM successfully assigned from logical server.
NOTE: Libref CNPRCTMP successfully assigned from logical server.
NOTE: Libref EDULIB successfully assigned from logical server.
NOTE: Libref PRCDM successfully assigned from logical server.
NOTE: Libref PRCDM2 successfully assigned from logical server.
NOTE: Libref PRCTMP successfully assigned from logical server.
NOTE: Libref PRFTBLIB successfully assigned from logical server.
NOTE: Libref TMPLIB successfully assigned from logical server.
NOTE: Libref FRCARC successfully assigned from logical server.
NOTE: Libref FRCPRD successfully assigned from logical server.
NOTE: Libref PRCHARC successfully assigned from logical server.
NOTE: Libref PRCHPRD successfully assigned from logical server.
NOTE: Libref PRICARC successfully assigned from logical server.
NOTE: Libref PRICPRD successfully assigned from logical server.
NOTE: Libref QL_SALES successfully assigned from logical server.
NOTE: Libref RAPOUT successfully assigned from logical server.
NOTE: Libref RAPREF successfully assigned from logical server.
NOTE: Libref RAPTEST successfully assigned from logical server.
NOTE: Libref RAPTMP successfully assigned from logical server.
NOTE: Libref RAPVAS successfully assigned from logical server.
NOTE: Libref REFCPS successfully assigned from logical server.
6                                                          The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Libref RMCDM successfully assigned from logical server.
NOTE: Libref RMCTMP successfully assigned from logical server.
NOTE: Libref SDLIB successfully assigned from logical server.
NOTE: Libref SOMLIB successfully assigned from logical server.
NOTE: Libref SHFDM successfully assigned from logical server.
NOTE: Libref SODM successfully assigned from logical server.
NOTE: Libref SOPDM successfully assigned from logical server.
NOTE: Libref SOSUF successfully assigned from logical server.
NOTE: Libref SOTMP successfully assigned from logical server.
NOTE: Libref SPDM successfully assigned from logical server.
NOTE: Libref SSIMDM successfully assigned from logical server.
NOTE: Libref STLF successfully assigned from logical server.
NOTE: Libref SMDM successfully assigned from logical server.
NOTE: Libref SMTMP successfully assigned from logical server.
NOTE: Libref TALDM successfully assigned from logical server.
NOTE: Libref TKDM successfully assigned from logical server.
NOTE: Libref TSDM successfully assigned from logical server.
NOTE: Libref QVYDM successfully assigned from logical server.
NOTE: Libref STJVYDM successfully assigned from logical server.
NOTE: Libref VYDM successfully assigned from logical server.
NOTE: Libref VYDMKVKK successfully assigned from logical server.
NOTE: Libref OGMDM successfully assigned from logical server.
NOTE: Libref OGMTMP successfully assigned from logical server.
NOTE: Libref CRLIB successfully assigned from logical server.
NOTE: Libref RASTMP successfully assigned from logical server.
NOTE: Libref SOSEC successfully assigned from logical server.
NOTE: Libref STATLIB successfully assigned from logical server.
ERROR: Libref SMARTHMP failed to assign from logical server.
ERROR: ORACLE connection error: ORA-12514: TNS: Dinleyici þu anda baðlantý açýklayýcýsýnda belirtilen hizmeti tanýmýyor..
ERROR: Libref SMARTHMT failed to assign from logical server.
ERROR: ORACLE connection error: ORA-12514: TNS: Dinleyici þu anda baðlantý açýklayýcýsýnda belirtilen hizmeti tanýmýyor..
ERROR: Libref SMSPRD failed to assign from logical server.
ERROR: ORACLE connection error: ORA-12170: TNS: Baðlantý zaman aþýmý oluþtu.
NOTE: Libref RAPARCH successfully assigned from logical server.
NOTE: Libref SAHOL successfully assigned from logical server.
NOTE: Libref MKVR successfully assigned from logical server.
NOTE: Libref RODQLIK successfully assigned from logical server.
NOTE: Libref UTFLIB successfully assigned from logical server.

NOTE: AUTOEXEC processing beginning; file is /sas/config/Lev1/SASApp/BatchServer/autoexec.sas.


NOTE: AUTOEXEC processing completed.

1          /****************************************************************************
2           * Job:             Extract RWP D2D Tables - 2            A57BXQB4.BT00008B *
3           * Description:                                                             *
4           *                                                                          *
5           * Metadata Server: ersupa0.enerjisa.local                                  *
6           * Port:            8561                                                    *
7           * Location:        /Data Integration/Jobs/9. Extraction_Tr/3. Master Data  *
8           *                   - RWP                                                  *
9           *                                                                          *
10          * Server:          SASApp                                A57BXQB4.AS000002 *
11          *                                                                          *
12          * Source Tables:   _BIC_TZCRMPKFT - -                    A57BXQB4.BE0001SR *
13          *                   SAPrwp./BIC/TZCRMPKFT                                  *
14          *                  _BI0_TUCSGR_CONT - -                  A57BXQB4.BE0001ST *
7                                                          The SAS System                          09:30 Wednesday, December 2, 2020

15          *                   SAPrwp./BI0/TUCSGR_CONT                                *
16          *                  _BI0_TUCPYTERMS - -                   A57BXQB4.BE0001SV *
17          *                   SAPrwp./BI0/TUCPYTERMS                                 *
18          *                  _BIC_AZCRMTKL00 - -                   A57BXQB4.BE00058Q *
19          *                   SAPrwp./BIC/AZCRMTKL00                                 *
20          *                  _BI0_TUCRATE_CAT - Texts: Char. Rate  A57BXQB4.BE0001SZ *
21          *                   Category - SAPrwp./BI0/TUCRATE_CAT                     *
22          *                  _BIC_TZGRID_ID - -                    A57BXQB4.BE0001T1 *
23          *                   SAPrwp./BIC/TZGRID_ID                                  *
24          *                  _BIC_TZCRMFY - - SAPrwp./BIC/TZCRMFY  A57BXQB4.BE0001T3 *
25          *                  _BIC_TZCRMGBI - -                     A57BXQB4.BE0001T5 *
26          *                   SAPrwp./BIC/TZCRMGBI                                   *
27          *                  _BIC_TZCRMGB - - SAPrwp./BIC/TZCRMGB  A57BXQB4.BE0001T7 *
28          *                  _BIC_TZTAHSTR - -                     A57BXQB4.BE0001T9 *
29          *                   SAPrwp./BIC/TZTAHSTR                                   *
30          *                  _BIC_TZZSUBPROC - -                   A57BXQB4.BE0001TB *
31          *                   SAPrwp./BIC/TZZSUBPROC                                 *
32          *                  _BIC_TZCRMKDM - -                     A57BXQB4.BE0001TD *
33          *                   SAPrwp./BIC/TZCRMKDM                                   *
34          *                  _BI0_TUCACC_CLAS - -                  A57BXQB4.BE0001TF *
35          *                   SAPrwp./BI0/TUCACC_CLAS                                *
36          *                  _BIC_TZBOLGE - - SAPrwp./BIC/TZBOLGE  A57BXQB4.BE0001TH *
37          *                  _BIC_TZCRMFS - - SAPrwp./BIC/TZCRMFS  A57BXQB4.BE0001TJ *
38          *                  _BIC_TZSWSTATUS - -                   A57BXQB4.BE0001TL *
39          *                   SAPrwp./BIC/TZSWSTATUS                                 *
40          *                  _BIC_TZTKTMCSD - -                    A57BXQB4.BE0001TN *
41          *                   SAPrwp./BIC/TZTKTMCSD                                  *
42          *                  _BIC_TZCRMFT - - SAPrwp./BIC/TZCRMFT  A57BXQB4.BE0001TP *
43          *                  _BI0_TFCACTDETID - -                  A57BXQB4.BE0001TR *
44          *                   SAPrwp./BI0/TFCACTDETID                                *
45          *                  _BI0_TCITY_CODE - -                   A57BXQB4.BE0001TT *
46          *                   SAPrwp./BI0/TCITY_CODE                                 *
47          *                  _BI0_TREGION - - SAPrwp./BI0/TREGION  A57BXQB4.BE0001TV *
48          *                  _BIC_TZYAKINLIK - -                   A57BXQB4.BE0001TX *
49          *                   SAPrwp./BIC/TZYAKINLIK                                 *
50          * Target Tables:   RWP_TZCRMPKFT -                       A57BXQB4.BE0001SS *
51          *                   PODSLIB1.RWP_TZCRMPKFT                                 *
52          *                  RWP_TUCSGR_CONT -                     A57BXQB4.BE0001SU *
53          *                   PODSLIB1.RWP_TUCSGR_CONT                               *
54          *                  RWP_TUCPYTERMS -                      A57BXQB4.BE0001SW *
55          *                   PODSLIB1.RWP_TUCPYTERMS                                *
56          *                  RWP_AZCRMTKL00 -                      A57BXQB4.BE0001SY *
57          *                   PODSLIB1.RWP_AZCRMTKL00                                *
58          *                  RWP_TUCRATE_CAT -                     A57BXQB4.BE0001T0 *
59          *                   PODSLIB1.RWP_TUCRATE_CAT                               *
60          *                  RWP_TZGRID_ID -                       A57BXQB4.BE0001T2 *
61          *                   PODSLIB1.RWP_TZGRID_ID                                 *
62          *                  RWP_TZCRMFY - PODSLIB1.RWP_TZCRMFY    A57BXQB4.BE0001T4 *
63          *                  RWP_TZCRMGBI - PODSLIB1.RWP_TZCRMGBI  A57BXQB4.BE0001T6 *
64          *                  RWP_TZCRMGB - PODSLIB1.RWP_TZCRMGB    A57BXQB4.BE0001T8 *
65          *                  RWP_TZTAHSTR - PODSLIB1.RWP_TZTAHSTR  A57BXQB4.BE0001TA *
66          *                  RWP_TZZSUBPROC -                      A57BXQB4.BE0001TC *
67          *                   PODSLIB1.RWP_TZZSUBPROC                                *
68          *                  RWP_TZCRMKDM - PODSLIB1.RWP_TZCRMKDM  A57BXQB4.BE0001TE *
69          *                  RWP_TUCACC_CLAS -                     A57BXQB4.BE0001TG *
70          *                   PODSLIB1.RWP_TUCACC_CLAS                               *
71          *                  RWP_TZBOLGE - PODSLIB1.RWP_TZBOLGE    A57BXQB4.BE0001TI *
72          *                  RWP_TZCRMFS - PODSLIB1.RWP_TZCRMFS    A57BXQB4.BE0001TK *
8                                                          The SAS System                          09:30 Wednesday, December 2, 2020

73          *                  RWP_TZSWSTATUS -                      A57BXQB4.BE0001TM *
74          *                   PODSLIB1.RWP_TZSWSTATUS                                *
75          *                  RWP_TZTKTMCSD -                       A57BXQB4.BE0001TO *
76          *                   PODSLIB1.RWP_TZTKTMCSD                                 *
77          *                  RWP_TZCRMFT - PODSLIB1.RWP_TZCRMFT    A57BXQB4.BE0001TQ *
78          *                  RWP_TFCACTDETID -                     A57BXQB4.BE0001TS *
79          *                   PODSLIB1.RWP_TFCACTDETID                               *
80          *                  RWP_TCITY_CODE -                      A57BXQB4.BE0001TU *
81          *                   PODSLIB1.RWP_TCITY_CODE                                *
82          *                  RWP_TREGION - PODSLIB1.RWP_TREGION    A57BXQB4.BE0001TW *
83          *                  RWP_TZYAKINLIK -                      A57BXQB4.BE0001TY *
84          *                   PODSLIB1.RWP_TZYAKINLIK                                *
85          *                                                                          *
86          * Generated on:    Friday, October 9, 2020 5:09:09 PM EET                  *
87          * Generated by:    sas                                                     *
88          * Version:         SAS Data Integration Studio 4.904                       *
89          ****************************************************************************/
90         
91         /* Generate the process id for job  */
92         %put Process ID: &SYSJOBID;
Process ID: 9765526
93         
94         /* General macro variables  */
95         %let jobID = %quote(A57BXQB4.BT00008B);
96         %let etls_jobName = %nrquote(Extract RWP D2D Tables - 2);
97         %let etls_userID = %nrquote(sas);
98         
99         /* Setup to capture return codes  */
100        %global job_rc trans_rc sqlrc;
101        %let sysrc = 0;
102        %let job_rc = 0;
103        %let trans_rc = 0;
104        %let sqlrc = 0;
105        %global etls_stepStartTime;
106        /* initialize syserr to 0 */
107        data _null_; run;

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

108        
109        %macro rcSet(error);
110           %if (&error gt &trans_rc) %then
111              %let trans_rc = &error;
112           %if (&error gt &job_rc) %then
113              %let job_rc = &error;
114        %mend rcSet;
115        
116        %macro rcSetDS(error);
117           if &error gt input(symget('trans_rc'),12.) then
118              call symput('trans_rc',trim(left(put(&error,12.))));
119           if &error gt input(symget('job_rc'),12.) then
120              call symput('job_rc',trim(left(put(&error,12.))));
121        %mend rcSetDS;
122        
123        /* Create metadata macro variables */
9                                                          The SAS System                          09:30 Wednesday, December 2, 2020

124        %let IOMServer      = %nrquote(SASApp);
125        %let metaPort       = %nrquote(8561);
126        %let metaServer     = %nrquote(ersupa0.enerjisa.local);
127        
128        /* Setup for capturing job status  */
129        %let etls_startTime = %sysfunc(datetime(),datetime.);
130        %let etls_recordsBefore = 0;
131        %let etls_recordsAfter = 0;
132        %let etls_lib = 0;
133        %let etls_table = 0;
134        
135        %global etls_debug;
136        %macro etls_setDebug;
137           %if %str(&etls_debug) ne 0 %then
138              OPTIONS MPRINT%str(;);
139        %mend;
140        %etls_setDebug;
141        
142        /*==========================================================================*
143         * Step:            Table Loader                          A57BXQB4.BV00012Z *
144         * Transform:       Table Loader (Version 2.1)                              *
145         * Description:                                                             *
146         *                                                                          *
147         * Source Table:    _BIC_TZCRMPKFT - -                    A57BXQB4.BE0001SR *
148         *                   SAPrwp./BIC/TZCRMPKFT                                  *
149         * Target Table:    RWP_TZCRMPKFT -                       A57BXQB4.BE0001SS *
150         *                   PODSLIB1.RWP_TZCRMPKFT                                 *
151         *==========================================================================*/
152        
153        %let transformID = %quote(A57BXQB4.BV00012Z);
154        %let trans_rc = 0;
155        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
156        
157        /* Access the data for RWP  */
158        LIBNAME SAPrwp SASIOSR3  ashost="errwpa0.enerjisa.retail"  sysnr=30  BatchMode=1  trace=0  language=EN  Client=500
158      ! AUTHDOMAIN="RWP" ;
NOTE:  Credential obtained from SAS metadata server.
NOTE: Libref SAPRWP was successfully assigned as follows: 
      Engine:        R3 
      Physical Name: errwpa0.enerjisa.retail
159        %rcSet(&syslibrc);
160        
161        %let SYSLAST = %nrquote(SAPrwp."/BIC/TZCRMPKFT"n);
162        
163        %global etls_sql_pushDown;
164        %let etls_sql_pushDown = -1;
165        option DBIDIRECTEXEC;
166        
167        %global etls_tableExist;
168        %global etls_numIndex;
169        %global etls_lastTable;
170        %let etls_tableExist = -1;
171        %let etls_numIndex = -1;
172        %let etls_lastTable = &SYSLAST;
173        
174        /*---- Define load data macro  ----*/
175        
176        /* --------------------------------------------------------------
10                                                         The SAS System                          09:30 Wednesday, December 2, 2020

177           Load Technique Selection: Replace - EntireTable
178           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
179           Additional options selections...
180              Set unmapped to missing on updates: false
181           -------------------------------------------------------------- */
182        %macro etls_loader;
183        
184           %let etls_tableOptions = ;
185        
186           /* Determine if the target table exists  */
187           %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMPKFT"n, DATA)) or
188                 %sysfunc(exist(PODSLIB1."RWP_TZCRMPKFT"n, VIEW)));
189        
190           %if &etls_tableExist %then
191           %do;/* table exists  */
192              %let etls_hasPreExistingConstraint=0;
193        
194              proc datasets lib = work nolist nowarn memtype = (data view);
195                 delete etls_commands etls_commands_F;
196              quit;
197        
198              %let etls_otherTablesReferToThisTable=0;
199        
200              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
201                 %put NOTE: Building table listing Constraints and Indexes for: &table;
202                 proc datasets lib=work nolist; delete &workTableOut; quit;
203                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
204        
205                 data &workTableOut;
206                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
207                    name = '';
208                    type = '';
209                    icown = '';
210                    idxUnique = '';
211                    idxNoMiss = '';
212                    recreate = '';
213                    set &workTableOut;
214                    ref = '';
215                    type=upcase(type);
216                    if type eq 'REFERENTIAL' then
217                    do;
218                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
219                            " another table: " ref;
220                       call symput('etls_otherTablesReferToThisTable','1');
221                       delete;
222                    end;
223                    if type='INDEX' and ICOwn eq 'YES' then delete;
224                 run;
225                 %rcSet(&syserr);
226        
227              %mend etls_CIContents;
228        
229              %etls_CIContents(table=PODSLIB1."RWP_TZCRMPKFT"n, workTableOut=etls_commands, inDSOptions=);
230        
231              %if &etls_otherTablesReferToThisTable %then
232                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
232      ! constraints.;
233              %else
11                                                         The SAS System                          09:30 Wednesday, December 2, 2020

234              %do; /* okay - remove foreign keys  */
235        
236                 data etls_commands_F;
237                    set etls_commands;
238                    if upcase(type)="FOREIGN KEY" then
239                    do;
240                       command='ic delete '||trim(name)||';';
241                       output etls_commands_F;
242                    end;
243                 run;
244        
245                 %put %str(NOTE: Removing foreign keys before dropping table...);
246                 data _null_;
247                    set etls_commands_F end=eof;
248                    if _n_=1 then
249                       call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMPKFT"n;');
250                    call execute(command);
251                    if eof then call execute('; quit;');
252                 run;
253                 %rcSet(&syserr);
254        
255           %end; /* okay - remove foreign keys  */
256        
257           proc datasets lib = work nolist nowarn memtype = (data view);
258              delete etls_commands etls_commands_F;
259           quit;
260        
261           /*---- Drop a table  ----*/
262           %put %str(NOTE: Dropping table ...);
263           proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
264              delete "RWP_TZCRMPKFT"n;
265           quit;
266        
267           %rcSet(&syserr);
268        
269           %let etls_tableExist = 0;
270        
271        %end; /* table exists  */
272        
273        /*---- Create a new table  ----*/
274        %if (&etls_tableExist eq 0) %then
275        %do;  /* if table does not exist  */
276        
277           %put %str(NOTE: Creating table ...);
278        
279           data PODSLIB1."RWP_TZCRMPKFT"n
280                   (COMPRESS = YES);
281              attrib "_BIC_ZCRMPKFT"n length = $8
282                 format = $8.;
283              attrib "TXTSH"n length = $20
284                 format = $20.
285                 label = 'Short description';
286              attrib "TXTMD"n length = $40
287                 format = $40.
288                 label = 'Medium description';
289              call missing(of _all_);
290              stop;
291           run;
12                                                         The SAS System                          09:30 Wednesday, December 2, 2020

292        
293           %rcSet(&syserr);
294        
295        %end;  /* if table does not exist  */
296        
297        /*---- Append  ----*/
298        %put %str(NOTE: Appending data ...);
299        
300        proc append base = PODSLIB1."RWP_TZCRMPKFT"n(COMPRESS = YES)
301           data = &etls_lastTable (&etls_tableOptions)  force ;
302         run;
303        
304        %rcSet(&syserr);
305        
306        %mend etls_loader;
307        %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.03 seconds
      cpu time            0.02 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZCRMPKFT"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZCRMPKFT"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
13                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMPKFT"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
14                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   delete "RWP_TZCRMPKFT"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZCRMPKFT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.21 seconds
      cpu time            0.03 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZCRMPKFT"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMPKFT"n length = $8 format = $8.;
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZCRMPKFT has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZCRMPKFT"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZCRMPKFT'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZCRMPKFT'n to PODSLIB1.RWP_TZCRMPKFT.
NOTE: There were 0 observations read from the data set SAPRWP.'/BIC/TZCRMPKFT'n.
NOTE: 0 observations added.
NOTE: The data set PODSLIB1.RWP_TZCRMPKFT has 0 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           1.74 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
308        
309        %let etls_recCheckExist = 0;
310        %let etls_recnt = 0;
311        %macro etls_recordCheck;
312           %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMPKFT"n, DATA)) or
313                 %sysfunc(exist(PODSLIB1."RWP_TZCRMPKFT"n, VIEW)));
314        
315           %if (&etls_recCheckExist) %then
316           %do;
317              %local etls_syntaxcheck;
318              %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
319              /* Turn off syntaxcheck option to perform following steps  */
320              options nosyntaxcheck;
321        
322              proc contents data = PODSLIB1."RWP_TZCRMPKFT"n out = work.etls_contents(keep = nobs) noprint;
323              run;
324        
325              data _null_;
15                                                         The SAS System                          09:30 Wednesday, December 2, 2020

326                 set work.etls_contents (obs = 1);
327                 call symput("etls_recnt", left(put(nobs,32.)));
328              run;
329        
330              proc datasets lib = work nolist nowarn memtype = (data view);
331                 delete etls_contents;
332              quit;
333        
334              /* Reset syntaxcheck option to previous setting  */
335              options &etls_syntaxcheck;
336           %end;
337        %mend etls_recordCheck;
338        %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZCRMPKFT"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
339        
340        
341        
342        /** Step end Table Loader **/
343        
344        /*==========================================================================*
345         * Step:            Table Loader                          A57BXQB4.BV000130 *
346         * Transform:       Table Loader (Version 2.1)                              *
347         * Description:                                                             *
348         *                                                                          *
349         * Source Table:    _BI0_TUCSGR_CONT - -                  A57BXQB4.BE0001ST *
350         *                   SAPrwp."/BI0/TUCSGR_CONT"n                             *
351         * Target Table:    RWP_TUCSGR_CONT -                     A57BXQB4.BE0001SU *
16                                                         The SAS System                          09:30 Wednesday, December 2, 2020

352         *                   PODSLIB1."RWP_TUCSGR_CONT"n                            *
353         *==========================================================================*/
354        
355        %let transformID = %quote(A57BXQB4.BV000130);
356        %let trans_rc = 0;
357        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
358        
359        %let SYSLAST = %nrquote(SAPrwp."/BI0/TUCSGR_CONT"n);
360        
361        %global etls_sql_pushDown;
362        %let etls_sql_pushDown = -1;
363        option DBIDIRECTEXEC;
364        
365        %global etls_tableExist;
366        %global etls_numIndex;
367        %global etls_lastTable;
368        %let etls_tableExist = -1;
369        %let etls_numIndex = -1;
370        %let etls_lastTable = &SYSLAST;
371        
372        /*---- Define load data macro  ----*/
373        
374        /* --------------------------------------------------------------
375           Load Technique Selection: Replace - EntireTable
376           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
377           Additional options selections...
378              Set unmapped to missing on updates: false
379           -------------------------------------------------------------- */
380        %macro etls_loader;
381        
382           %let etls_tableOptions = ;
383        
384           /* Determine if the target table exists  */
385           %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TUCSGR_CONT"n, DATA)) or
386                 %sysfunc(exist(PODSLIB1."RWP_TUCSGR_CONT"n, VIEW)));
387        
388           %if &etls_tableExist %then
389           %do;/* table exists  */
390              %let etls_hasPreExistingConstraint=0;
391        
392              proc datasets lib = work nolist nowarn memtype = (data view);
393                 delete etls_commands etls_commands_F;
394              quit;
395        
396              %let etls_otherTablesReferToThisTable=0;
397        
398              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
399                 %put NOTE: Building table listing Constraints and Indexes for: &table;
400                 proc datasets lib=work nolist; delete &workTableOut; quit;
401                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
402        
403                 data &workTableOut;
404                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
405                    name = '';
406                    type = '';
407                    icown = '';
408                    idxUnique = '';
409                    idxNoMiss = '';
17                                                         The SAS System                          09:30 Wednesday, December 2, 2020

410                    recreate = '';
411                    set &workTableOut;
412                    ref = '';
413                    type=upcase(type);
414                    if type eq 'REFERENTIAL' then
415                    do;
416                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
417                            " another table: " ref;
418                       call symput('etls_otherTablesReferToThisTable','1');
419                       delete;
420                    end;
421                    if type='INDEX' and ICOwn eq 'YES' then delete;
422                 run;
423                 %rcSet(&syserr);
424        
425              %mend etls_CIContents;
426        
427              %etls_CIContents(table=PODSLIB1."RWP_TUCSGR_CONT"n, workTableOut=etls_commands, inDSOptions=);
428        
429              %if &etls_otherTablesReferToThisTable %then
430                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
430      ! constraints.;
431              %else
432              %do; /* okay - remove foreign keys  */
433        
434                 data etls_commands_F;
435                    set etls_commands;
436                    if upcase(type)="FOREIGN KEY" then
437                    do;
438                       command='ic delete '||trim(name)||';';
439                       output etls_commands_F;
440                    end;
441                 run;
442        
443                 %put %str(NOTE: Removing foreign keys before dropping table...);
444                 data _null_;
445                    set etls_commands_F end=eof;
446                    if _n_=1 then
447                       call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TUCSGR_CONT"n;');
448                    call execute(command);
449                    if eof then call execute('; quit;');
450                 run;
451                 %rcSet(&syserr);
452        
453           %end; /* okay - remove foreign keys  */
454        
455           proc datasets lib = work nolist nowarn memtype = (data view);
456              delete etls_commands etls_commands_F;
457           quit;
458        
459           /*---- Drop a table  ----*/
460           %put %str(NOTE: Dropping table ...);
461           proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
462              delete "RWP_TUCSGR_CONT"n;
463           quit;
464        
465           %rcSet(&syserr);
466        
18                                                         The SAS System                          09:30 Wednesday, December 2, 2020

467           %let etls_tableExist = 0;
468        
469        %end; /* table exists  */
470        
471        /*---- Create a new table  ----*/
472        %if (&etls_tableExist eq 0) %then
473        %do;  /* if table does not exist  */
474        
475           %put %str(NOTE: Creating table ...);
476        
477           data PODSLIB1."RWP_TUCSGR_CONT"n
478                   (COMPRESS = YES);
479              attrib "UCSGR_CONT"n length = $2
480                 format = $2.
481                 label = 'Statistic Group Contract';
482              attrib "LANGU"n length = $1
483                 format = $1.
484                 label = 'Language Key';
485              attrib "TXTMD"n length = $40
486                 format = $40.
487                 label = 'Medium description';
488              call missing(of _all_);
489              stop;
490           run;
491        
492           %rcSet(&syserr);
493        
494        %end;  /* if table does not exist  */
495        
496        /*---- Append  ----*/
497        %put %str(NOTE: Appending data ...);
498        
499        proc append base = PODSLIB1."RWP_TUCSGR_CONT"n(COMPRESS = YES)
500           data = &etls_lastTable (&etls_tableOptions)  force ;
501         run;
502        
503        %rcSet(&syserr);
504        
505        %mend etls_loader;
506        %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TUCSGR_CONT"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
19                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TUCSGR_CONT"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TUCSGR_CONT"n;');
20                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TUCSGR_CONT"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TUCSGR_CONT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.05 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TUCSGR_CONT"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "UCSGR_CONT"n length = $2 format = $2. label = 'Statistic Group Contract';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TUCSGR_CONT has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TUCSGR_CONT"n(COMPRESS = YES) data = SAPRWP.'/BI0/TUCSGR_CONT'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TUCSGR_CONT'n to PODSLIB1.RWP_TUCSGR_CONT.
NOTE: There were 52 observations read from the data set SAPRWP.'/BI0/TUCSGR_CONT'n.
NOTE: 52 observations added.
NOTE: The data set PODSLIB1.RWP_TUCSGR_CONT has 52 observations and 3 variables.
21                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Compressing data set PODSLIB1.RWP_TUCSGR_CONT decreased size by 46.24 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.91 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
507        
508        %let etls_recCheckExist = 0;
509        %let etls_recnt = 0;
510        %macro etls_recordCheck;
511           %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TUCSGR_CONT"n, DATA)) or
512                 %sysfunc(exist(PODSLIB1."RWP_TUCSGR_CONT"n, VIEW)));
513        
514           %if (&etls_recCheckExist) %then
515           %do;
516              %local etls_syntaxcheck;
517              %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
518              /* Turn off syntaxcheck option to perform following steps  */
519              options nosyntaxcheck;
520        
521              proc contents data = PODSLIB1."RWP_TUCSGR_CONT"n out = work.etls_contents(keep = nobs) noprint;
522              run;
523        
524              data _null_;
525                 set work.etls_contents (obs = 1);
526                 call symput("etls_recnt", left(put(nobs,32.)));
527              run;
528        
529              proc datasets lib = work nolist nowarn memtype = (data view);
530                 delete etls_contents;
531              quit;
532        
533              /* Reset syntaxcheck option to previous setting  */
534              options &etls_syntaxcheck;
535           %end;
536        %mend etls_recordCheck;
537        %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TUCSGR_CONT"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
22                                                         The SAS System                          09:30 Wednesday, December 2, 2020


MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
538        
539        
540        
541        /** Step end Table Loader **/
542        
543        /*==========================================================================*
544         * Step:            Table Loader                          A57BXQB4.BV000131 *
545         * Transform:       Table Loader (Version 2.1)                              *
546         * Description:                                                             *
547         *                                                                          *
548         * Source Table:    _BI0_TUCPYTERMS - -                   A57BXQB4.BE0001SV *
549         *                   SAPrwp."/BI0/TUCPYTERMS"n                              *
550         * Target Table:    RWP_TUCPYTERMS -                      A57BXQB4.BE0001SW *
551         *                   PODSLIB1."RWP_TUCPYTERMS"n                             *
552         *==========================================================================*/
553        
554        %let transformID = %quote(A57BXQB4.BV000131);
555        %let trans_rc = 0;
556        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
557        
558        %let SYSLAST = %nrquote(SAPrwp."/BI0/TUCPYTERMS"n);
559        
560        %global etls_sql_pushDown;
561        %let etls_sql_pushDown = -1;
562        option DBIDIRECTEXEC;
563        
564        %global etls_tableExist;
565        %global etls_numIndex;
566        %global etls_lastTable;
567        %let etls_tableExist = -1;
568        %let etls_numIndex = -1;
569        %let etls_lastTable = &SYSLAST;
570        
571        /*---- Define load data macro  ----*/
572        
573        /* --------------------------------------------------------------
574           Load Technique Selection: Replace - EntireTable
575           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
576           Additional options selections...
577              Set unmapped to missing on updates: false
578           -------------------------------------------------------------- */
579        %macro etls_loader;
580        
581           %let etls_tableOptions = ;
582        
583           /* Determine if the target table exists  */
23                                                         The SAS System                          09:30 Wednesday, December 2, 2020

584           %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TUCPYTERMS"n, DATA)) or
585                 %sysfunc(exist(PODSLIB1."RWP_TUCPYTERMS"n, VIEW)));
586        
587           %if &etls_tableExist %then
588           %do;/* table exists  */
589              %let etls_hasPreExistingConstraint=0;
590        
591              proc datasets lib = work nolist nowarn memtype = (data view);
592                 delete etls_commands etls_commands_F;
593              quit;
594        
595              %let etls_otherTablesReferToThisTable=0;
596        
597              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
598                 %put NOTE: Building table listing Constraints and Indexes for: &table;
599                 proc datasets lib=work nolist; delete &workTableOut; quit;
600                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
601        
602                 data &workTableOut;
603                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
604                    name = '';
605                    type = '';
606                    icown = '';
607                    idxUnique = '';
608                    idxNoMiss = '';
609                    recreate = '';
610                    set &workTableOut;
611                    ref = '';
612                    type=upcase(type);
613                    if type eq 'REFERENTIAL' then
614                    do;
615                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
616                            " another table: " ref;
617                       call symput('etls_otherTablesReferToThisTable','1');
618                       delete;
619                    end;
620                    if type='INDEX' and ICOwn eq 'YES' then delete;
621                 run;
622                 %rcSet(&syserr);
623        
624              %mend etls_CIContents;
625        
626              %etls_CIContents(table=PODSLIB1."RWP_TUCPYTERMS"n, workTableOut=etls_commands, inDSOptions=);
627        
628              %if &etls_otherTablesReferToThisTable %then
629                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
629      ! constraints.;
630              %else
631              %do; /* okay - remove foreign keys  */
632        
633                 data etls_commands_F;
634                    set etls_commands;
635                    if upcase(type)="FOREIGN KEY" then
636                    do;
637                       command='ic delete '||trim(name)||';';
638                       output etls_commands_F;
639                    end;
640                 run;
24                                                         The SAS System                          09:30 Wednesday, December 2, 2020

641        
642                 %put %str(NOTE: Removing foreign keys before dropping table...);
643                 data _null_;
644                    set etls_commands_F end=eof;
645                    if _n_=1 then
646                       call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TUCPYTERMS"n;');
647                    call execute(command);
648                    if eof then call execute('; quit;');
649                 run;
650                 %rcSet(&syserr);
651        
652           %end; /* okay - remove foreign keys  */
653        
654           proc datasets lib = work nolist nowarn memtype = (data view);
655              delete etls_commands etls_commands_F;
656           quit;
657        
658           /*---- Drop a table  ----*/
659           %put %str(NOTE: Dropping table ...);
660           proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
661              delete "RWP_TUCPYTERMS"n;
662           quit;
663        
664           %rcSet(&syserr);
665        
666           %let etls_tableExist = 0;
667        
668        %end; /* table exists  */
669        
670        /*---- Create a new table  ----*/
671        %if (&etls_tableExist eq 0) %then
672        %do;  /* if table does not exist  */
673        
674           %put %str(NOTE: Creating table ...);
675        
676           data PODSLIB1."RWP_TUCPYTERMS"n
677                   (COMPRESS = YES);
678              attrib "UCPYTERMS"n length = $4
679                 format = $4.
680                 label = 'Payment Terms';
681              attrib "LANGU"n length = $1
682                 format = $1.
683                 label = 'Language Key';
684              attrib "TXTLG"n length = $60
685                 format = $60.
686                 label = 'Long description';
687              call missing(of _all_);
688              stop;
689           run;
690        
691           %rcSet(&syserr);
692        
693        %end;  /* if table does not exist  */
694        
695        /*---- Append  ----*/
696        %put %str(NOTE: Appending data ...);
697        
698        proc append base = PODSLIB1."RWP_TUCPYTERMS"n(COMPRESS = YES)
25                                                         The SAS System                          09:30 Wednesday, December 2, 2020

699           data = &etls_lastTable (&etls_tableOptions)  force ;
700         run;
701        
702        %rcSet(&syserr);
703        
704        %mend etls_loader;
705        %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TUCPYTERMS"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TUCPYTERMS"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
26                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TUCPYTERMS"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TUCPYTERMS"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TUCPYTERMS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.05 seconds
      cpu time            0.00 seconds
      

27                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TUCPYTERMS"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "UCPYTERMS"n length = $4 format = $4. label = 'Payment Terms';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TUCPYTERMS has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TUCPYTERMS"n(COMPRESS = YES) data = SAPRWP.'/BI0/TUCPYTERMS'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TUCPYTERMS'n to PODSLIB1.RWP_TUCPYTERMS.
NOTE: There were 132 observations read from the data set SAPRWP.'/BI0/TUCPYTERMS'n.
NOTE: 132 observations added.
NOTE: The data set PODSLIB1.RWP_TUCPYTERMS has 132 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TUCPYTERMS decreased size by 45.76 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.92 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
706        
707        %let etls_recCheckExist = 0;
708        %let etls_recnt = 0;
709        %macro etls_recordCheck;
710           %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TUCPYTERMS"n, DATA)) or
711                 %sysfunc(exist(PODSLIB1."RWP_TUCPYTERMS"n, VIEW)));
712        
713           %if (&etls_recCheckExist) %then
714           %do;
715              %local etls_syntaxcheck;
716              %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
717              /* Turn off syntaxcheck option to perform following steps  */
718              options nosyntaxcheck;
719        
720              proc contents data = PODSLIB1."RWP_TUCPYTERMS"n out = work.etls_contents(keep = nobs) noprint;
721              run;
722        
723              data _null_;
724                 set work.etls_contents (obs = 1);
725                 call symput("etls_recnt", left(put(nobs,32.)));
726              run;
727        
728              proc datasets lib = work nolist nowarn memtype = (data view);
729                 delete etls_contents;
730              quit;
731        
28                                                         The SAS System                          09:30 Wednesday, December 2, 2020

732              /* Reset syntaxcheck option to previous setting  */
733              options &etls_syntaxcheck;
734           %end;
735        %mend etls_recordCheck;
736        %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TUCPYTERMS"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
737        
738        
739        
740        /** Step end Table Loader **/
741        
742        /*==========================================================================*
743         * Step:            Table Loader                          A57BXQB4.BV000132 *
744         * Transform:       Table Loader (Version 2.1)                              *
745         * Description:                                                             *
746         *                                                                          *
747         * Source Table:    _BIC_AZCRMTKL00 - -                   A57BXQB4.BE00058Q *
748         *                   SAPrwp."/BIC/AZCRMTKL00"n                              *
749         * Target Table:    RWP_AZCRMTKL00 -                      A57BXQB4.BE0001SY *
750         *                   PODSLIB1."RWP_AZCRMTKL00"n                             *
751         *==========================================================================*/
752        
753        %let transformID = %quote(A57BXQB4.BV000132);
754        %let trans_rc = 0;
755        %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
756        
757        %let SYSLAST = %nrquote(SAPrwp."/BIC/AZCRMTKL00"n);
29                                                         The SAS System                          09:30 Wednesday, December 2, 2020

758        
759        %global etls_sql_pushDown;
760        %let etls_sql_pushDown = -1;
761        option DBIDIRECTEXEC;
762        
763        %global etls_tableExist;
764        %global etls_numIndex;
765        %global etls_lastTable;
766        %let etls_tableExist = -1;
767        %let etls_numIndex = -1;
768        %let etls_lastTable = &SYSLAST;
769        
770        /*---- Define load data macro  ----*/
771        
772        /* --------------------------------------------------------------
773           Load Technique Selection: Replace - EntireTable
774           Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
775           Additional options selections...
776              Set unmapped to missing on updates: false
777           -------------------------------------------------------------- */
778        %macro etls_loader;
779        
780           %let etls_tableOptions = ;
781        
782           /* Determine if the target table exists  */
783           %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_AZCRMTKL00"n, DATA)) or
784                 %sysfunc(exist(PODSLIB1."RWP_AZCRMTKL00"n, VIEW)));
785        
786           %if &etls_tableExist %then
787           %do;/* table exists  */
788              %let etls_hasPreExistingConstraint=0;
789        
790              proc datasets lib = work nolist nowarn memtype = (data view);
791                 delete etls_commands etls_commands_F;
792              quit;
793        
794              %let etls_otherTablesReferToThisTable=0;
795        
796              %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
797                 %put NOTE: Building table listing Constraints and Indexes for: &table;
798                 proc datasets lib=work nolist; delete &workTableOut; quit;
799                 proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
800        
801                 data &workTableOut;
802                    length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
803                    name = '';
804                    type = '';
805                    icown = '';
806                    idxUnique = '';
807                    idxNoMiss = '';
808                    recreate = '';
809                    set &workTableOut;
810                    ref = '';
811                    type=upcase(type);
812                    if type eq 'REFERENTIAL' then
813                    do;
814                       put "WARNING%QUOTE(:) Target table is referenced by constraints in"
815                            " another table: " ref;
30                                                         The SAS System                          09:30 Wednesday, December 2, 2020

816                       call symput('etls_otherTablesReferToThisTable','1');
817                       delete;
818                    end;
819                    if type='INDEX' and ICOwn eq 'YES' then delete;
820                 run;
821                 %rcSet(&syserr);
822        
823              %mend etls_CIContents;
824        
825              %etls_CIContents(table=PODSLIB1."RWP_AZCRMTKL00"n, workTableOut=etls_commands, inDSOptions=);
826        
827              %if &etls_otherTablesReferToThisTable %then
828                 %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
828      ! constraints.;
829              %else
830              %do; /* okay - remove foreign keys  */
831        
832                 data etls_commands_F;
833                    set etls_commands;
834                    if upcase(type)="FOREIGN KEY" then
835                    do;
836                       command='ic delete '||trim(name)||';';
837                       output etls_commands_F;
838                    end;
839                 run;
840        
841                 %put %str(NOTE: Removing foreign keys before dropping table...);
842                 data _null_;
843                    set etls_commands_F end=eof;
844                    if _n_=1 then
845                       call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_AZCRMTKL00"n;');
846                    call execute(command);
847                    if eof then call execute('; quit;');
848                 run;
849                 %rcSet(&syserr);
850        
851           %end; /* okay - remove foreign keys  */
852        
853           proc datasets lib = work nolist nowarn memtype = (data view);
854              delete etls_commands etls_commands_F;
855           quit;
856        
857           /*---- Drop a table  ----*/
858           %put %str(NOTE: Dropping table ...);
859           proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
860              delete "RWP_AZCRMTKL00"n;
861           quit;
862        
863           %rcSet(&syserr);
864        
865           %let etls_tableExist = 0;
866        
867        %end; /* table exists  */
868        
869        /*---- Create a new table  ----*/
870        %if (&etls_tableExist eq 0) %then
871        %do;  /* if table does not exist  */
872        
31                                                         The SAS System                          09:30 Wednesday, December 2, 2020

873           %put %str(NOTE: Creating table ...);
874        
875           data PODSLIB1."RWP_AZCRMTKL00"n
876                   (COMPRESS = YES);
877              attrib "CRM_ITMGUI"n length = $32
878                 format = $32.
879                 label = 'GUID of a CRM Order item';
880              attrib "CRM_OHGUID"n length = $32
881                 format = $32.
882                 label = 'GUID of a CRM Order Object';
883              attrib "BBP_ITGUID"n length = $32
884                 format = $32.
885                 label = 'Document Item GUID';
886              attrib "RECORDMODE"n length = $1
887                 format = $1.
888                 label = 'BW Delta Process: Record Mode';
889              attrib "CRM_PBWDAT"n length = 8
890                 format = DATE9.
891                 label = 'Posting Date for BW Reporting';
892              attrib "_BIC_ZACT_DESC"n length = $60
893                 format = $60.
894                 label = 'Activity Description';
895              attrib "_BIC_ZCCREBY"n length = $12
896                 format = $12.
897                 label = 'Created By';
898              attrib "_BIC_ZZSUBPROC"n length = $2
899                 format = $2.;
900              attrib "_BIC_ZPAKET"n length = $60
901                 format = $60.
902                 label = 'Paket';
903              attrib "_BIC_ZOBJ_KLM"n length = $15
904                 format = $15.;
905              attrib "CRM_OBJ_ID"n length = $10
906                 format = $10.
907                 label = 'Transaction Number';
908              attrib "CRM_DESCR"n length = $40
909                 format = $40.
910                 label = 'Description of a Transaction';
911              attrib "_BIC_ZATTR4"n length = $40
912                 format = $40.;
913              attrib "_BIC_ZATTR5"n length = $40
914                 format = $40.;
915              attrib "_BIC_ZATTR6"n length = $40
916                 format = $40.;
917              attrib "_BIC_ZATTR7"n length = $40
918                 format = $40.;
919              attrib "_BIC_ZATTR15"n length = $40
920                 format = $40.;
921              attrib "_BIC_ZATTR16"n length = $40
922                 format = $40.;
923              attrib "_BIC_ZATTR21"n length = $40
924                 format = $40.;
925              attrib "_BIC_ZATTR22"n length = $40
926                 format = $40.;
927              attrib "_BIC_ZPOTTK_T0"n length = 8
928                 format = 19.3
929                 label = 'Potansiyel tüketim T0';
930              attrib "_BIC_ZPOTTK_T1"n length = 8
32                                                         The SAS System                          09:30 Wednesday, December 2, 2020

931                 format = 19.3
932                 label = 'Potansiyel tüketim T1';
933              attrib "_BIC_ZPOTTK_T3"n length = 8
934                 format = 19.3
935                 label = 'Potansiyel tüketim T3';
936              attrib "_BIC_ZSTNZCUQ"n length = $2
937                 format = $2.;
938              attrib "_BIC_ZEXT_UI"n length = $50
939                 format = $50.
940                 label = 'Meter ETSO Code';
941              attrib "UCINSTALLA"n length = $10
942                 format = $10.
943                 label = 'Installation Number: Utilities Industry';
944              attrib "_BIC_ZCRMOBJID"n length = $10
945                 format = $10.;
946              attrib "BPARTNER"n length = $10
947                 format = $10.
948                 label = 'Business Partner';
949              attrib "UC_CONNOBJ"n length = $30
950                 format = $30.
951                 label = 'Connection Object in the Utilities Industry';
952              attrib "_BIC_ZWMADR01"n length = $60
953                 format = $60.
954                 label = 'Tükeim yeri adres (2)';
955              attrib "CACONT_ACC"n length = $12
956                 format = $12.
957                 label = 'Contract Account (Partner-Independent Data)';
958              attrib "CONTRSTART"n length = 8
959                 format = DATE9.
960                 label = 'Contract Start Date';
961              attrib "DATE0"n length = 8
962                 format = DATE9.
963                 label = 'Date';
964              attrib "CONTR1END"n length = 8
965                 format = DATE9.
966                 label = 'Contract End Date';
967              attrib "_BIC_ZMLYKOD2"n length = $10
968                 format = $10.;
969              attrib "CRM_OPGUID"n length = $32
970                 format = $32.
971                 label = 'Guid of Opportunity';
972              attrib "_BIC_ZPADBMARG"n length = 8
973                 format = BEST12.
974                 label = 'Day Before Margin';
975              attrib "_BIC_ZCCCHR"n length = $45
976                 format = $45.
977                 label = 'CCC Organization Code';
978              attrib "_BIC_ZCURDSCT0"n length = 8
979                 format = BEST12.
980                 label = 'T0 Discount';
981              attrib "_BIC_ZCURDSCT1"n length = 8
982                 format = BEST12.
983                 label = 'T1 Discount';
984              attrib "_BIC_ZCURDSCT2"n length = 8
985                 format = BEST12.
986                 label = 'T2 Discount';
987              attrib "_BIC_ZCURDSCT3"n length = 8
988                 format = BEST12.
33                                                         The SAS System                          09:30 Wednesday, December 2, 2020

989                 label = 'T3 Discount';
990              attrib "_BIC_ZCRMKF1"n length = 8
991                 format = BEST12.
992                 label = 'T0 Discount';
993              attrib "_BIC_ZCRMKF2"n length = 8
994                 format = BEST12.
995                 label = 'T0 Discount';
996              attrib "_BIC_ZCRMKF3"n length = 8
997                 format = BEST12.
998                 label = 'T0 Discount';
999              attrib "_BIC_ZCRMKF4"n length = 8
1000                format = BEST12.
1001                label = 'T0 Discount';
1002             attrib "_BIC_ZCRMKF5"n length = 8
1003                format = BEST12.
1004                label = 'T0 Discount';
1005             attrib "_BIC_ZCRMKF6"n length = 8
1006                format = BEST12.
1007                label = 'T0 Discount';
1008             attrib "_BIC_ZCRMKF7"n length = 8
1009                format = BEST12.
1010                label = 'T0 Discount';
1011             attrib "_BIC_ZCRMKF8"n length = 8
1012                format = BEST12.
1013                label = 'T0 Discount';
1014             attrib "_BIC_ZCRMFT"n length = $2
1015                format = $2.;
1016             attrib "_BIC_ZCRMFY"n length = $2
1017                format = $2.;
1018             attrib "_BIC_ZCRMFS"n length = $2
1019                format = $2.;
1020             attrib "_BIC_ZCRMGB"n length = $2
1021                format = $2.;
1022             attrib "_BIC_ZCRMGBI"n length = $2
1023                format = $2.;
1024             attrib "_BIC_ZCRMKDM"n length = $2
1025                format = $2.;
1026             attrib "_BIC_ZCRMPKFT"n length = $8
1027                format = $8.;
1028             attrib "COMP_CODE"n length = $4
1029                format = $4.
1030                label = 'Company code';
1031             attrib "UCSGR_CONT"n length = $2
1032                format = $2.
1033                label = 'Statistic Group Contract';
1034             attrib "UCRATEFAKT"n length = $10
1035                format = $10.
1036                label = 'Rate Fact Group';
1037             attrib "FCACTDETID"n length = $2
1038                format = $2.
1039                label = 'Account Determination ID for Contract Accounts';
1040             attrib "UCACC_CLAS"n length = $4
1041                format = $4.
1042                label = 'Account Class';
1043             attrib "BP_CONS"n length = $10
1044                format = $10.
1045                label = 'Business Partner (Consolidated/Cleansing)';
1046             attrib "_BIC_ZATTR19"n length = $40
34                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1047                format = $40.;
1048             attrib "CRM_PRCTYP"n length = $4
1049                format = $4.
1050                label = 'Business Transaction Type';
1051             attrib "_BIC_ZTAHSTR"n length = $40
1052                format = $40.;
1053             attrib "_BIC_ZTKTMCSD"n length = $40
1054                format = $40.;
1055             attrib "CRM_USSTAT"n length = $5
1056                format = $5.
1057                label = 'User Status';
1058             attrib "CRM_STSMA"n length = $8
1059                format = $8.
1060                label = 'Status Profile';
1061             attrib "_BIC_ZBOLGE"n length = $2
1062                format = $2.;
1063             attrib "UCPYTERMS"n length = $4
1064                format = $4.
1065                label = 'Payment Terms';
1066             attrib "UCRATE_CAT"n length = $10
1067                format = $10.
1068                label = 'Rate Category';
1069             attrib "_BIC_ZNAME_F"n length = $40
1070                format = $40.;
1071             attrib "CREATEDON"n length = 8
1072                format = DATE9.
1073                label = 'Date on which the record was created';
1074             attrib "_BIC_ZGRID_ID"n length = $10
1075                format = $10.
1076                label = 'Distribution Company';
1077             attrib "_BIC_ZDGTM"n length = $10
1078                format = $10.;
1079             attrib "_BIC_ZGUID"n length = $32
1080                format = $32.;
1081             attrib "_BIC_ZZSWFROM"n length = $2
1082                format = $2.;
1083             attrib "_BIC_ZZSWTO"n length = $2
1084                format = $2.;
1085             attrib "_BIC_ZUCDAYCT7"n length = 8
1086                format = 19.3
1087                label = 'Number of Days Billed';
1088             attrib "CITY_CODE"n length = $12
1089                format = $12.
1090                label = 'BAS: City Code';
1091             attrib "COUNTRY"n length = $3
1092                format = $3.
1093                label = 'Country Key';
1094             attrib "UC_SWTSTAT"n length = $2
1095                format = $2.
1096                label = 'Status of Service Switch';
1097             attrib "_BIC_ZITMCNSTR"n length = 8
1098                format = DATE9.;
1099             attrib "_BIC_ZITMCNEND"n length = 8
1100                format = DATE9.;
1101             attrib "_BIC_ZINT_UI"n length = $22
1102                format = $22.;
1103             attrib "_BIC_ZD2D_ADR"n length = $100
1104                format = $100.;
35                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1105             attrib "_BIC_ZBTV"n length = $1
1106                format = $1.
1107                label = 'BTV Raporlama Göstergesi';
1108             attrib "_BIC_ZKAMPSRKT"n length = $3
1109                format = $3.;
1110             attrib "UCCONTRACT"n length = $10
1111                format = $10.
1112                label = 'Contract Number: Utilities Industry';
1113             attrib "_BIC_ZPOTTK_T2"n length = 8
1114                format = 19.3
1115                label = 'Potansiyel tüketim T2';
1116             attrib "CALMONTH"n length = $6
1117                format = $6.
1118                label = 'Calendar year/month';
1119             attrib "_BIC_ZPRCRSN"n length = $4
1120                format = $4.;
1121             attrib "_BIC_ZTEM_SURE"n length = $2
1122                format = $2.
1123                label = 'Teminat Suresi';
1124             attrib "_BIC_ZTEM_1"n length = 8
1125                format = 19.2;
1126             attrib "_BIC_ZTEM_2"n length = 8
1127                format = 19.2;
1128             attrib "_BIC_ZTEM_3"n length = 8
1129                format = 19.2;
1130             attrib "_BIC_ZTEM4"n length = 8
1131                format = 19.2;
1132             attrib "_BIC_ZMAX1"n length = 8
1133                format = 19.3;
1134             attrib "_BIC_ZMAX2"n length = 8
1135                format = 19.3;
1136             attrib "_BIC_ZKANAL"n length = $4
1137                format = $4.
1138                label = 'Kanal';
1139             attrib "_BIC_ZIST_BCM"n length = $3
1140                format = $3.;
1141             attrib "_BIC_ZIST_DRM"n length = $5
1142                format = $5.;
1143             attrib "_BIC_ZBC_DATE"n length = 8
1144                format = DATE9.
1145                label = 'Date';
1146             attrib "_BIC_ZCRMPRRSN"n length = $2
1147                format = $2.;
1148             attrib "_BIC_ZAORG2"n length = $10
1149                format = $10.;
1150             attrib "GCC_UPDTM"n length = 8
1151                format = TIME8.
1152                label = 'Update Time';
1153             call missing(of _all_);
1154             stop;
1155          run;
1156       
1157          %rcSet(&syserr);
1158       
1159       %end;  /* if table does not exist  */
1160       
1161       /*---- Append  ----*/
1162       %put %str(NOTE: Appending data ...);
36                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1163       
1164       proc append base = PODSLIB1."RWP_AZCRMTKL00"n(COMPRESS = YES)
1165          data = &etls_lastTable (&etls_tableOptions)  force ;
1166        run;
1167       
1168       %rcSet(&syserr);
1169       
1170       %mend etls_loader;
1171       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_AZCRMTKL00"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_AZCRMTKL00"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
37                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_AZCRMTKL00"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_AZCRMTKL00"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_AZCRMTKL00 (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.68 seconds
      cpu time            0.00 seconds
38                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_AZCRMTKL00"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "CRM_ITMGUI"n length = $32 format = $32. label = 'GUID of a CRM Order item';
MPRINT(ETLS_LOADER):   attrib "CRM_OHGUID"n length = $32 format = $32. label = 'GUID of a CRM Order Object';
MPRINT(ETLS_LOADER):   attrib "BBP_ITGUID"n length = $32 format = $32. label = 'Document Item GUID';
MPRINT(ETLS_LOADER):   attrib "RECORDMODE"n length = $1 format = $1. label = 'BW Delta Process: Record Mode';
MPRINT(ETLS_LOADER):   attrib "CRM_PBWDAT"n length = 8 format = DATE9. label = 'Posting Date for BW Reporting';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZACT_DESC"n length = $60 format = $60. label = 'Activity Description';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCCREBY"n length = $12 format = $12. label = 'Created By';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZSUBPROC"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPAKET"n length = $60 format = $60. label = 'Paket';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZOBJ_KLM"n length = $15 format = $15.;
MPRINT(ETLS_LOADER):   attrib "CRM_OBJ_ID"n length = $10 format = $10. label = 'Transaction Number';
MPRINT(ETLS_LOADER):   attrib "CRM_DESCR"n length = $40 format = $40. label = 'Description of a Transaction';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR4"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR5"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR6"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR7"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR15"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR16"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR21"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR22"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPOTTK_T0"n length = 8 format = 19.3 label = 'Potansiyel tüketim T0';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPOTTK_T1"n length = 8 format = 19.3 label = 'Potansiyel tüketim T1';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPOTTK_T3"n length = 8 format = 19.3 label = 'Potansiyel tüketim T3';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSTNZCUQ"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZEXT_UI"n length = $50 format = $50. label = 'Meter ETSO Code';
MPRINT(ETLS_LOADER):   attrib "UCINSTALLA"n length = $10 format = $10. label = 'Installation Number: Utilities Industry';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMOBJID"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "BPARTNER"n length = $10 format = $10. label = 'Business Partner';
MPRINT(ETLS_LOADER):   attrib "UC_CONNOBJ"n length = $30 format = $30. label = 'Connection Object in the Utilities Industry';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZWMADR01"n length = $60 format = $60. label = 'Tükeim yeri adres (2)';
MPRINT(ETLS_LOADER):   attrib "CACONT_ACC"n length = $12 format = $12. label = 'Contract Account (Partner-Independent Data)';
MPRINT(ETLS_LOADER):   attrib "CONTRSTART"n length = 8 format = DATE9. label = 'Contract Start Date';
MPRINT(ETLS_LOADER):   attrib "DATE0"n length = 8 format = DATE9. label = 'Date';
MPRINT(ETLS_LOADER):   attrib "CONTR1END"n length = 8 format = DATE9. label = 'Contract End Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZMLYKOD2"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "CRM_OPGUID"n length = $32 format = $32. label = 'Guid of Opportunity';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPADBMARG"n length = 8 format = BEST12. label = 'Day Before Margin';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCCCHR"n length = $45 format = $45. label = 'CCC Organization Code';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCURDSCT0"n length = 8 format = BEST12. label = 'T0 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCURDSCT1"n length = 8 format = BEST12. label = 'T1 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCURDSCT2"n length = 8 format = BEST12. label = 'T2 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCURDSCT3"n length = 8 format = BEST12. label = 'T3 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKF1"n length = 8 format = BEST12. label = 'T0 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKF2"n length = 8 format = BEST12. label = 'T0 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKF3"n length = 8 format = BEST12. label = 'T0 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKF4"n length = 8 format = BEST12. label = 'T0 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKF5"n length = 8 format = BEST12. label = 'T0 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKF6"n length = 8 format = BEST12. label = 'T0 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKF7"n length = 8 format = BEST12. label = 'T0 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKF8"n length = 8 format = BEST12. label = 'T0 Discount';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMFT"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMFY"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMFS"n length = $2 format = $2.;
39                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMGB"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMGBI"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKDM"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMPKFT"n length = $8 format = $8.;
MPRINT(ETLS_LOADER):   attrib "COMP_CODE"n length = $4 format = $4. label = 'Company code';
MPRINT(ETLS_LOADER):   attrib "UCSGR_CONT"n length = $2 format = $2. label = 'Statistic Group Contract';
MPRINT(ETLS_LOADER):   attrib "UCRATEFAKT"n length = $10 format = $10. label = 'Rate Fact Group';
MPRINT(ETLS_LOADER):   attrib "FCACTDETID"n length = $2 format = $2. label = 'Account Determination ID for Contract Accounts';
MPRINT(ETLS_LOADER):   attrib "UCACC_CLAS"n length = $4 format = $4. label = 'Account Class';
MPRINT(ETLS_LOADER):   attrib "BP_CONS"n length = $10 format = $10. label = 'Business Partner (Consolidated/Cleansing)';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZATTR19"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "CRM_PRCTYP"n length = $4 format = $4. label = 'Business Transaction Type';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZTAHSTR"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZTKTMCSD"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "CRM_USSTAT"n length = $5 format = $5. label = 'User Status';
MPRINT(ETLS_LOADER):   attrib "CRM_STSMA"n length = $8 format = $8. label = 'Status Profile';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZBOLGE"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "UCPYTERMS"n length = $4 format = $4. label = 'Payment Terms';
MPRINT(ETLS_LOADER):   attrib "UCRATE_CAT"n length = $10 format = $10. label = 'Rate Category';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZNAME_F"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "CREATEDON"n length = 8 format = DATE9. label = 'Date on which the record was created';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZGRID_ID"n length = $10 format = $10. label = 'Distribution Company';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZDGTM"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZGUID"n length = $32 format = $32.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZSWFROM"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZSWTO"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZUCDAYCT7"n length = 8 format = 19.3 label = 'Number of Days Billed';
MPRINT(ETLS_LOADER):   attrib "CITY_CODE"n length = $12 format = $12. label = 'BAS: City Code';
MPRINT(ETLS_LOADER):   attrib "COUNTRY"n length = $3 format = $3. label = 'Country Key';
MPRINT(ETLS_LOADER):   attrib "UC_SWTSTAT"n length = $2 format = $2. label = 'Status of Service Switch';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZITMCNSTR"n length = 8 format = DATE9.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZITMCNEND"n length = 8 format = DATE9.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZINT_UI"n length = $22 format = $22.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZD2D_ADR"n length = $100 format = $100.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZBTV"n length = $1 format = $1. label = 'BTV Raporlama Göstergesi';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZKAMPSRKT"n length = $3 format = $3.;
MPRINT(ETLS_LOADER):   attrib "UCCONTRACT"n length = $10 format = $10. label = 'Contract Number: Utilities Industry';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPOTTK_T2"n length = 8 format = 19.3 label = 'Potansiyel tüketim T2';
MPRINT(ETLS_LOADER):   attrib "CALMONTH"n length = $6 format = $6. label = 'Calendar year/month';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZPRCRSN"n length = $4 format = $4.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZTEM_SURE"n length = $2 format = $2. label = 'Teminat Suresi';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZTEM_1"n length = 8 format = 19.2;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZTEM_2"n length = 8 format = 19.2;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZTEM_3"n length = 8 format = 19.2;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZTEM4"n length = 8 format = 19.2;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZMAX1"n length = 8 format = 19.3;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZMAX2"n length = 8 format = 19.3;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZKANAL"n length = $4 format = $4. label = 'Kanal';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZIST_BCM"n length = $3 format = $3.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZIST_DRM"n length = $5 format = $5.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZBC_DATE"n length = 8 format = DATE9. label = 'Date';
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMPRRSN"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZAORG2"n length = $10 format = $10.;
MPRINT(ETLS_LOADER):   attrib "GCC_UPDTM"n length = 8 format = TIME8. label = 'Update Time';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

40                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: The data set PODSLIB1.RWP_AZCRMTKL00 has 0 observations and 107 variables.
NOTE: DATA statement used (Total process time):
      real time           0.05 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_AZCRMTKL00"n(COMPRESS = YES) data = SAPRWP.'/BIC/AZCRMTKL00'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/AZCRMTKL00'n to PODSLIB1.RWP_AZCRMTKL00.
WARNING: Some character data was lost during transcoding in the dataset SAPRWP.'/BIC/AZCRMTKL00'n. Either the data contains 
         characters that are not representable in the new encoding or truncation occurred during transcoding.
NOTE: There were 1080403 observations read from the data set SAPRWP.'/BIC/AZCRMTKL00'n.
NOTE: 2943600 observations added.
NOTE: The data set PODSLIB1.RWP_AZCRMTKL00 has 2943600 observations and 107 variables.
NOTE: Compressing data set PODSLIB1.RWP_AZCRMTKL00 decreased size by 64.37 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           7:47.49
      cpu time            1:05.41
      

MPRINT(ETLS_LOADER):  ;
1172       
1173       %let etls_recCheckExist = 0;
1174       %let etls_recnt = 0;
1175       %macro etls_recordCheck;
1176          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_AZCRMTKL00"n, DATA)) or
1177                %sysfunc(exist(PODSLIB1."RWP_AZCRMTKL00"n, VIEW)));
1178       
1179          %if (&etls_recCheckExist) %then
1180          %do;
1181             %local etls_syntaxcheck;
1182             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1183             /* Turn off syntaxcheck option to perform following steps  */
1184             options nosyntaxcheck;
1185       
1186             proc contents data = PODSLIB1."RWP_AZCRMTKL00"n out = work.etls_contents(keep = nobs) noprint;
1187             run;
1188       
1189             data _null_;
1190                set work.etls_contents (obs = 1);
1191                call symput("etls_recnt", left(put(nobs,32.)));
1192             run;
1193       
1194             proc datasets lib = work nolist nowarn memtype = (data view);
1195                delete etls_contents;
1196             quit;
1197       
1198             /* Reset syntaxcheck option to previous setting  */
1199             options &etls_syntaxcheck;
1200          %end;
1201       %mend etls_recordCheck;
1202       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_AZCRMTKL00"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;
41                                                         The SAS System                          09:30 Wednesday, December 2, 2020


NOTE: The data set WORK.ETLS_CONTENTS has 107 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1203       
1204       
1205       
1206       /** Step end Table Loader **/
1207       
1208       /*==========================================================================*
1209        * Step:            Table Loader                          A57BXQB4.BV000133 *
1210        * Transform:       Table Loader (Version 2.1)                              *
1211        * Description:                                                             *
1212        *                                                                          *
1213        * Source Table:    _BI0_TUCRATE_CAT - Texts: Char. Rate  A57BXQB4.BE0001SZ *
1214        *                  Category -                                              *
1215        *                   SAPrwp."/BI0/TUCRATE_CAT"n                             *
1216        * Target Table:    RWP_TUCRATE_CAT -                     A57BXQB4.BE0001T0 *
1217        *                   PODSLIB1."RWP_TUCRATE_CAT"n                            *
1218        *==========================================================================*/
1219       
1220       %let transformID = %quote(A57BXQB4.BV000133);
1221       %let trans_rc = 0;
1222       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1223       
1224       %let SYSLAST = %nrquote(SAPrwp."/BI0/TUCRATE_CAT"n);
1225       
1226       %global etls_sql_pushDown;
1227       %let etls_sql_pushDown = -1;
1228       option DBIDIRECTEXEC;
1229       
1230       %global etls_tableExist;
1231       %global etls_numIndex;
42                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1232       %global etls_lastTable;
1233       %let etls_tableExist = -1;
1234       %let etls_numIndex = -1;
1235       %let etls_lastTable = &SYSLAST;
1236       
1237       /*---- Define load data macro  ----*/
1238       
1239       /* --------------------------------------------------------------
1240          Load Technique Selection: Replace - EntireTable
1241          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1242          Additional options selections...
1243             Set unmapped to missing on updates: false
1244          -------------------------------------------------------------- */
1245       %macro etls_loader;
1246       
1247          %let etls_tableOptions = ;
1248       
1249          /* Determine if the target table exists  */
1250          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TUCRATE_CAT"n, DATA)) or
1251                %sysfunc(exist(PODSLIB1."RWP_TUCRATE_CAT"n, VIEW)));
1252       
1253          %if &etls_tableExist %then
1254          %do;/* table exists  */
1255             %let etls_hasPreExistingConstraint=0;
1256       
1257             proc datasets lib = work nolist nowarn memtype = (data view);
1258                delete etls_commands etls_commands_F;
1259             quit;
1260       
1261             %let etls_otherTablesReferToThisTable=0;
1262       
1263             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1264                %put NOTE: Building table listing Constraints and Indexes for: &table;
1265                proc datasets lib=work nolist; delete &workTableOut; quit;
1266                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1267       
1268                data &workTableOut;
1269                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1270                   name = '';
1271                   type = '';
1272                   icown = '';
1273                   idxUnique = '';
1274                   idxNoMiss = '';
1275                   recreate = '';
1276                   set &workTableOut;
1277                   ref = '';
1278                   type=upcase(type);
1279                   if type eq 'REFERENTIAL' then
1280                   do;
1281                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1282                           " another table: " ref;
1283                      call symput('etls_otherTablesReferToThisTable','1');
1284                      delete;
1285                   end;
1286                   if type='INDEX' and ICOwn eq 'YES' then delete;
1287                run;
1288                %rcSet(&syserr);
1289       
43                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1290             %mend etls_CIContents;
1291       
1292             %etls_CIContents(table=PODSLIB1."RWP_TUCRATE_CAT"n, workTableOut=etls_commands, inDSOptions=);
1293       
1294             %if &etls_otherTablesReferToThisTable %then
1295                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1295     ! constraints.;
1296             %else
1297             %do; /* okay - remove foreign keys  */
1298       
1299                data etls_commands_F;
1300                   set etls_commands;
1301                   if upcase(type)="FOREIGN KEY" then
1302                   do;
1303                      command='ic delete '||trim(name)||';';
1304                      output etls_commands_F;
1305                   end;
1306                run;
1307       
1308                %put %str(NOTE: Removing foreign keys before dropping table...);
1309                data _null_;
1310                   set etls_commands_F end=eof;
1311                   if _n_=1 then
1312                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TUCRATE_CAT"n;');
1313                   call execute(command);
1314                   if eof then call execute('; quit;');
1315                run;
1316                %rcSet(&syserr);
1317       
1318          %end; /* okay - remove foreign keys  */
1319       
1320          proc datasets lib = work nolist nowarn memtype = (data view);
1321             delete etls_commands etls_commands_F;
1322          quit;
1323       
1324          /*---- Drop a table  ----*/
1325          %put %str(NOTE: Dropping table ...);
1326          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
1327             delete "RWP_TUCRATE_CAT"n;
1328          quit;
1329       
1330          %rcSet(&syserr);
1331       
1332          %let etls_tableExist = 0;
1333       
1334       %end; /* table exists  */
1335       
1336       /*---- Create a new table  ----*/
1337       %if (&etls_tableExist eq 0) %then
1338       %do;  /* if table does not exist  */
1339       
1340          %put %str(NOTE: Creating table ...);
1341       
1342          data PODSLIB1."RWP_TUCRATE_CAT"n
1343                  (label = 'Texts: Char. Rate Category'
1344                   COMPRESS = YES);
1345             attrib "UCRATE_CAT"n length = $10
1346                format = $10.
44                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1347                label = 'Rate Category';
1348             attrib "LANGU"n length = $1
1349                format = $1.
1350                label = 'Language Key';
1351             attrib "TXTSH"n length = $20
1352                format = $20.
1353                label = 'Short description';
1354             attrib "TXTMD"n length = $40
1355                format = $40.
1356                label = 'Medium description';
1357             attrib "TXTLG"n length = $60
1358                format = $60.
1359                label = 'Long description';
1360             call missing(of _all_);
1361             stop;
1362          run;
1363       
1364          %rcSet(&syserr);
1365       
1366       %end;  /* if table does not exist  */
1367       
1368       /*---- Append  ----*/
1369       %put %str(NOTE: Appending data ...);
1370       
1371       proc append base = PODSLIB1."RWP_TUCRATE_CAT"n(COMPRESS = YES)
1372          data = &etls_lastTable (&etls_tableOptions)  force ;
1373        run;
1374       
1375       %rcSet(&syserr);
1376       
1377       %mend etls_loader;
1378       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TUCRATE_CAT"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TUCRATE_CAT"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
45                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TUCRATE_CAT"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
46                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TUCRATE_CAT"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TUCRATE_CAT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           1.88 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TUCRATE_CAT"n (label = 'Texts: Char. Rate Category' COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "UCRATE_CAT"n length = $10 format = $10. label = 'Rate Category';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TUCRATE_CAT has 0 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TUCRATE_CAT"n(COMPRESS = YES) data = SAPRWP.'/BI0/TUCRATE_CAT'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TUCRATE_CAT'n to PODSLIB1.RWP_TUCRATE_CAT.
NOTE: There were 142 observations read from the data set SAPRWP.'/BI0/TUCRATE_CAT'n.
NOTE: 142 observations added.
NOTE: The data set PODSLIB1.RWP_TUCRATE_CAT has 142 observations and 5 variables.
NOTE: Compressing data set PODSLIB1.RWP_TUCRATE_CAT decreased size by 62.26 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.55 seconds
      cpu time            0.00 seconds
      

47                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):  ;
1379       
1380       %let etls_recCheckExist = 0;
1381       %let etls_recnt = 0;
1382       %macro etls_recordCheck;
1383          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TUCRATE_CAT"n, DATA)) or
1384                %sysfunc(exist(PODSLIB1."RWP_TUCRATE_CAT"n, VIEW)));
1385       
1386          %if (&etls_recCheckExist) %then
1387          %do;
1388             %local etls_syntaxcheck;
1389             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1390             /* Turn off syntaxcheck option to perform following steps  */
1391             options nosyntaxcheck;
1392       
1393             proc contents data = PODSLIB1."RWP_TUCRATE_CAT"n out = work.etls_contents(keep = nobs) noprint;
1394             run;
1395       
1396             data _null_;
1397                set work.etls_contents (obs = 1);
1398                call symput("etls_recnt", left(put(nobs,32.)));
1399             run;
1400       
1401             proc datasets lib = work nolist nowarn memtype = (data view);
1402                delete etls_contents;
1403             quit;
1404       
1405             /* Reset syntaxcheck option to previous setting  */
1406             options &etls_syntaxcheck;
1407          %end;
1408       %mend etls_recordCheck;
1409       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TUCRATE_CAT"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 5 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
48                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1410       
1411       
1412       
1413       /** Step end Table Loader **/
1414       
1415       /*==========================================================================*
1416        * Step:            Table Loader                          A57BXQB4.BV000134 *
1417        * Transform:       Table Loader (Version 2.1)                              *
1418        * Description:                                                             *
1419        *                                                                          *
1420        * Source Table:    _BIC_TZGRID_ID - -                    A57BXQB4.BE0001T1 *
1421        *                   SAPrwp."/BIC/TZGRID_ID"n                               *
1422        * Target Table:    RWP_TZGRID_ID -                       A57BXQB4.BE0001T2 *
1423        *                   PODSLIB1."RWP_TZGRID_ID"n                              *
1424        *==========================================================================*/
1425       
1426       %let transformID = %quote(A57BXQB4.BV000134);
1427       %let trans_rc = 0;
1428       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1429       
1430       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZGRID_ID"n);
1431       
1432       %global etls_sql_pushDown;
1433       %let etls_sql_pushDown = -1;
1434       option DBIDIRECTEXEC;
1435       
1436       %global etls_tableExist;
1437       %global etls_numIndex;
1438       %global etls_lastTable;
1439       %let etls_tableExist = -1;
1440       %let etls_numIndex = -1;
1441       %let etls_lastTable = &SYSLAST;
1442       
1443       /*---- Define load data macro  ----*/
1444       
1445       /* --------------------------------------------------------------
1446          Load Technique Selection: Replace - EntireTable
1447          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1448          Additional options selections...
1449             Set unmapped to missing on updates: false
1450          -------------------------------------------------------------- */
1451       %macro etls_loader;
1452       
1453          %let etls_tableOptions = ;
1454       
1455          /* Determine if the target table exists  */
1456          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZGRID_ID"n, DATA)) or
1457                %sysfunc(exist(PODSLIB1."RWP_TZGRID_ID"n, VIEW)));
1458       
1459          %if &etls_tableExist %then
1460          %do;/* table exists  */
1461             %let etls_hasPreExistingConstraint=0;
49                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1462       
1463             proc datasets lib = work nolist nowarn memtype = (data view);
1464                delete etls_commands etls_commands_F;
1465             quit;
1466       
1467             %let etls_otherTablesReferToThisTable=0;
1468       
1469             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1470                %put NOTE: Building table listing Constraints and Indexes for: &table;
1471                proc datasets lib=work nolist; delete &workTableOut; quit;
1472                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1473       
1474                data &workTableOut;
1475                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1476                   name = '';
1477                   type = '';
1478                   icown = '';
1479                   idxUnique = '';
1480                   idxNoMiss = '';
1481                   recreate = '';
1482                   set &workTableOut;
1483                   ref = '';
1484                   type=upcase(type);
1485                   if type eq 'REFERENTIAL' then
1486                   do;
1487                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1488                           " another table: " ref;
1489                      call symput('etls_otherTablesReferToThisTable','1');
1490                      delete;
1491                   end;
1492                   if type='INDEX' and ICOwn eq 'YES' then delete;
1493                run;
1494                %rcSet(&syserr);
1495       
1496             %mend etls_CIContents;
1497       
1498             %etls_CIContents(table=PODSLIB1."RWP_TZGRID_ID"n, workTableOut=etls_commands, inDSOptions=);
1499       
1500             %if &etls_otherTablesReferToThisTable %then
1501                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1501     ! constraints.;
1502             %else
1503             %do; /* okay - remove foreign keys  */
1504       
1505                data etls_commands_F;
1506                   set etls_commands;
1507                   if upcase(type)="FOREIGN KEY" then
1508                   do;
1509                      command='ic delete '||trim(name)||';';
1510                      output etls_commands_F;
1511                   end;
1512                run;
1513       
1514                %put %str(NOTE: Removing foreign keys before dropping table...);
1515                data _null_;
1516                   set etls_commands_F end=eof;
1517                   if _n_=1 then
1518                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZGRID_ID"n;');
50                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1519                   call execute(command);
1520                   if eof then call execute('; quit;');
1521                run;
1522                %rcSet(&syserr);
1523       
1524          %end; /* okay - remove foreign keys  */
1525       
1526          proc datasets lib = work nolist nowarn memtype = (data view);
1527             delete etls_commands etls_commands_F;
1528          quit;
1529       
1530          /*---- Drop a table  ----*/
1531          %put %str(NOTE: Dropping table ...);
1532          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
1533             delete "RWP_TZGRID_ID"n;
1534          quit;
1535       
1536          %rcSet(&syserr);
1537       
1538          %let etls_tableExist = 0;
1539       
1540       %end; /* table exists  */
1541       
1542       /*---- Create a new table  ----*/
1543       %if (&etls_tableExist eq 0) %then
1544       %do;  /* if table does not exist  */
1545       
1546          %put %str(NOTE: Creating table ...);
1547       
1548          data PODSLIB1."RWP_TZGRID_ID"n
1549                  (COMPRESS = YES);
1550             attrib "_BIC_ZGRID_ID"n length = $10
1551                format = $10.
1552                label = 'Distribution Company';
1553             attrib "LANGU"n length = $1
1554                format = $1.
1555                label = 'Language Key';
1556             attrib "TXTSH"n length = $20
1557                format = $20.
1558                label = 'Short description';
1559             call missing(of _all_);
1560             stop;
1561          run;
1562       
1563          %rcSet(&syserr);
1564       
1565       %end;  /* if table does not exist  */
1566       
1567       /*---- Append  ----*/
1568       %put %str(NOTE: Appending data ...);
1569       
1570       proc append base = PODSLIB1."RWP_TZGRID_ID"n(COMPRESS = YES)
1571          data = &etls_lastTable (&etls_tableOptions)  force ;
1572        run;
1573       
1574       %rcSet(&syserr);
1575       
1576       %mend etls_loader;
51                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1577       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZGRID_ID"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZGRID_ID"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
52                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZGRID_ID"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZGRID_ID"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZGRID_ID (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZGRID_ID"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZGRID_ID"n length = $10 format = $10. label = 'Distribution Company';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
53                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZGRID_ID has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZGRID_ID"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZGRID_ID'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZGRID_ID'n to PODSLIB1.RWP_TZGRID_ID.
NOTE: There were 0 observations read from the data set SAPRWP.'/BIC/TZGRID_ID'n.
NOTE: 0 observations added.
NOTE: The data set PODSLIB1.RWP_TZGRID_ID has 0 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.93 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
1578       
1579       %let etls_recCheckExist = 0;
1580       %let etls_recnt = 0;
1581       %macro etls_recordCheck;
1582          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZGRID_ID"n, DATA)) or
1583                %sysfunc(exist(PODSLIB1."RWP_TZGRID_ID"n, VIEW)));
1584       
1585          %if (&etls_recCheckExist) %then
1586          %do;
1587             %local etls_syntaxcheck;
1588             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1589             /* Turn off syntaxcheck option to perform following steps  */
1590             options nosyntaxcheck;
1591       
1592             proc contents data = PODSLIB1."RWP_TZGRID_ID"n out = work.etls_contents(keep = nobs) noprint;
1593             run;
1594       
1595             data _null_;
1596                set work.etls_contents (obs = 1);
1597                call symput("etls_recnt", left(put(nobs,32.)));
1598             run;
1599       
1600             proc datasets lib = work nolist nowarn memtype = (data view);
1601                delete etls_contents;
1602             quit;
1603       
1604             /* Reset syntaxcheck option to previous setting  */
1605             options &etls_syntaxcheck;
1606          %end;
1607       %mend etls_recordCheck;
1608       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZGRID_ID"n out = work.etls_contents(keep = nobs) noprint;
54                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1609       
1610       
1611       
1612       /** Step end Table Loader **/
1613       
1614       /*==========================================================================*
1615        * Step:            Table Loader                          A57BXQB4.BV000135 *
1616        * Transform:       Table Loader (Version 2.1)                              *
1617        * Description:                                                             *
1618        *                                                                          *
1619        * Source Table:    _BIC_TZCRMFY - -                      A57BXQB4.BE0001T3 *
1620        *                   SAPrwp."/BIC/TZCRMFY"n                                 *
1621        * Target Table:    RWP_TZCRMFY - PODSLIB1."RWP_TZCRMFY"n A57BXQB4.BE0001T4 *
1622        *==========================================================================*/
1623       
1624       %let transformID = %quote(A57BXQB4.BV000135);
1625       %let trans_rc = 0;
1626       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1627       
1628       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZCRMFY"n);
1629       
1630       %global etls_sql_pushDown;
1631       %let etls_sql_pushDown = -1;
1632       option DBIDIRECTEXEC;
1633       
1634       %global etls_tableExist;
1635       %global etls_numIndex;
1636       %global etls_lastTable;
55                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1637       %let etls_tableExist = -1;
1638       %let etls_numIndex = -1;
1639       %let etls_lastTable = &SYSLAST;
1640       
1641       /*---- Define load data macro  ----*/
1642       
1643       /* --------------------------------------------------------------
1644          Load Technique Selection: Replace - EntireTable
1645          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1646          Additional options selections...
1647             Set unmapped to missing on updates: false
1648          -------------------------------------------------------------- */
1649       %macro etls_loader;
1650       
1651          %let etls_tableOptions = ;
1652       
1653          /* Determine if the target table exists  */
1654          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMFY"n, DATA)) or
1655                %sysfunc(exist(PODSLIB1."RWP_TZCRMFY"n, VIEW)));
1656       
1657          %if &etls_tableExist %then
1658          %do;/* table exists  */
1659             %let etls_hasPreExistingConstraint=0;
1660       
1661             proc datasets lib = work nolist nowarn memtype = (data view);
1662                delete etls_commands etls_commands_F;
1663             quit;
1664       
1665             %let etls_otherTablesReferToThisTable=0;
1666       
1667             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1668                %put NOTE: Building table listing Constraints and Indexes for: &table;
1669                proc datasets lib=work nolist; delete &workTableOut; quit;
1670                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
1671       
1672                data &workTableOut;
1673                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1674                   name = '';
1675                   type = '';
1676                   icown = '';
1677                   idxUnique = '';
1678                   idxNoMiss = '';
1679                   recreate = '';
1680                   set &workTableOut;
1681                   ref = '';
1682                   type=upcase(type);
1683                   if type eq 'REFERENTIAL' then
1684                   do;
1685                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1686                           " another table: " ref;
1687                      call symput('etls_otherTablesReferToThisTable','1');
1688                      delete;
1689                   end;
1690                   if type='INDEX' and ICOwn eq 'YES' then delete;
1691                run;
1692                %rcSet(&syserr);
1693       
1694             %mend etls_CIContents;
56                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1695       
1696             %etls_CIContents(table=PODSLIB1."RWP_TZCRMFY"n, workTableOut=etls_commands, inDSOptions=);
1697       
1698             %if &etls_otherTablesReferToThisTable %then
1699                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1699     ! constraints.;
1700             %else
1701             %do; /* okay - remove foreign keys  */
1702       
1703                data etls_commands_F;
1704                   set etls_commands;
1705                   if upcase(type)="FOREIGN KEY" then
1706                   do;
1707                      command='ic delete '||trim(name)||';';
1708                      output etls_commands_F;
1709                   end;
1710                run;
1711       
1712                %put %str(NOTE: Removing foreign keys before dropping table...);
1713                data _null_;
1714                   set etls_commands_F end=eof;
1715                   if _n_=1 then
1716                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMFY"n;');
1717                   call execute(command);
1718                   if eof then call execute('; quit;');
1719                run;
1720                %rcSet(&syserr);
1721       
1722          %end; /* okay - remove foreign keys  */
1723       
1724          proc datasets lib = work nolist nowarn memtype = (data view);
1725             delete etls_commands etls_commands_F;
1726          quit;
1727       
1728          /*---- Drop a table  ----*/
1729          %put %str(NOTE: Dropping table ...);
1730          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
1731             delete "RWP_TZCRMFY"n;
1732          quit;
1733       
1734          %rcSet(&syserr);
1735       
1736          %let etls_tableExist = 0;
1737       
1738       %end; /* table exists  */
1739       
1740       /*---- Create a new table  ----*/
1741       %if (&etls_tableExist eq 0) %then
1742       %do;  /* if table does not exist  */
1743       
1744          %put %str(NOTE: Creating table ...);
1745       
1746          data PODSLIB1."RWP_TZCRMFY"n
1747                  (COMPRESS = YES);
1748             attrib "_BIC_ZCRMFY"n length = $2
1749                format = $2.;
1750             attrib "TXTSH"n length = $20
1751                format = $20.
57                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1752                label = 'Short description';
1753             attrib "TXTMD"n length = $40
1754                format = $40.
1755                label = 'Medium description';
1756             call missing(of _all_);
1757             stop;
1758          run;
1759       
1760          %rcSet(&syserr);
1761       
1762       %end;  /* if table does not exist  */
1763       
1764       /*---- Append  ----*/
1765       %put %str(NOTE: Appending data ...);
1766       
1767       proc append base = PODSLIB1."RWP_TZCRMFY"n(COMPRESS = YES)
1768          data = &etls_lastTable (&etls_tableOptions)  force ;
1769        run;
1770       
1771       %rcSet(&syserr);
1772       
1773       %mend etls_loader;
1774       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZCRMFY"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZCRMFY"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
58                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMFY"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
59                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZCRMFY"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZCRMFY (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZCRMFY"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMFY"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZCRMFY has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZCRMFY"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZCRMFY'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZCRMFY'n to PODSLIB1.RWP_TZCRMFY.
NOTE: There were 2 observations read from the data set SAPRWP.'/BIC/TZCRMFY'n.
NOTE: 2 observations added.
NOTE: The data set PODSLIB1.RWP_TZCRMFY has 2 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZCRMFY decreased size by 50.00 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.74 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
1775       
1776       %let etls_recCheckExist = 0;
1777       %let etls_recnt = 0;
1778       %macro etls_recordCheck;
1779          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMFY"n, DATA)) or
1780                %sysfunc(exist(PODSLIB1."RWP_TZCRMFY"n, VIEW)));
1781       
1782          %if (&etls_recCheckExist) %then
1783          %do;
1784             %local etls_syntaxcheck;
60                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1785             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1786             /* Turn off syntaxcheck option to perform following steps  */
1787             options nosyntaxcheck;
1788       
1789             proc contents data = PODSLIB1."RWP_TZCRMFY"n out = work.etls_contents(keep = nobs) noprint;
1790             run;
1791       
1792             data _null_;
1793                set work.etls_contents (obs = 1);
1794                call symput("etls_recnt", left(put(nobs,32.)));
1795             run;
1796       
1797             proc datasets lib = work nolist nowarn memtype = (data view);
1798                delete etls_contents;
1799             quit;
1800       
1801             /* Reset syntaxcheck option to previous setting  */
1802             options &etls_syntaxcheck;
1803          %end;
1804       %mend etls_recordCheck;
1805       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZCRMFY"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
1806       
1807       
1808       
1809       /** Step end Table Loader **/
1810       
61                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1811       /*==========================================================================*
1812        * Step:            Table Loader                          A57BXQB4.BV000136 *
1813        * Transform:       Table Loader (Version 2.1)                              *
1814        * Description:                                                             *
1815        *                                                                          *
1816        * Source Table:    _BIC_TZCRMGBI - -                     A57BXQB4.BE0001T5 *
1817        *                   SAPrwp."/BIC/TZCRMGBI"n                                *
1818        * Target Table:    RWP_TZCRMGBI -                        A57BXQB4.BE0001T6 *
1819        *                   PODSLIB1."RWP_TZCRMGBI"n                               *
1820        *==========================================================================*/
1821       
1822       %let transformID = %quote(A57BXQB4.BV000136);
1823       %let trans_rc = 0;
1824       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
1825       
1826       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZCRMGBI"n);
1827       
1828       %global etls_sql_pushDown;
1829       %let etls_sql_pushDown = -1;
1830       option DBIDIRECTEXEC;
1831       
1832       %global etls_tableExist;
1833       %global etls_numIndex;
1834       %global etls_lastTable;
1835       %let etls_tableExist = -1;
1836       %let etls_numIndex = -1;
1837       %let etls_lastTable = &SYSLAST;
1838       
1839       /*---- Define load data macro  ----*/
1840       
1841       /* --------------------------------------------------------------
1842          Load Technique Selection: Replace - EntireTable
1843          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
1844          Additional options selections...
1845             Set unmapped to missing on updates: false
1846          -------------------------------------------------------------- */
1847       %macro etls_loader;
1848       
1849          %let etls_tableOptions = ;
1850       
1851          /* Determine if the target table exists  */
1852          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMGBI"n, DATA)) or
1853                %sysfunc(exist(PODSLIB1."RWP_TZCRMGBI"n, VIEW)));
1854       
1855          %if &etls_tableExist %then
1856          %do;/* table exists  */
1857             %let etls_hasPreExistingConstraint=0;
1858       
1859             proc datasets lib = work nolist nowarn memtype = (data view);
1860                delete etls_commands etls_commands_F;
1861             quit;
1862       
1863             %let etls_otherTablesReferToThisTable=0;
1864       
1865             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
1866                %put NOTE: Building table listing Constraints and Indexes for: &table;
1867                proc datasets lib=work nolist; delete &workTableOut; quit;
1868                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
62                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1869       
1870                data &workTableOut;
1871                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
1872                   name = '';
1873                   type = '';
1874                   icown = '';
1875                   idxUnique = '';
1876                   idxNoMiss = '';
1877                   recreate = '';
1878                   set &workTableOut;
1879                   ref = '';
1880                   type=upcase(type);
1881                   if type eq 'REFERENTIAL' then
1882                   do;
1883                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
1884                           " another table: " ref;
1885                      call symput('etls_otherTablesReferToThisTable','1');
1886                      delete;
1887                   end;
1888                   if type='INDEX' and ICOwn eq 'YES' then delete;
1889                run;
1890                %rcSet(&syserr);
1891       
1892             %mend etls_CIContents;
1893       
1894             %etls_CIContents(table=PODSLIB1."RWP_TZCRMGBI"n, workTableOut=etls_commands, inDSOptions=);
1895       
1896             %if &etls_otherTablesReferToThisTable %then
1897                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
1897     ! constraints.;
1898             %else
1899             %do; /* okay - remove foreign keys  */
1900       
1901                data etls_commands_F;
1902                   set etls_commands;
1903                   if upcase(type)="FOREIGN KEY" then
1904                   do;
1905                      command='ic delete '||trim(name)||';';
1906                      output etls_commands_F;
1907                   end;
1908                run;
1909       
1910                %put %str(NOTE: Removing foreign keys before dropping table...);
1911                data _null_;
1912                   set etls_commands_F end=eof;
1913                   if _n_=1 then
1914                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMGBI"n;');
1915                   call execute(command);
1916                   if eof then call execute('; quit;');
1917                run;
1918                %rcSet(&syserr);
1919       
1920          %end; /* okay - remove foreign keys  */
1921       
1922          proc datasets lib = work nolist nowarn memtype = (data view);
1923             delete etls_commands etls_commands_F;
1924          quit;
1925       
63                                                         The SAS System                          09:30 Wednesday, December 2, 2020

1926          /*---- Drop a table  ----*/
1927          %put %str(NOTE: Dropping table ...);
1928          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
1929             delete "RWP_TZCRMGBI"n;
1930          quit;
1931       
1932          %rcSet(&syserr);
1933       
1934          %let etls_tableExist = 0;
1935       
1936       %end; /* table exists  */
1937       
1938       /*---- Create a new table  ----*/
1939       %if (&etls_tableExist eq 0) %then
1940       %do;  /* if table does not exist  */
1941       
1942          %put %str(NOTE: Creating table ...);
1943       
1944          data PODSLIB1."RWP_TZCRMGBI"n
1945                  (COMPRESS = YES);
1946             attrib "_BIC_ZCRMGBI"n length = $2
1947                format = $2.;
1948             attrib "TXTSH"n length = $20
1949                format = $20.
1950                label = 'Short description';
1951             attrib "TXTMD"n length = $40
1952                format = $40.
1953                label = 'Medium description';
1954             call missing(of _all_);
1955             stop;
1956          run;
1957       
1958          %rcSet(&syserr);
1959       
1960       %end;  /* if table does not exist  */
1961       
1962       /*---- Append  ----*/
1963       %put %str(NOTE: Appending data ...);
1964       
1965       proc append base = PODSLIB1."RWP_TZCRMGBI"n(COMPRESS = YES)
1966          data = &etls_lastTable (&etls_tableOptions)  force ;
1967        run;
1968       
1969       %rcSet(&syserr);
1970       
1971       %mend etls_loader;
1972       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZCRMGBI"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
64                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZCRMGBI"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
65                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMGBI"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZCRMGBI"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZCRMGBI (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZCRMGBI"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMGBI"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZCRMGBI has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
66                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZCRMGBI"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZCRMGBI'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZCRMGBI'n to PODSLIB1.RWP_TZCRMGBI.
NOTE: There were 2 observations read from the data set SAPRWP.'/BIC/TZCRMGBI'n.
NOTE: 2 observations added.
NOTE: The data set PODSLIB1.RWP_TZCRMGBI has 2 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZCRMGBI decreased size by 74.19 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.74 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
1973       
1974       %let etls_recCheckExist = 0;
1975       %let etls_recnt = 0;
1976       %macro etls_recordCheck;
1977          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMGBI"n, DATA)) or
1978                %sysfunc(exist(PODSLIB1."RWP_TZCRMGBI"n, VIEW)));
1979       
1980          %if (&etls_recCheckExist) %then
1981          %do;
1982             %local etls_syntaxcheck;
1983             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
1984             /* Turn off syntaxcheck option to perform following steps  */
1985             options nosyntaxcheck;
1986       
1987             proc contents data = PODSLIB1."RWP_TZCRMGBI"n out = work.etls_contents(keep = nobs) noprint;
1988             run;
1989       
1990             data _null_;
1991                set work.etls_contents (obs = 1);
1992                call symput("etls_recnt", left(put(nobs,32.)));
1993             run;
1994       
1995             proc datasets lib = work nolist nowarn memtype = (data view);
1996                delete etls_contents;
1997             quit;
1998       
1999             /* Reset syntaxcheck option to previous setting  */
2000             options &etls_syntaxcheck;
2001          %end;
2002       %mend etls_recordCheck;
2003       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZCRMGBI"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
67                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2004       
2005       
2006       
2007       /** Step end Table Loader **/
2008       
2009       /*==========================================================================*
2010        * Step:            Table Loader                          A57BXQB4.BV000137 *
2011        * Transform:       Table Loader (Version 2.1)                              *
2012        * Description:                                                             *
2013        *                                                                          *
2014        * Source Table:    _BIC_TZCRMGB - -                      A57BXQB4.BE0001T7 *
2015        *                   SAPrwp."/BIC/TZCRMGB"n                                 *
2016        * Target Table:    RWP_TZCRMGB - PODSLIB1."RWP_TZCRMGB"n A57BXQB4.BE0001T8 *
2017        *==========================================================================*/
2018       
2019       %let transformID = %quote(A57BXQB4.BV000137);
2020       %let trans_rc = 0;
2021       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2022       
2023       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZCRMGB"n);
2024       
2025       %global etls_sql_pushDown;
2026       %let etls_sql_pushDown = -1;
2027       option DBIDIRECTEXEC;
2028       
2029       %global etls_tableExist;
2030       %global etls_numIndex;
2031       %global etls_lastTable;
2032       %let etls_tableExist = -1;
2033       %let etls_numIndex = -1;
2034       %let etls_lastTable = &SYSLAST;
2035       
2036       /*---- Define load data macro  ----*/
2037       
2038       /* --------------------------------------------------------------
2039          Load Technique Selection: Replace - EntireTable
2040          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2041          Additional options selections...
2042             Set unmapped to missing on updates: false
68                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2043          -------------------------------------------------------------- */
2044       %macro etls_loader;
2045       
2046          %let etls_tableOptions = ;
2047       
2048          /* Determine if the target table exists  */
2049          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMGB"n, DATA)) or
2050                %sysfunc(exist(PODSLIB1."RWP_TZCRMGB"n, VIEW)));
2051       
2052          %if &etls_tableExist %then
2053          %do;/* table exists  */
2054             %let etls_hasPreExistingConstraint=0;
2055       
2056             proc datasets lib = work nolist nowarn memtype = (data view);
2057                delete etls_commands etls_commands_F;
2058             quit;
2059       
2060             %let etls_otherTablesReferToThisTable=0;
2061       
2062             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2063                %put NOTE: Building table listing Constraints and Indexes for: &table;
2064                proc datasets lib=work nolist; delete &workTableOut; quit;
2065                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2066       
2067                data &workTableOut;
2068                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2069                   name = '';
2070                   type = '';
2071                   icown = '';
2072                   idxUnique = '';
2073                   idxNoMiss = '';
2074                   recreate = '';
2075                   set &workTableOut;
2076                   ref = '';
2077                   type=upcase(type);
2078                   if type eq 'REFERENTIAL' then
2079                   do;
2080                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2081                           " another table: " ref;
2082                      call symput('etls_otherTablesReferToThisTable','1');
2083                      delete;
2084                   end;
2085                   if type='INDEX' and ICOwn eq 'YES' then delete;
2086                run;
2087                %rcSet(&syserr);
2088       
2089             %mend etls_CIContents;
2090       
2091             %etls_CIContents(table=PODSLIB1."RWP_TZCRMGB"n, workTableOut=etls_commands, inDSOptions=);
2092       
2093             %if &etls_otherTablesReferToThisTable %then
2094                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2094     ! constraints.;
2095             %else
2096             %do; /* okay - remove foreign keys  */
2097       
2098                data etls_commands_F;
2099                   set etls_commands;
69                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2100                   if upcase(type)="FOREIGN KEY" then
2101                   do;
2102                      command='ic delete '||trim(name)||';';
2103                      output etls_commands_F;
2104                   end;
2105                run;
2106       
2107                %put %str(NOTE: Removing foreign keys before dropping table...);
2108                data _null_;
2109                   set etls_commands_F end=eof;
2110                   if _n_=1 then
2111                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMGB"n;');
2112                   call execute(command);
2113                   if eof then call execute('; quit;');
2114                run;
2115                %rcSet(&syserr);
2116       
2117          %end; /* okay - remove foreign keys  */
2118       
2119          proc datasets lib = work nolist nowarn memtype = (data view);
2120             delete etls_commands etls_commands_F;
2121          quit;
2122       
2123          /*---- Drop a table  ----*/
2124          %put %str(NOTE: Dropping table ...);
2125          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
2126             delete "RWP_TZCRMGB"n;
2127          quit;
2128       
2129          %rcSet(&syserr);
2130       
2131          %let etls_tableExist = 0;
2132       
2133       %end; /* table exists  */
2134       
2135       /*---- Create a new table  ----*/
2136       %if (&etls_tableExist eq 0) %then
2137       %do;  /* if table does not exist  */
2138       
2139          %put %str(NOTE: Creating table ...);
2140       
2141          data PODSLIB1."RWP_TZCRMGB"n
2142                  (COMPRESS = YES);
2143             attrib "_BIC_ZCRMGB"n length = $2
2144                format = $2.;
2145             attrib "TXTSH"n length = $20
2146                format = $20.
2147                label = 'Short description';
2148             attrib "TXTMD"n length = $40
2149                format = $40.
2150                label = 'Medium description';
2151             call missing(of _all_);
2152             stop;
2153          run;
2154       
2155          %rcSet(&syserr);
2156       
2157       %end;  /* if table does not exist  */
70                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2158       
2159       /*---- Append  ----*/
2160       %put %str(NOTE: Appending data ...);
2161       
2162       proc append base = PODSLIB1."RWP_TZCRMGB"n(COMPRESS = YES)
2163          data = &etls_lastTable (&etls_tableOptions)  force ;
2164        run;
2165       
2166       %rcSet(&syserr);
2167       
2168       %mend etls_loader;
2169       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZCRMGB"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZCRMGB"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
71                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMGB"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZCRMGB"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZCRMGB (memtype=DATA).
72                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZCRMGB"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMGB"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZCRMGB has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZCRMGB"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZCRMGB'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZCRMGB'n to PODSLIB1.RWP_TZCRMGB.
NOTE: There were 1 observations read from the data set SAPRWP.'/BIC/TZCRMGB'n.
NOTE: 1 observations added.
NOTE: The data set PODSLIB1.RWP_TZCRMGB has 1 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZCRMGB decreased size by 33.87 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.85 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
2170       
2171       %let etls_recCheckExist = 0;
2172       %let etls_recnt = 0;
2173       %macro etls_recordCheck;
2174          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMGB"n, DATA)) or
2175                %sysfunc(exist(PODSLIB1."RWP_TZCRMGB"n, VIEW)));
2176       
2177          %if (&etls_recCheckExist) %then
2178          %do;
2179             %local etls_syntaxcheck;
2180             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2181             /* Turn off syntaxcheck option to perform following steps  */
2182             options nosyntaxcheck;
2183       
2184             proc contents data = PODSLIB1."RWP_TZCRMGB"n out = work.etls_contents(keep = nobs) noprint;
2185             run;
2186       
2187             data _null_;
2188                set work.etls_contents (obs = 1);
2189                call symput("etls_recnt", left(put(nobs,32.)));
2190             run;
73                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2191       
2192             proc datasets lib = work nolist nowarn memtype = (data view);
2193                delete etls_contents;
2194             quit;
2195       
2196             /* Reset syntaxcheck option to previous setting  */
2197             options &etls_syntaxcheck;
2198          %end;
2199       %mend etls_recordCheck;
2200       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZCRMGB"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2201       
2202       
2203       
2204       /** Step end Table Loader **/
2205       
2206       /*==========================================================================*
2207        * Step:            Table Loader                          A57BXQB4.BV000138 *
2208        * Transform:       Table Loader (Version 2.1)                              *
2209        * Description:                                                             *
2210        *                                                                          *
2211        * Source Table:    _BIC_TZTAHSTR - -                     A57BXQB4.BE0001T9 *
2212        *                   SAPrwp."/BIC/TZTAHSTR"n                                *
2213        * Target Table:    RWP_TZTAHSTR -                        A57BXQB4.BE0001TA *
2214        *                   PODSLIB1."RWP_TZTAHSTR"n                               *
2215        *==========================================================================*/
2216       
74                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2217       %let transformID = %quote(A57BXQB4.BV000138);
2218       %let trans_rc = 0;
2219       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2220       
2221       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZTAHSTR"n);
2222       
2223       %global etls_sql_pushDown;
2224       %let etls_sql_pushDown = -1;
2225       option DBIDIRECTEXEC;
2226       
2227       %global etls_tableExist;
2228       %global etls_numIndex;
2229       %global etls_lastTable;
2230       %let etls_tableExist = -1;
2231       %let etls_numIndex = -1;
2232       %let etls_lastTable = &SYSLAST;
2233       
2234       /*---- Define load data macro  ----*/
2235       
2236       /* --------------------------------------------------------------
2237          Load Technique Selection: Replace - EntireTable
2238          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2239          Additional options selections...
2240             Set unmapped to missing on updates: false
2241          -------------------------------------------------------------- */
2242       %macro etls_loader;
2243       
2244          %let etls_tableOptions = ;
2245       
2246          /* Determine if the target table exists  */
2247          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZTAHSTR"n, DATA)) or
2248                %sysfunc(exist(PODSLIB1."RWP_TZTAHSTR"n, VIEW)));
2249       
2250          %if &etls_tableExist %then
2251          %do;/* table exists  */
2252             %let etls_hasPreExistingConstraint=0;
2253       
2254             proc datasets lib = work nolist nowarn memtype = (data view);
2255                delete etls_commands etls_commands_F;
2256             quit;
2257       
2258             %let etls_otherTablesReferToThisTable=0;
2259       
2260             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2261                %put NOTE: Building table listing Constraints and Indexes for: &table;
2262                proc datasets lib=work nolist; delete &workTableOut; quit;
2263                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2264       
2265                data &workTableOut;
2266                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2267                   name = '';
2268                   type = '';
2269                   icown = '';
2270                   idxUnique = '';
2271                   idxNoMiss = '';
2272                   recreate = '';
2273                   set &workTableOut;
2274                   ref = '';
75                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2275                   type=upcase(type);
2276                   if type eq 'REFERENTIAL' then
2277                   do;
2278                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2279                           " another table: " ref;
2280                      call symput('etls_otherTablesReferToThisTable','1');
2281                      delete;
2282                   end;
2283                   if type='INDEX' and ICOwn eq 'YES' then delete;
2284                run;
2285                %rcSet(&syserr);
2286       
2287             %mend etls_CIContents;
2288       
2289             %etls_CIContents(table=PODSLIB1."RWP_TZTAHSTR"n, workTableOut=etls_commands, inDSOptions=);
2290       
2291             %if &etls_otherTablesReferToThisTable %then
2292                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2292     ! constraints.;
2293             %else
2294             %do; /* okay - remove foreign keys  */
2295       
2296                data etls_commands_F;
2297                   set etls_commands;
2298                   if upcase(type)="FOREIGN KEY" then
2299                   do;
2300                      command='ic delete '||trim(name)||';';
2301                      output etls_commands_F;
2302                   end;
2303                run;
2304       
2305                %put %str(NOTE: Removing foreign keys before dropping table...);
2306                data _null_;
2307                   set etls_commands_F end=eof;
2308                   if _n_=1 then
2309                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZTAHSTR"n;');
2310                   call execute(command);
2311                   if eof then call execute('; quit;');
2312                run;
2313                %rcSet(&syserr);
2314       
2315          %end; /* okay - remove foreign keys  */
2316       
2317          proc datasets lib = work nolist nowarn memtype = (data view);
2318             delete etls_commands etls_commands_F;
2319          quit;
2320       
2321          /*---- Drop a table  ----*/
2322          %put %str(NOTE: Dropping table ...);
2323          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
2324             delete "RWP_TZTAHSTR"n;
2325          quit;
2326       
2327          %rcSet(&syserr);
2328       
2329          %let etls_tableExist = 0;
2330       
2331       %end; /* table exists  */
76                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2332       
2333       /*---- Create a new table  ----*/
2334       %if (&etls_tableExist eq 0) %then
2335       %do;  /* if table does not exist  */
2336       
2337          %put %str(NOTE: Creating table ...);
2338       
2339          data PODSLIB1."RWP_TZTAHSTR"n
2340                  (COMPRESS = YES);
2341             attrib "_BIC_ZTAHSTR"n length = $40
2342                format = $40.;
2343             attrib "LANGU"n length = $1
2344                format = $1.
2345                label = 'Language Key';
2346             attrib "TXTSH"n length = $20
2347                format = $20.
2348                label = 'Short description';
2349             attrib "TXTLG"n length = $60
2350                format = $60.
2351                label = 'Long description';
2352             call missing(of _all_);
2353             stop;
2354          run;
2355       
2356          %rcSet(&syserr);
2357       
2358       %end;  /* if table does not exist  */
2359       
2360       /*---- Append  ----*/
2361       %put %str(NOTE: Appending data ...);
2362       
2363       proc append base = PODSLIB1."RWP_TZTAHSTR"n(COMPRESS = YES)
2364          data = &etls_lastTable (&etls_tableOptions)  force ;
2365        run;
2366       
2367       %rcSet(&syserr);
2368       
2369       %mend etls_loader;
2370       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZTAHSTR"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
77                                                         The SAS System                          09:30 Wednesday, December 2, 2020


MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZTAHSTR"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZTAHSTR"n;');
MPRINT(ETLS_LOADER):   call execute(command);
78                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZTAHSTR"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZTAHSTR (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZTAHSTR"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZTAHSTR"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZTAHSTR has 0 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZTAHSTR"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZTAHSTR'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZTAHSTR'n to PODSLIB1.RWP_TZTAHSTR.
NOTE: There were 10 observations read from the data set SAPRWP.'/BIC/TZTAHSTR'n.
NOTE: 10 observations added.
NOTE: The data set PODSLIB1.RWP_TZTAHSTR has 10 observations and 4 variables.
79                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Compressing data set PODSLIB1.RWP_TZTAHSTR decreased size by 52.64 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.74 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
2371       
2372       %let etls_recCheckExist = 0;
2373       %let etls_recnt = 0;
2374       %macro etls_recordCheck;
2375          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZTAHSTR"n, DATA)) or
2376                %sysfunc(exist(PODSLIB1."RWP_TZTAHSTR"n, VIEW)));
2377       
2378          %if (&etls_recCheckExist) %then
2379          %do;
2380             %local etls_syntaxcheck;
2381             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2382             /* Turn off syntaxcheck option to perform following steps  */
2383             options nosyntaxcheck;
2384       
2385             proc contents data = PODSLIB1."RWP_TZTAHSTR"n out = work.etls_contents(keep = nobs) noprint;
2386             run;
2387       
2388             data _null_;
2389                set work.etls_contents (obs = 1);
2390                call symput("etls_recnt", left(put(nobs,32.)));
2391             run;
2392       
2393             proc datasets lib = work nolist nowarn memtype = (data view);
2394                delete etls_contents;
2395             quit;
2396       
2397             /* Reset syntaxcheck option to previous setting  */
2398             options &etls_syntaxcheck;
2399          %end;
2400       %mend etls_recordCheck;
2401       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZTAHSTR"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 4 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
80                                                         The SAS System                          09:30 Wednesday, December 2, 2020


MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2402       
2403       
2404       
2405       /** Step end Table Loader **/
2406       
2407       /*==========================================================================*
2408        * Step:            Table Loader                          A57BXQB4.BV000139 *
2409        * Transform:       Table Loader (Version 2.1)                              *
2410        * Description:                                                             *
2411        *                                                                          *
2412        * Source Table:    _BIC_TZZSUBPROC - -                   A57BXQB4.BE0001TB *
2413        *                   SAPrwp."/BIC/TZZSUBPROC"n                              *
2414        * Target Table:    RWP_TZZSUBPROC -                      A57BXQB4.BE0001TC *
2415        *                   PODSLIB1."RWP_TZZSUBPROC"n                             *
2416        *==========================================================================*/
2417       
2418       %let transformID = %quote(A57BXQB4.BV000139);
2419       %let trans_rc = 0;
2420       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2421       
2422       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZZSUBPROC"n);
2423       
2424       %global etls_sql_pushDown;
2425       %let etls_sql_pushDown = -1;
2426       option DBIDIRECTEXEC;
2427       
2428       %global etls_tableExist;
2429       %global etls_numIndex;
2430       %global etls_lastTable;
2431       %let etls_tableExist = -1;
2432       %let etls_numIndex = -1;
2433       %let etls_lastTable = &SYSLAST;
2434       
2435       /*---- Define load data macro  ----*/
2436       
2437       /* --------------------------------------------------------------
2438          Load Technique Selection: Replace - EntireTable
2439          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2440          Additional options selections...
2441             Set unmapped to missing on updates: false
2442          -------------------------------------------------------------- */
2443       %macro etls_loader;
2444       
2445          %let etls_tableOptions = ;
2446       
2447          /* Determine if the target table exists  */
81                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2448          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZZSUBPROC"n, DATA)) or
2449                %sysfunc(exist(PODSLIB1."RWP_TZZSUBPROC"n, VIEW)));
2450       
2451          %if &etls_tableExist %then
2452          %do;/* table exists  */
2453             %let etls_hasPreExistingConstraint=0;
2454       
2455             proc datasets lib = work nolist nowarn memtype = (data view);
2456                delete etls_commands etls_commands_F;
2457             quit;
2458       
2459             %let etls_otherTablesReferToThisTable=0;
2460       
2461             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2462                %put NOTE: Building table listing Constraints and Indexes for: &table;
2463                proc datasets lib=work nolist; delete &workTableOut; quit;
2464                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2465       
2466                data &workTableOut;
2467                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2468                   name = '';
2469                   type = '';
2470                   icown = '';
2471                   idxUnique = '';
2472                   idxNoMiss = '';
2473                   recreate = '';
2474                   set &workTableOut;
2475                   ref = '';
2476                   type=upcase(type);
2477                   if type eq 'REFERENTIAL' then
2478                   do;
2479                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2480                           " another table: " ref;
2481                      call symput('etls_otherTablesReferToThisTable','1');
2482                      delete;
2483                   end;
2484                   if type='INDEX' and ICOwn eq 'YES' then delete;
2485                run;
2486                %rcSet(&syserr);
2487       
2488             %mend etls_CIContents;
2489       
2490             %etls_CIContents(table=PODSLIB1."RWP_TZZSUBPROC"n, workTableOut=etls_commands, inDSOptions=);
2491       
2492             %if &etls_otherTablesReferToThisTable %then
2493                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2493     ! constraints.;
2494             %else
2495             %do; /* okay - remove foreign keys  */
2496       
2497                data etls_commands_F;
2498                   set etls_commands;
2499                   if upcase(type)="FOREIGN KEY" then
2500                   do;
2501                      command='ic delete '||trim(name)||';';
2502                      output etls_commands_F;
2503                   end;
2504                run;
82                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2505       
2506                %put %str(NOTE: Removing foreign keys before dropping table...);
2507                data _null_;
2508                   set etls_commands_F end=eof;
2509                   if _n_=1 then
2510                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZZSUBPROC"n;');
2511                   call execute(command);
2512                   if eof then call execute('; quit;');
2513                run;
2514                %rcSet(&syserr);
2515       
2516          %end; /* okay - remove foreign keys  */
2517       
2518          proc datasets lib = work nolist nowarn memtype = (data view);
2519             delete etls_commands etls_commands_F;
2520          quit;
2521       
2522          /*---- Drop a table  ----*/
2523          %put %str(NOTE: Dropping table ...);
2524          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
2525             delete "RWP_TZZSUBPROC"n;
2526          quit;
2527       
2528          %rcSet(&syserr);
2529       
2530          %let etls_tableExist = 0;
2531       
2532       %end; /* table exists  */
2533       
2534       /*---- Create a new table  ----*/
2535       %if (&etls_tableExist eq 0) %then
2536       %do;  /* if table does not exist  */
2537       
2538          %put %str(NOTE: Creating table ...);
2539       
2540          data PODSLIB1."RWP_TZZSUBPROC"n
2541                  (COMPRESS = YES);
2542             attrib "_BIC_ZZSUBPROC"n length = $2
2543                format = $2.;
2544             attrib "LANGU"n length = $1
2545                format = $1.
2546                label = 'Language Key';
2547             attrib "TXTMD"n length = $40
2548                format = $40.
2549                label = 'Medium description';
2550             call missing(of _all_);
2551             stop;
2552          run;
2553       
2554          %rcSet(&syserr);
2555       
2556       %end;  /* if table does not exist  */
2557       
2558       /*---- Append  ----*/
2559       %put %str(NOTE: Appending data ...);
2560       
2561       proc append base = PODSLIB1."RWP_TZZSUBPROC"n(COMPRESS = YES)
2562          data = &etls_lastTable (&etls_tableOptions)  force ;
83                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2563        run;
2564       
2565       %rcSet(&syserr);
2566       
2567       %mend etls_loader;
2568       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZZSUBPROC"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZZSUBPROC"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
84                                                         The SAS System                          09:30 Wednesday, December 2, 2020

      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZZSUBPROC"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZZSUBPROC"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZZSUBPROC (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
85                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZZSUBPROC"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZZSUBPROC"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZZSUBPROC has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZZSUBPROC"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZZSUBPROC'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZZSUBPROC'n to PODSLIB1.RWP_TZZSUBPROC.
NOTE: There were 5 observations read from the data set SAPRWP.'/BIC/TZZSUBPROC'n.
NOTE: 5 observations added.
NOTE: The data set PODSLIB1.RWP_TZZSUBPROC has 5 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZZSUBPROC decreased size by 42.79 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.55 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
2569       
2570       %let etls_recCheckExist = 0;
2571       %let etls_recnt = 0;
2572       %macro etls_recordCheck;
2573          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZZSUBPROC"n, DATA)) or
2574                %sysfunc(exist(PODSLIB1."RWP_TZZSUBPROC"n, VIEW)));
2575       
2576          %if (&etls_recCheckExist) %then
2577          %do;
2578             %local etls_syntaxcheck;
2579             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2580             /* Turn off syntaxcheck option to perform following steps  */
2581             options nosyntaxcheck;
2582       
2583             proc contents data = PODSLIB1."RWP_TZZSUBPROC"n out = work.etls_contents(keep = nobs) noprint;
2584             run;
2585       
2586             data _null_;
2587                set work.etls_contents (obs = 1);
2588                call symput("etls_recnt", left(put(nobs,32.)));
2589             run;
2590       
2591             proc datasets lib = work nolist nowarn memtype = (data view);
2592                delete etls_contents;
2593             quit;
2594       
2595             /* Reset syntaxcheck option to previous setting  */
86                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2596             options &etls_syntaxcheck;
2597          %end;
2598       %mend etls_recordCheck;
2599       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZZSUBPROC"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2600       
2601       
2602       
2603       /** Step end Table Loader **/
2604       
2605       /*==========================================================================*
2606        * Step:            Table Loader                          A57BXQB4.BV00013A *
2607        * Transform:       Table Loader (Version 2.1)                              *
2608        * Description:                                                             *
2609        *                                                                          *
2610        * Source Table:    _BIC_TZCRMKDM - -                     A57BXQB4.BE0001TD *
2611        *                   SAPrwp."/BIC/TZCRMKDM"n                                *
2612        * Target Table:    RWP_TZCRMKDM -                        A57BXQB4.BE0001TE *
2613        *                   PODSLIB1."RWP_TZCRMKDM"n                               *
2614        *==========================================================================*/
2615       
2616       %let transformID = %quote(A57BXQB4.BV00013A);
2617       %let trans_rc = 0;
2618       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2619       
2620       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZCRMKDM"n);
2621       
87                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2622       %global etls_sql_pushDown;
2623       %let etls_sql_pushDown = -1;
2624       option DBIDIRECTEXEC;
2625       
2626       %global etls_tableExist;
2627       %global etls_numIndex;
2628       %global etls_lastTable;
2629       %let etls_tableExist = -1;
2630       %let etls_numIndex = -1;
2631       %let etls_lastTable = &SYSLAST;
2632       
2633       /*---- Define load data macro  ----*/
2634       
2635       /* --------------------------------------------------------------
2636          Load Technique Selection: Replace - EntireTable
2637          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2638          Additional options selections...
2639             Set unmapped to missing on updates: false
2640          -------------------------------------------------------------- */
2641       %macro etls_loader;
2642       
2643          %let etls_tableOptions = ;
2644       
2645          /* Determine if the target table exists  */
2646          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMKDM"n, DATA)) or
2647                %sysfunc(exist(PODSLIB1."RWP_TZCRMKDM"n, VIEW)));
2648       
2649          %if &etls_tableExist %then
2650          %do;/* table exists  */
2651             %let etls_hasPreExistingConstraint=0;
2652       
2653             proc datasets lib = work nolist nowarn memtype = (data view);
2654                delete etls_commands etls_commands_F;
2655             quit;
2656       
2657             %let etls_otherTablesReferToThisTable=0;
2658       
2659             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2660                %put NOTE: Building table listing Constraints and Indexes for: &table;
2661                proc datasets lib=work nolist; delete &workTableOut; quit;
2662                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2663       
2664                data &workTableOut;
2665                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2666                   name = '';
2667                   type = '';
2668                   icown = '';
2669                   idxUnique = '';
2670                   idxNoMiss = '';
2671                   recreate = '';
2672                   set &workTableOut;
2673                   ref = '';
2674                   type=upcase(type);
2675                   if type eq 'REFERENTIAL' then
2676                   do;
2677                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2678                           " another table: " ref;
2679                      call symput('etls_otherTablesReferToThisTable','1');
88                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2680                      delete;
2681                   end;
2682                   if type='INDEX' and ICOwn eq 'YES' then delete;
2683                run;
2684                %rcSet(&syserr);
2685       
2686             %mend etls_CIContents;
2687       
2688             %etls_CIContents(table=PODSLIB1."RWP_TZCRMKDM"n, workTableOut=etls_commands, inDSOptions=);
2689       
2690             %if &etls_otherTablesReferToThisTable %then
2691                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2691     ! constraints.;
2692             %else
2693             %do; /* okay - remove foreign keys  */
2694       
2695                data etls_commands_F;
2696                   set etls_commands;
2697                   if upcase(type)="FOREIGN KEY" then
2698                   do;
2699                      command='ic delete '||trim(name)||';';
2700                      output etls_commands_F;
2701                   end;
2702                run;
2703       
2704                %put %str(NOTE: Removing foreign keys before dropping table...);
2705                data _null_;
2706                   set etls_commands_F end=eof;
2707                   if _n_=1 then
2708                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMKDM"n;');
2709                   call execute(command);
2710                   if eof then call execute('; quit;');
2711                run;
2712                %rcSet(&syserr);
2713       
2714          %end; /* okay - remove foreign keys  */
2715       
2716          proc datasets lib = work nolist nowarn memtype = (data view);
2717             delete etls_commands etls_commands_F;
2718          quit;
2719       
2720          /*---- Drop a table  ----*/
2721          %put %str(NOTE: Dropping table ...);
2722          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
2723             delete "RWP_TZCRMKDM"n;
2724          quit;
2725       
2726          %rcSet(&syserr);
2727       
2728          %let etls_tableExist = 0;
2729       
2730       %end; /* table exists  */
2731       
2732       /*---- Create a new table  ----*/
2733       %if (&etls_tableExist eq 0) %then
2734       %do;  /* if table does not exist  */
2735       
2736          %put %str(NOTE: Creating table ...);
89                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2737       
2738          data PODSLIB1."RWP_TZCRMKDM"n
2739                  (COMPRESS = YES);
2740             attrib "_BIC_ZCRMKDM"n length = $2
2741                format = $2.;
2742             attrib "TXTSH"n length = $20
2743                format = $20.
2744                label = 'Short description';
2745             attrib "TXTMD"n length = $40
2746                format = $40.
2747                label = 'Medium description';
2748             call missing(of _all_);
2749             stop;
2750          run;
2751       
2752          %rcSet(&syserr);
2753       
2754       %end;  /* if table does not exist  */
2755       
2756       /*---- Append  ----*/
2757       %put %str(NOTE: Appending data ...);
2758       
2759       proc append base = PODSLIB1."RWP_TZCRMKDM"n(COMPRESS = YES)
2760          data = &etls_lastTable (&etls_tableOptions)  force ;
2761        run;
2762       
2763       %rcSet(&syserr);
2764       
2765       %mend etls_loader;
2766       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZCRMKDM"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZCRMKDM"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
90                                                         The SAS System                          09:30 Wednesday, December 2, 2020


MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMKDM"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

91                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZCRMKDM"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZCRMKDM (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZCRMKDM"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMKDM"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZCRMKDM has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZCRMKDM"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZCRMKDM'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZCRMKDM'n to PODSLIB1.RWP_TZCRMKDM.
NOTE: There were 1 observations read from the data set SAPRWP.'/BIC/TZCRMKDM'n.
NOTE: 1 observations added.
NOTE: The data set PODSLIB1.RWP_TZCRMKDM has 1 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZCRMKDM decreased size by 72.58 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.74 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
2767       
2768       %let etls_recCheckExist = 0;
2769       %let etls_recnt = 0;
92                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2770       %macro etls_recordCheck;
2771          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMKDM"n, DATA)) or
2772                %sysfunc(exist(PODSLIB1."RWP_TZCRMKDM"n, VIEW)));
2773       
2774          %if (&etls_recCheckExist) %then
2775          %do;
2776             %local etls_syntaxcheck;
2777             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2778             /* Turn off syntaxcheck option to perform following steps  */
2779             options nosyntaxcheck;
2780       
2781             proc contents data = PODSLIB1."RWP_TZCRMKDM"n out = work.etls_contents(keep = nobs) noprint;
2782             run;
2783       
2784             data _null_;
2785                set work.etls_contents (obs = 1);
2786                call symput("etls_recnt", left(put(nobs,32.)));
2787             run;
2788       
2789             proc datasets lib = work nolist nowarn memtype = (data view);
2790                delete etls_contents;
2791             quit;
2792       
2793             /* Reset syntaxcheck option to previous setting  */
2794             options &etls_syntaxcheck;
2795          %end;
2796       %mend etls_recordCheck;
2797       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZCRMKDM"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
93                                                         The SAS System                          09:30 Wednesday, December 2, 2020


MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2798       
2799       
2800       
2801       /** Step end Table Loader **/
2802       
2803       /*==========================================================================*
2804        * Step:            Table Loader                          A57BXQB4.BV00013B *
2805        * Transform:       Table Loader (Version 2.1)                              *
2806        * Description:                                                             *
2807        *                                                                          *
2808        * Source Table:    _BI0_TUCACC_CLAS - -                  A57BXQB4.BE0001TF *
2809        *                   SAPrwp."/BI0/TUCACC_CLAS"n                             *
2810        * Target Table:    RWP_TUCACC_CLAS -                     A57BXQB4.BE0001TG *
2811        *                   PODSLIB1."RWP_TUCACC_CLAS"n                            *
2812        *==========================================================================*/
2813       
2814       %let transformID = %quote(A57BXQB4.BV00013B);
2815       %let trans_rc = 0;
2816       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
2817       
2818       %let SYSLAST = %nrquote(SAPrwp."/BI0/TUCACC_CLAS"n);
2819       
2820       %global etls_sql_pushDown;
2821       %let etls_sql_pushDown = -1;
2822       option DBIDIRECTEXEC;
2823       
2824       %global etls_tableExist;
2825       %global etls_numIndex;
2826       %global etls_lastTable;
2827       %let etls_tableExist = -1;
2828       %let etls_numIndex = -1;
2829       %let etls_lastTable = &SYSLAST;
2830       
2831       /*---- Define load data macro  ----*/
2832       
2833       /* --------------------------------------------------------------
2834          Load Technique Selection: Replace - EntireTable
2835          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
2836          Additional options selections...
2837             Set unmapped to missing on updates: false
2838          -------------------------------------------------------------- */
2839       %macro etls_loader;
2840       
2841          %let etls_tableOptions = ;
2842       
2843          /* Determine if the target table exists  */
2844          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TUCACC_CLAS"n, DATA)) or
2845                %sysfunc(exist(PODSLIB1."RWP_TUCACC_CLAS"n, VIEW)));
2846       
2847          %if &etls_tableExist %then
2848          %do;/* table exists  */
2849             %let etls_hasPreExistingConstraint=0;
2850       
2851             proc datasets lib = work nolist nowarn memtype = (data view);
2852                delete etls_commands etls_commands_F;
2853             quit;
94                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2854       
2855             %let etls_otherTablesReferToThisTable=0;
2856       
2857             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
2858                %put NOTE: Building table listing Constraints and Indexes for: &table;
2859                proc datasets lib=work nolist; delete &workTableOut; quit;
2860                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
2861       
2862                data &workTableOut;
2863                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
2864                   name = '';
2865                   type = '';
2866                   icown = '';
2867                   idxUnique = '';
2868                   idxNoMiss = '';
2869                   recreate = '';
2870                   set &workTableOut;
2871                   ref = '';
2872                   type=upcase(type);
2873                   if type eq 'REFERENTIAL' then
2874                   do;
2875                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
2876                           " another table: " ref;
2877                      call symput('etls_otherTablesReferToThisTable','1');
2878                      delete;
2879                   end;
2880                   if type='INDEX' and ICOwn eq 'YES' then delete;
2881                run;
2882                %rcSet(&syserr);
2883       
2884             %mend etls_CIContents;
2885       
2886             %etls_CIContents(table=PODSLIB1."RWP_TUCACC_CLAS"n, workTableOut=etls_commands, inDSOptions=);
2887       
2888             %if &etls_otherTablesReferToThisTable %then
2889                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
2889     ! constraints.;
2890             %else
2891             %do; /* okay - remove foreign keys  */
2892       
2893                data etls_commands_F;
2894                   set etls_commands;
2895                   if upcase(type)="FOREIGN KEY" then
2896                   do;
2897                      command='ic delete '||trim(name)||';';
2898                      output etls_commands_F;
2899                   end;
2900                run;
2901       
2902                %put %str(NOTE: Removing foreign keys before dropping table...);
2903                data _null_;
2904                   set etls_commands_F end=eof;
2905                   if _n_=1 then
2906                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TUCACC_CLAS"n;');
2907                   call execute(command);
2908                   if eof then call execute('; quit;');
2909                run;
2910                %rcSet(&syserr);
95                                                         The SAS System                          09:30 Wednesday, December 2, 2020

2911       
2912          %end; /* okay - remove foreign keys  */
2913       
2914          proc datasets lib = work nolist nowarn memtype = (data view);
2915             delete etls_commands etls_commands_F;
2916          quit;
2917       
2918          /*---- Drop a table  ----*/
2919          %put %str(NOTE: Dropping table ...);
2920          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
2921             delete "RWP_TUCACC_CLAS"n;
2922          quit;
2923       
2924          %rcSet(&syserr);
2925       
2926          %let etls_tableExist = 0;
2927       
2928       %end; /* table exists  */
2929       
2930       /*---- Create a new table  ----*/
2931       %if (&etls_tableExist eq 0) %then
2932       %do;  /* if table does not exist  */
2933       
2934          %put %str(NOTE: Creating table ...);
2935       
2936          data PODSLIB1."RWP_TUCACC_CLAS"n
2937                  (COMPRESS = YES);
2938             attrib "UCACC_CLAS"n length = $4
2939                format = $4.
2940                label = 'Account Class';
2941             attrib "LANGU"n length = $1
2942                format = $1.
2943                label = 'Language Key';
2944             attrib "TXTLG"n length = $60
2945                format = $60.
2946                label = 'Long description';
2947             call missing(of _all_);
2948             stop;
2949          run;
2950       
2951          %rcSet(&syserr);
2952       
2953       %end;  /* if table does not exist  */
2954       
2955       /*---- Append  ----*/
2956       %put %str(NOTE: Appending data ...);
2957       
2958       proc append base = PODSLIB1."RWP_TUCACC_CLAS"n(COMPRESS = YES)
2959          data = &etls_lastTable (&etls_tableOptions)  force ;
2960        run;
2961       
2962       %rcSet(&syserr);
2963       
2964       %mend etls_loader;
2965       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;
96                                                         The SAS System                          09:30 Wednesday, December 2, 2020


NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TUCACC_CLAS"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TUCACC_CLAS"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
97                                                         The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TUCACC_CLAS"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TUCACC_CLAS"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TUCACC_CLAS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TUCACC_CLAS"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "UCACC_CLAS"n length = $4 format = $4. label = 'Account Class';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

98                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: The data set PODSLIB1.RWP_TUCACC_CLAS has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TUCACC_CLAS"n(COMPRESS = YES) data = SAPRWP.'/BI0/TUCACC_CLAS'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TUCACC_CLAS'n to PODSLIB1.RWP_TUCACC_CLAS.
NOTE: There were 15 observations read from the data set SAPRWP.'/BI0/TUCACC_CLAS'n.
NOTE: 15 observations added.
NOTE: The data set PODSLIB1.RWP_TUCACC_CLAS has 15 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TUCACC_CLAS decreased size by 64.00 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.82 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
2966       
2967       %let etls_recCheckExist = 0;
2968       %let etls_recnt = 0;
2969       %macro etls_recordCheck;
2970          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TUCACC_CLAS"n, DATA)) or
2971                %sysfunc(exist(PODSLIB1."RWP_TUCACC_CLAS"n, VIEW)));
2972       
2973          %if (&etls_recCheckExist) %then
2974          %do;
2975             %local etls_syntaxcheck;
2976             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
2977             /* Turn off syntaxcheck option to perform following steps  */
2978             options nosyntaxcheck;
2979       
2980             proc contents data = PODSLIB1."RWP_TUCACC_CLAS"n out = work.etls_contents(keep = nobs) noprint;
2981             run;
2982       
2983             data _null_;
2984                set work.etls_contents (obs = 1);
2985                call symput("etls_recnt", left(put(nobs,32.)));
2986             run;
2987       
2988             proc datasets lib = work nolist nowarn memtype = (data view);
2989                delete etls_contents;
2990             quit;
2991       
2992             /* Reset syntaxcheck option to previous setting  */
2993             options &etls_syntaxcheck;
2994          %end;
2995       %mend etls_recordCheck;
2996       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TUCACC_CLAS"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
99                                                         The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
2997       
2998       
2999       
3000       /** Step end Table Loader **/
3001       
3002       /*==========================================================================*
3003        * Step:            Table Loader                          A57BXQB4.BV00013C *
3004        * Transform:       Table Loader (Version 2.1)                              *
3005        * Description:                                                             *
3006        *                                                                          *
3007        * Source Table:    _BIC_TZBOLGE - -                      A57BXQB4.BE0001TH *
3008        *                   SAPrwp."/BIC/TZBOLGE"n                                 *
3009        * Target Table:    RWP_TZBOLGE - PODSLIB1."RWP_TZBOLGE"n A57BXQB4.BE0001TI *
3010        *==========================================================================*/
3011       
3012       %let transformID = %quote(A57BXQB4.BV00013C);
3013       %let trans_rc = 0;
3014       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
3015       
3016       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZBOLGE"n);
3017       
3018       %global etls_sql_pushDown;
3019       %let etls_sql_pushDown = -1;
3020       option DBIDIRECTEXEC;
3021       
3022       %global etls_tableExist;
3023       %global etls_numIndex;
3024       %global etls_lastTable;
3025       %let etls_tableExist = -1;
3026       %let etls_numIndex = -1;
3027       %let etls_lastTable = &SYSLAST;
100                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3028       
3029       /*---- Define load data macro  ----*/
3030       
3031       /* --------------------------------------------------------------
3032          Load Technique Selection: Replace - EntireTable
3033          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
3034          Additional options selections...
3035             Set unmapped to missing on updates: false
3036          -------------------------------------------------------------- */
3037       %macro etls_loader;
3038       
3039          %let etls_tableOptions = ;
3040       
3041          /* Determine if the target table exists  */
3042          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZBOLGE"n, DATA)) or
3043                %sysfunc(exist(PODSLIB1."RWP_TZBOLGE"n, VIEW)));
3044       
3045          %if &etls_tableExist %then
3046          %do;/* table exists  */
3047             %let etls_hasPreExistingConstraint=0;
3048       
3049             proc datasets lib = work nolist nowarn memtype = (data view);
3050                delete etls_commands etls_commands_F;
3051             quit;
3052       
3053             %let etls_otherTablesReferToThisTable=0;
3054       
3055             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
3056                %put NOTE: Building table listing Constraints and Indexes for: &table;
3057                proc datasets lib=work nolist; delete &workTableOut; quit;
3058                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
3059       
3060                data &workTableOut;
3061                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
3062                   name = '';
3063                   type = '';
3064                   icown = '';
3065                   idxUnique = '';
3066                   idxNoMiss = '';
3067                   recreate = '';
3068                   set &workTableOut;
3069                   ref = '';
3070                   type=upcase(type);
3071                   if type eq 'REFERENTIAL' then
3072                   do;
3073                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
3074                           " another table: " ref;
3075                      call symput('etls_otherTablesReferToThisTable','1');
3076                      delete;
3077                   end;
3078                   if type='INDEX' and ICOwn eq 'YES' then delete;
3079                run;
3080                %rcSet(&syserr);
3081       
3082             %mend etls_CIContents;
3083       
3084             %etls_CIContents(table=PODSLIB1."RWP_TZBOLGE"n, workTableOut=etls_commands, inDSOptions=);
3085       
101                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3086             %if &etls_otherTablesReferToThisTable %then
3087                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
3087     ! constraints.;
3088             %else
3089             %do; /* okay - remove foreign keys  */
3090       
3091                data etls_commands_F;
3092                   set etls_commands;
3093                   if upcase(type)="FOREIGN KEY" then
3094                   do;
3095                      command='ic delete '||trim(name)||';';
3096                      output etls_commands_F;
3097                   end;
3098                run;
3099       
3100                %put %str(NOTE: Removing foreign keys before dropping table...);
3101                data _null_;
3102                   set etls_commands_F end=eof;
3103                   if _n_=1 then
3104                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZBOLGE"n;');
3105                   call execute(command);
3106                   if eof then call execute('; quit;');
3107                run;
3108                %rcSet(&syserr);
3109       
3110          %end; /* okay - remove foreign keys  */
3111       
3112          proc datasets lib = work nolist nowarn memtype = (data view);
3113             delete etls_commands etls_commands_F;
3114          quit;
3115       
3116          /*---- Drop a table  ----*/
3117          %put %str(NOTE: Dropping table ...);
3118          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
3119             delete "RWP_TZBOLGE"n;
3120          quit;
3121       
3122          %rcSet(&syserr);
3123       
3124          %let etls_tableExist = 0;
3125       
3126       %end; /* table exists  */
3127       
3128       /*---- Create a new table  ----*/
3129       %if (&etls_tableExist eq 0) %then
3130       %do;  /* if table does not exist  */
3131       
3132          %put %str(NOTE: Creating table ...);
3133       
3134          data PODSLIB1."RWP_TZBOLGE"n
3135                  (COMPRESS = YES);
3136             attrib "_BIC_ZBOLGE"n length = $2
3137                format = $2.;
3138             attrib "LANGU"n length = $1
3139                format = $1.
3140                label = 'Language Key';
3141             attrib "TXTSH"n length = $20
3142                format = $20.
102                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3143                label = 'Short description';
3144             call missing(of _all_);
3145             stop;
3146          run;
3147       
3148          %rcSet(&syserr);
3149       
3150       %end;  /* if table does not exist  */
3151       
3152       /*---- Append  ----*/
3153       %put %str(NOTE: Appending data ...);
3154       
3155       proc append base = PODSLIB1."RWP_TZBOLGE"n(COMPRESS = YES)
3156          data = &etls_lastTable (&etls_tableOptions)  force ;
3157        run;
3158       
3159       %rcSet(&syserr);
3160       
3161       %mend etls_loader;
3162       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZBOLGE"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZBOLGE"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
103                                                        The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZBOLGE"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
104                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZBOLGE"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZBOLGE (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZBOLGE"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZBOLGE"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZBOLGE has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZBOLGE"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZBOLGE'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZBOLGE'n to PODSLIB1.RWP_TZBOLGE.
NOTE: There were 7 observations read from the data set SAPRWP.'/BIC/TZBOLGE'n.
NOTE: 7 observations added.
NOTE: The data set PODSLIB1.RWP_TZBOLGE has 7 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZBOLGE decreased size by 27.95 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.38 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
3163       
3164       %let etls_recCheckExist = 0;
3165       %let etls_recnt = 0;
3166       %macro etls_recordCheck;
3167          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZBOLGE"n, DATA)) or
3168                %sysfunc(exist(PODSLIB1."RWP_TZBOLGE"n, VIEW)));
3169       
3170          %if (&etls_recCheckExist) %then
3171          %do;
3172             %local etls_syntaxcheck;
3173             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
3174             /* Turn off syntaxcheck option to perform following steps  */
3175             options nosyntaxcheck;
105                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3176       
3177             proc contents data = PODSLIB1."RWP_TZBOLGE"n out = work.etls_contents(keep = nobs) noprint;
3178             run;
3179       
3180             data _null_;
3181                set work.etls_contents (obs = 1);
3182                call symput("etls_recnt", left(put(nobs,32.)));
3183             run;
3184       
3185             proc datasets lib = work nolist nowarn memtype = (data view);
3186                delete etls_contents;
3187             quit;
3188       
3189             /* Reset syntaxcheck option to previous setting  */
3190             options &etls_syntaxcheck;
3191          %end;
3192       %mend etls_recordCheck;
3193       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZBOLGE"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
3194       
3195       
3196       
3197       /** Step end Table Loader **/
3198       
3199       /*==========================================================================*
3200        * Step:            Table Loader                          A57BXQB4.BV00013D *
3201        * Transform:       Table Loader (Version 2.1)                              *
106                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3202        * Description:                                                             *
3203        *                                                                          *
3204        * Source Table:    _BIC_TZCRMFS - -                      A57BXQB4.BE0001TJ *
3205        *                   SAPrwp."/BIC/TZCRMFS"n                                 *
3206        * Target Table:    RWP_TZCRMFS - PODSLIB1."RWP_TZCRMFS"n A57BXQB4.BE0001TK *
3207        *==========================================================================*/
3208       
3209       %let transformID = %quote(A57BXQB4.BV00013D);
3210       %let trans_rc = 0;
3211       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
3212       
3213       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZCRMFS"n);
3214       
3215       %global etls_sql_pushDown;
3216       %let etls_sql_pushDown = -1;
3217       option DBIDIRECTEXEC;
3218       
3219       %global etls_tableExist;
3220       %global etls_numIndex;
3221       %global etls_lastTable;
3222       %let etls_tableExist = -1;
3223       %let etls_numIndex = -1;
3224       %let etls_lastTable = &SYSLAST;
3225       
3226       /*---- Define load data macro  ----*/
3227       
3228       /* --------------------------------------------------------------
3229          Load Technique Selection: Replace - EntireTable
3230          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
3231          Additional options selections...
3232             Set unmapped to missing on updates: false
3233          -------------------------------------------------------------- */
3234       %macro etls_loader;
3235       
3236          %let etls_tableOptions = ;
3237       
3238          /* Determine if the target table exists  */
3239          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMFS"n, DATA)) or
3240                %sysfunc(exist(PODSLIB1."RWP_TZCRMFS"n, VIEW)));
3241       
3242          %if &etls_tableExist %then
3243          %do;/* table exists  */
3244             %let etls_hasPreExistingConstraint=0;
3245       
3246             proc datasets lib = work nolist nowarn memtype = (data view);
3247                delete etls_commands etls_commands_F;
3248             quit;
3249       
3250             %let etls_otherTablesReferToThisTable=0;
3251       
3252             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
3253                %put NOTE: Building table listing Constraints and Indexes for: &table;
3254                proc datasets lib=work nolist; delete &workTableOut; quit;
3255                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
3256       
3257                data &workTableOut;
3258                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
3259                   name = '';
107                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3260                   type = '';
3261                   icown = '';
3262                   idxUnique = '';
3263                   idxNoMiss = '';
3264                   recreate = '';
3265                   set &workTableOut;
3266                   ref = '';
3267                   type=upcase(type);
3268                   if type eq 'REFERENTIAL' then
3269                   do;
3270                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
3271                           " another table: " ref;
3272                      call symput('etls_otherTablesReferToThisTable','1');
3273                      delete;
3274                   end;
3275                   if type='INDEX' and ICOwn eq 'YES' then delete;
3276                run;
3277                %rcSet(&syserr);
3278       
3279             %mend etls_CIContents;
3280       
3281             %etls_CIContents(table=PODSLIB1."RWP_TZCRMFS"n, workTableOut=etls_commands, inDSOptions=);
3282       
3283             %if &etls_otherTablesReferToThisTable %then
3284                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
3284     ! constraints.;
3285             %else
3286             %do; /* okay - remove foreign keys  */
3287       
3288                data etls_commands_F;
3289                   set etls_commands;
3290                   if upcase(type)="FOREIGN KEY" then
3291                   do;
3292                      command='ic delete '||trim(name)||';';
3293                      output etls_commands_F;
3294                   end;
3295                run;
3296       
3297                %put %str(NOTE: Removing foreign keys before dropping table...);
3298                data _null_;
3299                   set etls_commands_F end=eof;
3300                   if _n_=1 then
3301                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMFS"n;');
3302                   call execute(command);
3303                   if eof then call execute('; quit;');
3304                run;
3305                %rcSet(&syserr);
3306       
3307          %end; /* okay - remove foreign keys  */
3308       
3309          proc datasets lib = work nolist nowarn memtype = (data view);
3310             delete etls_commands etls_commands_F;
3311          quit;
3312       
3313          /*---- Drop a table  ----*/
3314          %put %str(NOTE: Dropping table ...);
3315          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
3316             delete "RWP_TZCRMFS"n;
108                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3317          quit;
3318       
3319          %rcSet(&syserr);
3320       
3321          %let etls_tableExist = 0;
3322       
3323       %end; /* table exists  */
3324       
3325       /*---- Create a new table  ----*/
3326       %if (&etls_tableExist eq 0) %then
3327       %do;  /* if table does not exist  */
3328       
3329          %put %str(NOTE: Creating table ...);
3330       
3331          data PODSLIB1."RWP_TZCRMFS"n
3332                  (COMPRESS = YES);
3333             attrib "_BIC_ZCRMFS"n length = $2
3334                format = $2.;
3335             attrib "TXTSH"n length = $20
3336                format = $20.
3337                label = 'Short description';
3338             attrib "TXTMD"n length = $40
3339                format = $40.
3340                label = 'Medium description';
3341             call missing(of _all_);
3342             stop;
3343          run;
3344       
3345          %rcSet(&syserr);
3346       
3347       %end;  /* if table does not exist  */
3348       
3349       /*---- Append  ----*/
3350       %put %str(NOTE: Appending data ...);
3351       
3352       proc append base = PODSLIB1."RWP_TZCRMFS"n(COMPRESS = YES)
3353          data = &etls_lastTable (&etls_tableOptions)  force ;
3354        run;
3355       
3356       %rcSet(&syserr);
3357       
3358       %mend etls_loader;
3359       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZCRMFS"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
109                                                        The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZCRMFS"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
110                                                        The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMFS"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZCRMFS"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZCRMFS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.09 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZCRMFS"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMFS"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZCRMFS has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZCRMFS"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZCRMFS'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZCRMFS'n to PODSLIB1.RWP_TZCRMFS.
111                                                        The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: There were 2 observations read from the data set SAPRWP.'/BIC/TZCRMFS'n.
NOTE: 2 observations added.
NOTE: The data set PODSLIB1.RWP_TZCRMFS has 2 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZCRMFS decreased size by 62.90 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.75 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
3360       
3361       %let etls_recCheckExist = 0;
3362       %let etls_recnt = 0;
3363       %macro etls_recordCheck;
3364          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMFS"n, DATA)) or
3365                %sysfunc(exist(PODSLIB1."RWP_TZCRMFS"n, VIEW)));
3366       
3367          %if (&etls_recCheckExist) %then
3368          %do;
3369             %local etls_syntaxcheck;
3370             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
3371             /* Turn off syntaxcheck option to perform following steps  */
3372             options nosyntaxcheck;
3373       
3374             proc contents data = PODSLIB1."RWP_TZCRMFS"n out = work.etls_contents(keep = nobs) noprint;
3375             run;
3376       
3377             data _null_;
3378                set work.etls_contents (obs = 1);
3379                call symput("etls_recnt", left(put(nobs,32.)));
3380             run;
3381       
3382             proc datasets lib = work nolist nowarn memtype = (data view);
3383                delete etls_contents;
3384             quit;
3385       
3386             /* Reset syntaxcheck option to previous setting  */
3387             options &etls_syntaxcheck;
3388          %end;
3389       %mend etls_recordCheck;
3390       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZCRMFS"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
112                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
3391       
3392       
3393       
3394       /** Step end Table Loader **/
3395       
3396       /*==========================================================================*
3397        * Step:            Table Loader                          A57BXQB4.BV00013E *
3398        * Transform:       Table Loader (Version 2.1)                              *
3399        * Description:                                                             *
3400        *                                                                          *
3401        * Source Table:    _BIC_TZSWSTATUS - -                   A57BXQB4.BE0001TL *
3402        *                   SAPrwp."/BIC/TZSWSTATUS"n                              *
3403        * Target Table:    RWP_TZSWSTATUS -                      A57BXQB4.BE0001TM *
3404        *                   PODSLIB1."RWP_TZSWSTATUS"n                             *
3405        *==========================================================================*/
3406       
3407       %let transformID = %quote(A57BXQB4.BV00013E);
3408       %let trans_rc = 0;
3409       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
3410       
3411       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZSWSTATUS"n);
3412       
3413       %global etls_sql_pushDown;
3414       %let etls_sql_pushDown = -1;
3415       option DBIDIRECTEXEC;
3416       
3417       %global etls_tableExist;
3418       %global etls_numIndex;
3419       %global etls_lastTable;
3420       %let etls_tableExist = -1;
3421       %let etls_numIndex = -1;
3422       %let etls_lastTable = &SYSLAST;
3423       
3424       /*---- Define load data macro  ----*/
3425       
3426       /* --------------------------------------------------------------
3427          Load Technique Selection: Replace - EntireTable
3428          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
3429          Additional options selections...
3430             Set unmapped to missing on updates: false
3431          -------------------------------------------------------------- */
3432       %macro etls_loader;
3433       
113                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3434          %let etls_tableOptions = ;
3435       
3436          /* Determine if the target table exists  */
3437          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZSWSTATUS"n, DATA)) or
3438                %sysfunc(exist(PODSLIB1."RWP_TZSWSTATUS"n, VIEW)));
3439       
3440          %if &etls_tableExist %then
3441          %do;/* table exists  */
3442             %let etls_hasPreExistingConstraint=0;
3443       
3444             proc datasets lib = work nolist nowarn memtype = (data view);
3445                delete etls_commands etls_commands_F;
3446             quit;
3447       
3448             %let etls_otherTablesReferToThisTable=0;
3449       
3450             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
3451                %put NOTE: Building table listing Constraints and Indexes for: &table;
3452                proc datasets lib=work nolist; delete &workTableOut; quit;
3453                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
3454       
3455                data &workTableOut;
3456                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
3457                   name = '';
3458                   type = '';
3459                   icown = '';
3460                   idxUnique = '';
3461                   idxNoMiss = '';
3462                   recreate = '';
3463                   set &workTableOut;
3464                   ref = '';
3465                   type=upcase(type);
3466                   if type eq 'REFERENTIAL' then
3467                   do;
3468                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
3469                           " another table: " ref;
3470                      call symput('etls_otherTablesReferToThisTable','1');
3471                      delete;
3472                   end;
3473                   if type='INDEX' and ICOwn eq 'YES' then delete;
3474                run;
3475                %rcSet(&syserr);
3476       
3477             %mend etls_CIContents;
3478       
3479             %etls_CIContents(table=PODSLIB1."RWP_TZSWSTATUS"n, workTableOut=etls_commands, inDSOptions=);
3480       
3481             %if &etls_otherTablesReferToThisTable %then
3482                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
3482     ! constraints.;
3483             %else
3484             %do; /* okay - remove foreign keys  */
3485       
3486                data etls_commands_F;
3487                   set etls_commands;
3488                   if upcase(type)="FOREIGN KEY" then
3489                   do;
3490                      command='ic delete '||trim(name)||';';
114                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3491                      output etls_commands_F;
3492                   end;
3493                run;
3494       
3495                %put %str(NOTE: Removing foreign keys before dropping table...);
3496                data _null_;
3497                   set etls_commands_F end=eof;
3498                   if _n_=1 then
3499                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZSWSTATUS"n;');
3500                   call execute(command);
3501                   if eof then call execute('; quit;');
3502                run;
3503                %rcSet(&syserr);
3504       
3505          %end; /* okay - remove foreign keys  */
3506       
3507          proc datasets lib = work nolist nowarn memtype = (data view);
3508             delete etls_commands etls_commands_F;
3509          quit;
3510       
3511          /*---- Drop a table  ----*/
3512          %put %str(NOTE: Dropping table ...);
3513          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
3514             delete "RWP_TZSWSTATUS"n;
3515          quit;
3516       
3517          %rcSet(&syserr);
3518       
3519          %let etls_tableExist = 0;
3520       
3521       %end; /* table exists  */
3522       
3523       /*---- Create a new table  ----*/
3524       %if (&etls_tableExist eq 0) %then
3525       %do;  /* if table does not exist  */
3526       
3527          %put %str(NOTE: Creating table ...);
3528       
3529          data PODSLIB1."RWP_TZSWSTATUS"n
3530                  (COMPRESS = YES);
3531             attrib "_BIC_ZSWSTATUS"n length = $2
3532                format = $2.
3533                label = 'Swdoc status';
3534             attrib "LANGU"n length = $1
3535                format = $1.
3536                label = 'Language Key';
3537             attrib "TXTSH"n length = $20
3538                format = $20.
3539                label = 'Short description';
3540             call missing(of _all_);
3541             stop;
3542          run;
3543       
3544          %rcSet(&syserr);
3545       
3546       %end;  /* if table does not exist  */
3547       
3548       /*---- Append  ----*/
115                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3549       %put %str(NOTE: Appending data ...);
3550       
3551       proc append base = PODSLIB1."RWP_TZSWSTATUS"n(COMPRESS = YES)
3552          data = &etls_lastTable (&etls_tableOptions)  force ;
3553        run;
3554       
3555       %rcSet(&syserr);
3556       
3557       %mend etls_loader;
3558       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZSWSTATUS"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZSWSTATUS"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

116                                                        The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZSWSTATUS"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZSWSTATUS"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZSWSTATUS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
117                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZSWSTATUS"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZSWSTATUS"n length = $2 format = $2. label = 'Swdoc status';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZSWSTATUS has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZSWSTATUS"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZSWSTATUS'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZSWSTATUS'n to PODSLIB1.RWP_TZSWSTATUS.
NOTE: There were 22 observations read from the data set SAPRWP.'/BIC/TZSWSTATUS'n.
NOTE: 22 observations added.
NOTE: The data set PODSLIB1.RWP_TZSWSTATUS has 22 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZSWSTATUS decreased size by 37.15 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.59 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
3559       
3560       %let etls_recCheckExist = 0;
3561       %let etls_recnt = 0;
3562       %macro etls_recordCheck;
3563          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZSWSTATUS"n, DATA)) or
3564                %sysfunc(exist(PODSLIB1."RWP_TZSWSTATUS"n, VIEW)));
3565       
3566          %if (&etls_recCheckExist) %then
3567          %do;
3568             %local etls_syntaxcheck;
3569             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
3570             /* Turn off syntaxcheck option to perform following steps  */
3571             options nosyntaxcheck;
3572       
3573             proc contents data = PODSLIB1."RWP_TZSWSTATUS"n out = work.etls_contents(keep = nobs) noprint;
3574             run;
3575       
3576             data _null_;
3577                set work.etls_contents (obs = 1);
3578                call symput("etls_recnt", left(put(nobs,32.)));
3579             run;
3580       
3581             proc datasets lib = work nolist nowarn memtype = (data view);
118                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3582                delete etls_contents;
3583             quit;
3584       
3585             /* Reset syntaxcheck option to previous setting  */
3586             options &etls_syntaxcheck;
3587          %end;
3588       %mend etls_recordCheck;
3589       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZSWSTATUS"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
3590       
3591       
3592       
3593       /** Step end Table Loader **/
3594       
3595       /*==========================================================================*
3596        * Step:            Table Loader                          A57BXQB4.BV00013F *
3597        * Transform:       Table Loader (Version 2.1)                              *
3598        * Description:                                                             *
3599        *                                                                          *
3600        * Source Table:    _BIC_TZTKTMCSD - -                    A57BXQB4.BE0001TN *
3601        *                   SAPrwp."/BIC/TZTKTMCSD"n                               *
3602        * Target Table:    RWP_TZTKTMCSD -                       A57BXQB4.BE0001TO *
3603        *                   PODSLIB1."RWP_TZTKTMCSD"n                              *
3604        *==========================================================================*/
3605       
3606       %let transformID = %quote(A57BXQB4.BV00013F);
3607       %let trans_rc = 0;
119                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3608       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
3609       
3610       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZTKTMCSD"n);
3611       
3612       %global etls_sql_pushDown;
3613       %let etls_sql_pushDown = -1;
3614       option DBIDIRECTEXEC;
3615       
3616       %global etls_tableExist;
3617       %global etls_numIndex;
3618       %global etls_lastTable;
3619       %let etls_tableExist = -1;
3620       %let etls_numIndex = -1;
3621       %let etls_lastTable = &SYSLAST;
3622       
3623       /*---- Define load data macro  ----*/
3624       
3625       /* --------------------------------------------------------------
3626          Load Technique Selection: Replace - EntireTable
3627          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
3628          Additional options selections...
3629             Set unmapped to missing on updates: false
3630          -------------------------------------------------------------- */
3631       %macro etls_loader;
3632       
3633          %let etls_tableOptions = ;
3634       
3635          /* Determine if the target table exists  */
3636          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZTKTMCSD"n, DATA)) or
3637                %sysfunc(exist(PODSLIB1."RWP_TZTKTMCSD"n, VIEW)));
3638       
3639          %if &etls_tableExist %then
3640          %do;/* table exists  */
3641             %let etls_hasPreExistingConstraint=0;
3642       
3643             proc datasets lib = work nolist nowarn memtype = (data view);
3644                delete etls_commands etls_commands_F;
3645             quit;
3646       
3647             %let etls_otherTablesReferToThisTable=0;
3648       
3649             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
3650                %put NOTE: Building table listing Constraints and Indexes for: &table;
3651                proc datasets lib=work nolist; delete &workTableOut; quit;
3652                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
3653       
3654                data &workTableOut;
3655                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
3656                   name = '';
3657                   type = '';
3658                   icown = '';
3659                   idxUnique = '';
3660                   idxNoMiss = '';
3661                   recreate = '';
3662                   set &workTableOut;
3663                   ref = '';
3664                   type=upcase(type);
3665                   if type eq 'REFERENTIAL' then
120                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3666                   do;
3667                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
3668                           " another table: " ref;
3669                      call symput('etls_otherTablesReferToThisTable','1');
3670                      delete;
3671                   end;
3672                   if type='INDEX' and ICOwn eq 'YES' then delete;
3673                run;
3674                %rcSet(&syserr);
3675       
3676             %mend etls_CIContents;
3677       
3678             %etls_CIContents(table=PODSLIB1."RWP_TZTKTMCSD"n, workTableOut=etls_commands, inDSOptions=);
3679       
3680             %if &etls_otherTablesReferToThisTable %then
3681                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
3681     ! constraints.;
3682             %else
3683             %do; /* okay - remove foreign keys  */
3684       
3685                data etls_commands_F;
3686                   set etls_commands;
3687                   if upcase(type)="FOREIGN KEY" then
3688                   do;
3689                      command='ic delete '||trim(name)||';';
3690                      output etls_commands_F;
3691                   end;
3692                run;
3693       
3694                %put %str(NOTE: Removing foreign keys before dropping table...);
3695                data _null_;
3696                   set etls_commands_F end=eof;
3697                   if _n_=1 then
3698                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZTKTMCSD"n;');
3699                   call execute(command);
3700                   if eof then call execute('; quit;');
3701                run;
3702                %rcSet(&syserr);
3703       
3704          %end; /* okay - remove foreign keys  */
3705       
3706          proc datasets lib = work nolist nowarn memtype = (data view);
3707             delete etls_commands etls_commands_F;
3708          quit;
3709       
3710          /*---- Drop a table  ----*/
3711          %put %str(NOTE: Dropping table ...);
3712          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
3713             delete "RWP_TZTKTMCSD"n;
3714          quit;
3715       
3716          %rcSet(&syserr);
3717       
3718          %let etls_tableExist = 0;
3719       
3720       %end; /* table exists  */
3721       
3722       /*---- Create a new table  ----*/
121                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3723       %if (&etls_tableExist eq 0) %then
3724       %do;  /* if table does not exist  */
3725       
3726          %put %str(NOTE: Creating table ...);
3727       
3728          data PODSLIB1."RWP_TZTKTMCSD"n
3729                  (COMPRESS = YES);
3730             attrib "_BIC_ZTKTMCSD"n length = $40
3731                format = $40.;
3732             attrib "TXTSH"n length = $20
3733                format = $20.
3734                label = 'Short description';
3735             attrib "TXTLG"n length = $60
3736                format = $60.
3737                label = 'Long description';
3738             call missing(of _all_);
3739             stop;
3740          run;
3741       
3742          %rcSet(&syserr);
3743       
3744       %end;  /* if table does not exist  */
3745       
3746       /*---- Append  ----*/
3747       %put %str(NOTE: Appending data ...);
3748       
3749       proc append base = PODSLIB1."RWP_TZTKTMCSD"n(COMPRESS = YES)
3750          data = &etls_lastTable (&etls_tableOptions)  force ;
3751        run;
3752       
3753       %rcSet(&syserr);
3754       
3755       %mend etls_loader;
3756       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZTKTMCSD"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZTKTMCSD"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
122                                                        The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZTKTMCSD"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
123                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZTKTMCSD"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZTKTMCSD (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZTKTMCSD"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZTKTMCSD"n length = $40 format = $40.;
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZTKTMCSD has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZTKTMCSD"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZTKTMCSD'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZTKTMCSD'n to PODSLIB1.RWP_TZTKTMCSD.
NOTE: There were 0 observations read from the data set SAPRWP.'/BIC/TZTKTMCSD'n.
NOTE: 0 observations added.
NOTE: The data set PODSLIB1.RWP_TZTKTMCSD has 0 observations and 3 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.83 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
124                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3757       
3758       %let etls_recCheckExist = 0;
3759       %let etls_recnt = 0;
3760       %macro etls_recordCheck;
3761          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZTKTMCSD"n, DATA)) or
3762                %sysfunc(exist(PODSLIB1."RWP_TZTKTMCSD"n, VIEW)));
3763       
3764          %if (&etls_recCheckExist) %then
3765          %do;
3766             %local etls_syntaxcheck;
3767             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
3768             /* Turn off syntaxcheck option to perform following steps  */
3769             options nosyntaxcheck;
3770       
3771             proc contents data = PODSLIB1."RWP_TZTKTMCSD"n out = work.etls_contents(keep = nobs) noprint;
3772             run;
3773       
3774             data _null_;
3775                set work.etls_contents (obs = 1);
3776                call symput("etls_recnt", left(put(nobs,32.)));
3777             run;
3778       
3779             proc datasets lib = work nolist nowarn memtype = (data view);
3780                delete etls_contents;
3781             quit;
3782       
3783             /* Reset syntaxcheck option to previous setting  */
3784             options &etls_syntaxcheck;
3785          %end;
3786       %mend etls_recordCheck;
3787       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZTKTMCSD"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
125                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
3788       
3789       
3790       
3791       /** Step end Table Loader **/
3792       
3793       /*==========================================================================*
3794        * Step:            Table Loader                          A57BXQB4.BV00013G *
3795        * Transform:       Table Loader (Version 2.1)                              *
3796        * Description:                                                             *
3797        *                                                                          *
3798        * Source Table:    _BIC_TZCRMFT - -                      A57BXQB4.BE0001TP *
3799        *                   SAPrwp."/BIC/TZCRMFT"n                                 *
3800        * Target Table:    RWP_TZCRMFT - PODSLIB1."RWP_TZCRMFT"n A57BXQB4.BE0001TQ *
3801        *==========================================================================*/
3802       
3803       %let transformID = %quote(A57BXQB4.BV00013G);
3804       %let trans_rc = 0;
3805       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
3806       
3807       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZCRMFT"n);
3808       
3809       %global etls_sql_pushDown;
3810       %let etls_sql_pushDown = -1;
3811       option DBIDIRECTEXEC;
3812       
3813       %global etls_tableExist;
3814       %global etls_numIndex;
3815       %global etls_lastTable;
3816       %let etls_tableExist = -1;
3817       %let etls_numIndex = -1;
3818       %let etls_lastTable = &SYSLAST;
3819       
3820       /*---- Define load data macro  ----*/
3821       
3822       /* --------------------------------------------------------------
3823          Load Technique Selection: Replace - EntireTable
3824          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
3825          Additional options selections...
3826             Set unmapped to missing on updates: false
3827          -------------------------------------------------------------- */
3828       %macro etls_loader;
3829       
3830          %let etls_tableOptions = ;
3831       
3832          /* Determine if the target table exists  */
3833          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMFT"n, DATA)) or
3834                %sysfunc(exist(PODSLIB1."RWP_TZCRMFT"n, VIEW)));
3835       
3836          %if &etls_tableExist %then
3837          %do;/* table exists  */
3838             %let etls_hasPreExistingConstraint=0;
3839       
3840             proc datasets lib = work nolist nowarn memtype = (data view);
126                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3841                delete etls_commands etls_commands_F;
3842             quit;
3843       
3844             %let etls_otherTablesReferToThisTable=0;
3845       
3846             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
3847                %put NOTE: Building table listing Constraints and Indexes for: &table;
3848                proc datasets lib=work nolist; delete &workTableOut; quit;
3849                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
3850       
3851                data &workTableOut;
3852                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
3853                   name = '';
3854                   type = '';
3855                   icown = '';
3856                   idxUnique = '';
3857                   idxNoMiss = '';
3858                   recreate = '';
3859                   set &workTableOut;
3860                   ref = '';
3861                   type=upcase(type);
3862                   if type eq 'REFERENTIAL' then
3863                   do;
3864                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
3865                           " another table: " ref;
3866                      call symput('etls_otherTablesReferToThisTable','1');
3867                      delete;
3868                   end;
3869                   if type='INDEX' and ICOwn eq 'YES' then delete;
3870                run;
3871                %rcSet(&syserr);
3872       
3873             %mend etls_CIContents;
3874       
3875             %etls_CIContents(table=PODSLIB1."RWP_TZCRMFT"n, workTableOut=etls_commands, inDSOptions=);
3876       
3877             %if &etls_otherTablesReferToThisTable %then
3878                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
3878     ! constraints.;
3879             %else
3880             %do; /* okay - remove foreign keys  */
3881       
3882                data etls_commands_F;
3883                   set etls_commands;
3884                   if upcase(type)="FOREIGN KEY" then
3885                   do;
3886                      command='ic delete '||trim(name)||';';
3887                      output etls_commands_F;
3888                   end;
3889                run;
3890       
3891                %put %str(NOTE: Removing foreign keys before dropping table...);
3892                data _null_;
3893                   set etls_commands_F end=eof;
3894                   if _n_=1 then
3895                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMFT"n;');
3896                   call execute(command);
3897                   if eof then call execute('; quit;');
127                                                        The SAS System                          09:30 Wednesday, December 2, 2020

3898                run;
3899                %rcSet(&syserr);
3900       
3901          %end; /* okay - remove foreign keys  */
3902       
3903          proc datasets lib = work nolist nowarn memtype = (data view);
3904             delete etls_commands etls_commands_F;
3905          quit;
3906       
3907          /*---- Drop a table  ----*/
3908          %put %str(NOTE: Dropping table ...);
3909          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
3910             delete "RWP_TZCRMFT"n;
3911          quit;
3912       
3913          %rcSet(&syserr);
3914       
3915          %let etls_tableExist = 0;
3916       
3917       %end; /* table exists  */
3918       
3919       /*---- Create a new table  ----*/
3920       %if (&etls_tableExist eq 0) %then
3921       %do;  /* if table does not exist  */
3922       
3923          %put %str(NOTE: Creating table ...);
3924       
3925          data PODSLIB1."RWP_TZCRMFT"n
3926                  (COMPRESS = YES);
3927             attrib "_BIC_ZCRMFT"n length = $2
3928                format = $2.;
3929             attrib "TXTSH"n length = $20
3930                format = $20.
3931                label = 'Short description';
3932             attrib "TXTMD"n length = $40
3933                format = $40.
3934                label = 'Medium description';
3935             call missing(of _all_);
3936             stop;
3937          run;
3938       
3939          %rcSet(&syserr);
3940       
3941       %end;  /* if table does not exist  */
3942       
3943       /*---- Append  ----*/
3944       %put %str(NOTE: Appending data ...);
3945       
3946       proc append base = PODSLIB1."RWP_TZCRMFT"n(COMPRESS = YES)
3947          data = &etls_lastTable (&etls_tableOptions)  force ;
3948        run;
3949       
3950       %rcSet(&syserr);
3951       
3952       %mend etls_loader;
3953       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
128                                                        The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZCRMFT"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZCRMFT"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
129                                                        The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZCRMFT"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZCRMFT"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZCRMFT (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZCRMFT"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "_BIC_ZCRMFT"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;
130                                                        The SAS System                          09:30 Wednesday, December 2, 2020


NOTE: The data set PODSLIB1.RWP_TZCRMFT has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZCRMFT"n(COMPRESS = YES) data = SAPRWP.'/BIC/TZCRMFT'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BIC/TZCRMFT'n to PODSLIB1.RWP_TZCRMFT.
NOTE: There were 2 observations read from the data set SAPRWP.'/BIC/TZCRMFT'n.
NOTE: 2 observations added.
NOTE: The data set PODSLIB1.RWP_TZCRMFT has 2 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZCRMFT decreased size by 33.06 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.99 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
3954       
3955       %let etls_recCheckExist = 0;
3956       %let etls_recnt = 0;
3957       %macro etls_recordCheck;
3958          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZCRMFT"n, DATA)) or
3959                %sysfunc(exist(PODSLIB1."RWP_TZCRMFT"n, VIEW)));
3960       
3961          %if (&etls_recCheckExist) %then
3962          %do;
3963             %local etls_syntaxcheck;
3964             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
3965             /* Turn off syntaxcheck option to perform following steps  */
3966             options nosyntaxcheck;
3967       
3968             proc contents data = PODSLIB1."RWP_TZCRMFT"n out = work.etls_contents(keep = nobs) noprint;
3969             run;
3970       
3971             data _null_;
3972                set work.etls_contents (obs = 1);
3973                call symput("etls_recnt", left(put(nobs,32.)));
3974             run;
3975       
3976             proc datasets lib = work nolist nowarn memtype = (data view);
3977                delete etls_contents;
3978             quit;
3979       
3980             /* Reset syntaxcheck option to previous setting  */
3981             options &etls_syntaxcheck;
3982          %end;
3983       %mend etls_recordCheck;
3984       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZCRMFT"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

131                                                        The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
3985       
3986       
3987       
3988       /** Step end Table Loader **/
3989       
3990       /*==========================================================================*
3991        * Step:            Table Loader                          A57BXQB4.BV00013H *
3992        * Transform:       Table Loader (Version 2.1)                              *
3993        * Description:                                                             *
3994        *                                                                          *
3995        * Source Table:    _BI0_TFCACTDETID - -                  A57BXQB4.BE0001TR *
3996        *                   SAPrwp."/BI0/TFCACTDETID"n                             *
3997        * Target Table:    RWP_TFCACTDETID -                     A57BXQB4.BE0001TS *
3998        *                   PODSLIB1."RWP_TFCACTDETID"n                            *
3999        *==========================================================================*/
4000       
4001       %let transformID = %quote(A57BXQB4.BV00013H);
4002       %let trans_rc = 0;
4003       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
4004       
4005       %let SYSLAST = %nrquote(SAPrwp."/BI0/TFCACTDETID"n);
4006       
4007       %global etls_sql_pushDown;
4008       %let etls_sql_pushDown = -1;
4009       option DBIDIRECTEXEC;
4010       
4011       %global etls_tableExist;
4012       %global etls_numIndex;
4013       %global etls_lastTable;
4014       %let etls_tableExist = -1;
132                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4015       %let etls_numIndex = -1;
4016       %let etls_lastTable = &SYSLAST;
4017       
4018       /*---- Define load data macro  ----*/
4019       
4020       /* --------------------------------------------------------------
4021          Load Technique Selection: Replace - EntireTable
4022          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
4023          Additional options selections...
4024             Set unmapped to missing on updates: false
4025          -------------------------------------------------------------- */
4026       %macro etls_loader;
4027       
4028          %let etls_tableOptions = ;
4029       
4030          /* Determine if the target table exists  */
4031          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TFCACTDETID"n, DATA)) or
4032                %sysfunc(exist(PODSLIB1."RWP_TFCACTDETID"n, VIEW)));
4033       
4034          %if &etls_tableExist %then
4035          %do;/* table exists  */
4036             %let etls_hasPreExistingConstraint=0;
4037       
4038             proc datasets lib = work nolist nowarn memtype = (data view);
4039                delete etls_commands etls_commands_F;
4040             quit;
4041       
4042             %let etls_otherTablesReferToThisTable=0;
4043       
4044             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
4045                %put NOTE: Building table listing Constraints and Indexes for: &table;
4046                proc datasets lib=work nolist; delete &workTableOut; quit;
4047                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
4048       
4049                data &workTableOut;
4050                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
4051                   name = '';
4052                   type = '';
4053                   icown = '';
4054                   idxUnique = '';
4055                   idxNoMiss = '';
4056                   recreate = '';
4057                   set &workTableOut;
4058                   ref = '';
4059                   type=upcase(type);
4060                   if type eq 'REFERENTIAL' then
4061                   do;
4062                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
4063                           " another table: " ref;
4064                      call symput('etls_otherTablesReferToThisTable','1');
4065                      delete;
4066                   end;
4067                   if type='INDEX' and ICOwn eq 'YES' then delete;
4068                run;
4069                %rcSet(&syserr);
4070       
4071             %mend etls_CIContents;
4072       
133                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4073             %etls_CIContents(table=PODSLIB1."RWP_TFCACTDETID"n, workTableOut=etls_commands, inDSOptions=);
4074       
4075             %if &etls_otherTablesReferToThisTable %then
4076                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
4076     ! constraints.;
4077             %else
4078             %do; /* okay - remove foreign keys  */
4079       
4080                data etls_commands_F;
4081                   set etls_commands;
4082                   if upcase(type)="FOREIGN KEY" then
4083                   do;
4084                      command='ic delete '||trim(name)||';';
4085                      output etls_commands_F;
4086                   end;
4087                run;
4088       
4089                %put %str(NOTE: Removing foreign keys before dropping table...);
4090                data _null_;
4091                   set etls_commands_F end=eof;
4092                   if _n_=1 then
4093                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TFCACTDETID"n;');
4094                   call execute(command);
4095                   if eof then call execute('; quit;');
4096                run;
4097                %rcSet(&syserr);
4098       
4099          %end; /* okay - remove foreign keys  */
4100       
4101          proc datasets lib = work nolist nowarn memtype = (data view);
4102             delete etls_commands etls_commands_F;
4103          quit;
4104       
4105          /*---- Drop a table  ----*/
4106          %put %str(NOTE: Dropping table ...);
4107          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
4108             delete "RWP_TFCACTDETID"n;
4109          quit;
4110       
4111          %rcSet(&syserr);
4112       
4113          %let etls_tableExist = 0;
4114       
4115       %end; /* table exists  */
4116       
4117       /*---- Create a new table  ----*/
4118       %if (&etls_tableExist eq 0) %then
4119       %do;  /* if table does not exist  */
4120       
4121          %put %str(NOTE: Creating table ...);
4122       
4123          data PODSLIB1."RWP_TFCACTDETID"n
4124                  (COMPRESS = YES);
4125             attrib "FCACTDETID"n length = $2
4126                format = $2.
4127                label = 'Account Determination ID for Contract Accounts';
4128             attrib "LANGU"n length = $1
4129                format = $1.
134                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4130                label = 'Language Key';
4131             attrib "TXTLG"n length = $60
4132                format = $60.
4133                label = 'Long description';
4134             call missing(of _all_);
4135             stop;
4136          run;
4137       
4138          %rcSet(&syserr);
4139       
4140       %end;  /* if table does not exist  */
4141       
4142       /*---- Append  ----*/
4143       %put %str(NOTE: Appending data ...);
4144       
4145       proc append base = PODSLIB1."RWP_TFCACTDETID"n(COMPRESS = YES)
4146          data = &etls_lastTable (&etls_tableOptions)  force ;
4147        run;
4148       
4149       %rcSet(&syserr);
4150       
4151       %mend etls_loader;
4152       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TFCACTDETID"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TFCACTDETID"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
135                                                        The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TFCACTDETID"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
136                                                        The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TFCACTDETID"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TFCACTDETID (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.05 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TFCACTDETID"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "FCACTDETID"n length = $2 format = $2. label = 'Account Determination ID for Contract Accounts';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TFCACTDETID has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TFCACTDETID"n(COMPRESS = YES) data = SAPRWP.'/BI0/TFCACTDETID'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TFCACTDETID'n to PODSLIB1.RWP_TFCACTDETID.
NOTE: There were 45 observations read from the data set SAPRWP.'/BI0/TFCACTDETID'n.
NOTE: 45 observations added.
NOTE: The data set PODSLIB1.RWP_TFCACTDETID has 45 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TFCACTDETID decreased size by 36.12 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.84 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
4153       
4154       %let etls_recCheckExist = 0;
4155       %let etls_recnt = 0;
4156       %macro etls_recordCheck;
4157          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TFCACTDETID"n, DATA)) or
4158                %sysfunc(exist(PODSLIB1."RWP_TFCACTDETID"n, VIEW)));
4159       
4160          %if (&etls_recCheckExist) %then
4161          %do;
4162             %local etls_syntaxcheck;
137                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4163             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
4164             /* Turn off syntaxcheck option to perform following steps  */
4165             options nosyntaxcheck;
4166       
4167             proc contents data = PODSLIB1."RWP_TFCACTDETID"n out = work.etls_contents(keep = nobs) noprint;
4168             run;
4169       
4170             data _null_;
4171                set work.etls_contents (obs = 1);
4172                call symput("etls_recnt", left(put(nobs,32.)));
4173             run;
4174       
4175             proc datasets lib = work nolist nowarn memtype = (data view);
4176                delete etls_contents;
4177             quit;
4178       
4179             /* Reset syntaxcheck option to previous setting  */
4180             options &etls_syntaxcheck;
4181          %end;
4182       %mend etls_recordCheck;
4183       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TFCACTDETID"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
4184       
4185       
4186       
4187       /** Step end Table Loader **/
4188       
138                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4189       /*==========================================================================*
4190        * Step:            Table Loader                          A57BXQB4.BV00013I *
4191        * Transform:       Table Loader (Version 2.1)                              *
4192        * Description:                                                             *
4193        *                                                                          *
4194        * Source Table:    _BI0_TCITY_CODE - -                   A57BXQB4.BE0001TT *
4195        *                   SAPrwp."/BI0/TCITY_CODE"n                              *
4196        * Target Table:    RWP_TCITY_CODE -                      A57BXQB4.BE0001TU *
4197        *                   PODSLIB1."RWP_TCITY_CODE"n                             *
4198        *==========================================================================*/
4199       
4200       %let transformID = %quote(A57BXQB4.BV00013I);
4201       %let trans_rc = 0;
4202       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
4203       
4204       %let SYSLAST = %nrquote(SAPrwp."/BI0/TCITY_CODE"n);
4205       
4206       %global etls_sql_pushDown;
4207       %let etls_sql_pushDown = -1;
4208       option DBIDIRECTEXEC;
4209       
4210       %global etls_tableExist;
4211       %global etls_numIndex;
4212       %global etls_lastTable;
4213       %let etls_tableExist = -1;
4214       %let etls_numIndex = -1;
4215       %let etls_lastTable = &SYSLAST;
4216       
4217       /*---- Define load data macro  ----*/
4218       
4219       /* --------------------------------------------------------------
4220          Load Technique Selection: Replace - EntireTable
4221          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
4222          Additional options selections...
4223             Set unmapped to missing on updates: false
4224          -------------------------------------------------------------- */
4225       %macro etls_loader;
4226       
4227          %let etls_tableOptions = ;
4228       
4229          /* Determine if the target table exists  */
4230          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCITY_CODE"n, DATA)) or
4231                %sysfunc(exist(PODSLIB1."RWP_TCITY_CODE"n, VIEW)));
4232       
4233          %if &etls_tableExist %then
4234          %do;/* table exists  */
4235             %let etls_hasPreExistingConstraint=0;
4236       
4237             proc datasets lib = work nolist nowarn memtype = (data view);
4238                delete etls_commands etls_commands_F;
4239             quit;
4240       
4241             %let etls_otherTablesReferToThisTable=0;
4242       
4243             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
4244                %put NOTE: Building table listing Constraints and Indexes for: &table;
4245                proc datasets lib=work nolist; delete &workTableOut; quit;
4246                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
139                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4247       
4248                data &workTableOut;
4249                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
4250                   name = '';
4251                   type = '';
4252                   icown = '';
4253                   idxUnique = '';
4254                   idxNoMiss = '';
4255                   recreate = '';
4256                   set &workTableOut;
4257                   ref = '';
4258                   type=upcase(type);
4259                   if type eq 'REFERENTIAL' then
4260                   do;
4261                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
4262                           " another table: " ref;
4263                      call symput('etls_otherTablesReferToThisTable','1');
4264                      delete;
4265                   end;
4266                   if type='INDEX' and ICOwn eq 'YES' then delete;
4267                run;
4268                %rcSet(&syserr);
4269       
4270             %mend etls_CIContents;
4271       
4272             %etls_CIContents(table=PODSLIB1."RWP_TCITY_CODE"n, workTableOut=etls_commands, inDSOptions=);
4273       
4274             %if &etls_otherTablesReferToThisTable %then
4275                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
4275     ! constraints.;
4276             %else
4277             %do; /* okay - remove foreign keys  */
4278       
4279                data etls_commands_F;
4280                   set etls_commands;
4281                   if upcase(type)="FOREIGN KEY" then
4282                   do;
4283                      command='ic delete '||trim(name)||';';
4284                      output etls_commands_F;
4285                   end;
4286                run;
4287       
4288                %put %str(NOTE: Removing foreign keys before dropping table...);
4289                data _null_;
4290                   set etls_commands_F end=eof;
4291                   if _n_=1 then
4292                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCITY_CODE"n;');
4293                   call execute(command);
4294                   if eof then call execute('; quit;');
4295                run;
4296                %rcSet(&syserr);
4297       
4298          %end; /* okay - remove foreign keys  */
4299       
4300          proc datasets lib = work nolist nowarn memtype = (data view);
4301             delete etls_commands etls_commands_F;
4302          quit;
4303       
140                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4304          /*---- Drop a table  ----*/
4305          %put %str(NOTE: Dropping table ...);
4306          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
4307             delete "RWP_TCITY_CODE"n;
4308          quit;
4309       
4310          %rcSet(&syserr);
4311       
4312          %let etls_tableExist = 0;
4313       
4314       %end; /* table exists  */
4315       
4316       /*---- Create a new table  ----*/
4317       %if (&etls_tableExist eq 0) %then
4318       %do;  /* if table does not exist  */
4319       
4320          %put %str(NOTE: Creating table ...);
4321       
4322          data PODSLIB1."RWP_TCITY_CODE"n
4323                  (COMPRESS = YES);
4324             attrib "COUNTRY"n length = $3
4325                format = $3.
4326                label = 'Country Key';
4327             attrib "CITY_CODE"n length = $12
4328                format = $12.
4329                label = 'BAS: City Code';
4330             attrib "LANGU"n length = $1
4331                format = $1.
4332                label = 'Language Key';
4333             attrib "TXTMD"n length = $40
4334                format = $40.
4335                label = 'Medium description';
4336             call missing(of _all_);
4337             stop;
4338          run;
4339       
4340          %rcSet(&syserr);
4341       
4342       %end;  /* if table does not exist  */
4343       
4344       /*---- Append  ----*/
4345       %put %str(NOTE: Appending data ...);
4346       
4347       proc append base = PODSLIB1."RWP_TCITY_CODE"n(COMPRESS = YES)
4348          data = &etls_lastTable (&etls_tableOptions)  force ;
4349        run;
4350       
4351       %rcSet(&syserr);
4352       
4353       %mend etls_loader;
4354       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
141                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TCITY_CODE"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TCITY_CODE"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

142                                                        The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TCITY_CODE"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TCITY_CODE"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TCITY_CODE (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TCITY_CODE"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "COUNTRY"n length = $3 format = $3. label = 'Country Key';
MPRINT(ETLS_LOADER):   attrib "CITY_CODE"n length = $12 format = $12. label = 'BAS: City Code';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTMD"n length = $40 format = $40. label = 'Medium description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TCITY_CODE has 0 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
143                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TCITY_CODE"n(COMPRESS = YES) data = SAPRWP.'/BI0/TCITY_CODE'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TCITY_CODE'n to PODSLIB1.RWP_TCITY_CODE.
NOTE: There were 4748 observations read from the data set SAPRWP.'/BI0/TCITY_CODE'n.
NOTE: 4748 observations added.
NOTE: The data set PODSLIB1.RWP_TCITY_CODE has 4748 observations and 4 variables.
NOTE: Compressing data set PODSLIB1.RWP_TCITY_CODE decreased size by 61.86 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.52 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
4355       
4356       %let etls_recCheckExist = 0;
4357       %let etls_recnt = 0;
4358       %macro etls_recordCheck;
4359          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TCITY_CODE"n, DATA)) or
4360                %sysfunc(exist(PODSLIB1."RWP_TCITY_CODE"n, VIEW)));
4361       
4362          %if (&etls_recCheckExist) %then
4363          %do;
4364             %local etls_syntaxcheck;
4365             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
4366             /* Turn off syntaxcheck option to perform following steps  */
4367             options nosyntaxcheck;
4368       
4369             proc contents data = PODSLIB1."RWP_TCITY_CODE"n out = work.etls_contents(keep = nobs) noprint;
4370             run;
4371       
4372             data _null_;
4373                set work.etls_contents (obs = 1);
4374                call symput("etls_recnt", left(put(nobs,32.)));
4375             run;
4376       
4377             proc datasets lib = work nolist nowarn memtype = (data view);
4378                delete etls_contents;
4379             quit;
4380       
4381             /* Reset syntaxcheck option to previous setting  */
4382             options &etls_syntaxcheck;
4383          %end;
4384       %mend etls_recordCheck;
4385       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TCITY_CODE"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 4 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
144                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
4386       
4387       
4388       
4389       /** Step end Table Loader **/
4390       
4391       /*==========================================================================*
4392        * Step:            Table Loader                          A57BXQB4.BV00013J *
4393        * Transform:       Table Loader (Version 2.1)                              *
4394        * Description:                                                             *
4395        *                                                                          *
4396        * Source Table:    _BI0_TREGION - -                      A57BXQB4.BE0001TV *
4397        *                   SAPrwp."/BI0/TREGION"n                                 *
4398        * Target Table:    RWP_TREGION - PODSLIB1."RWP_TREGION"n A57BXQB4.BE0001TW *
4399        *==========================================================================*/
4400       
4401       %let transformID = %quote(A57BXQB4.BV00013J);
4402       %let trans_rc = 0;
4403       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
4404       
4405       %let SYSLAST = %nrquote(SAPrwp."/BI0/TREGION"n);
4406       
4407       %global etls_sql_pushDown;
4408       %let etls_sql_pushDown = -1;
4409       option DBIDIRECTEXEC;
4410       
4411       %global etls_tableExist;
4412       %global etls_numIndex;
4413       %global etls_lastTable;
4414       %let etls_tableExist = -1;
4415       %let etls_numIndex = -1;
4416       %let etls_lastTable = &SYSLAST;
4417       
4418       /*---- Define load data macro  ----*/
4419       
145                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4420       /* --------------------------------------------------------------
4421          Load Technique Selection: Replace - EntireTable
4422          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
4423          Additional options selections...
4424             Set unmapped to missing on updates: false
4425          -------------------------------------------------------------- */
4426       %macro etls_loader;
4427       
4428          %let etls_tableOptions = ;
4429       
4430          /* Determine if the target table exists  */
4431          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TREGION"n, DATA)) or
4432                %sysfunc(exist(PODSLIB1."RWP_TREGION"n, VIEW)));
4433       
4434          %if &etls_tableExist %then
4435          %do;/* table exists  */
4436             %let etls_hasPreExistingConstraint=0;
4437       
4438             proc datasets lib = work nolist nowarn memtype = (data view);
4439                delete etls_commands etls_commands_F;
4440             quit;
4441       
4442             %let etls_otherTablesReferToThisTable=0;
4443       
4444             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
4445                %put NOTE: Building table listing Constraints and Indexes for: &table;
4446                proc datasets lib=work nolist; delete &workTableOut; quit;
4447                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
4448       
4449                data &workTableOut;
4450                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
4451                   name = '';
4452                   type = '';
4453                   icown = '';
4454                   idxUnique = '';
4455                   idxNoMiss = '';
4456                   recreate = '';
4457                   set &workTableOut;
4458                   ref = '';
4459                   type=upcase(type);
4460                   if type eq 'REFERENTIAL' then
4461                   do;
4462                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
4463                           " another table: " ref;
4464                      call symput('etls_otherTablesReferToThisTable','1');
4465                      delete;
4466                   end;
4467                   if type='INDEX' and ICOwn eq 'YES' then delete;
4468                run;
4469                %rcSet(&syserr);
4470       
4471             %mend etls_CIContents;
4472       
4473             %etls_CIContents(table=PODSLIB1."RWP_TREGION"n, workTableOut=etls_commands, inDSOptions=);
4474       
4475             %if &etls_otherTablesReferToThisTable %then
4476                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
4476     ! constraints.;
146                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4477             %else
4478             %do; /* okay - remove foreign keys  */
4479       
4480                data etls_commands_F;
4481                   set etls_commands;
4482                   if upcase(type)="FOREIGN KEY" then
4483                   do;
4484                      command='ic delete '||trim(name)||';';
4485                      output etls_commands_F;
4486                   end;
4487                run;
4488       
4489                %put %str(NOTE: Removing foreign keys before dropping table...);
4490                data _null_;
4491                   set etls_commands_F end=eof;
4492                   if _n_=1 then
4493                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TREGION"n;');
4494                   call execute(command);
4495                   if eof then call execute('; quit;');
4496                run;
4497                %rcSet(&syserr);
4498       
4499          %end; /* okay - remove foreign keys  */
4500       
4501          proc datasets lib = work nolist nowarn memtype = (data view);
4502             delete etls_commands etls_commands_F;
4503          quit;
4504       
4505          /*---- Drop a table  ----*/
4506          %put %str(NOTE: Dropping table ...);
4507          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
4508             delete "RWP_TREGION"n;
4509          quit;
4510       
4511          %rcSet(&syserr);
4512       
4513          %let etls_tableExist = 0;
4514       
4515       %end; /* table exists  */
4516       
4517       /*---- Create a new table  ----*/
4518       %if (&etls_tableExist eq 0) %then
4519       %do;  /* if table does not exist  */
4520       
4521          %put %str(NOTE: Creating table ...);
4522       
4523          data PODSLIB1."RWP_TREGION"n
4524                  (COMPRESS = YES);
4525             attrib "COUNTRY"n length = $3
4526                format = $3.
4527                label = 'Country Key';
4528             attrib "REGION"n length = $3
4529                format = $3.
4530                label = 'Region (State, Province, County)';
4531             attrib "LANGU"n length = $1
4532                format = $1.
4533                label = 'Language Key';
4534             attrib "TXTSH"n length = $20
147                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4535                format = $20.
4536                label = 'Short description';
4537             call missing(of _all_);
4538             stop;
4539          run;
4540       
4541          %rcSet(&syserr);
4542       
4543       %end;  /* if table does not exist  */
4544       
4545       /*---- Append  ----*/
4546       %put %str(NOTE: Appending data ...);
4547       
4548       proc append base = PODSLIB1."RWP_TREGION"n(COMPRESS = YES)
4549          data = &etls_lastTable (&etls_tableOptions)  force ;
4550        run;
4551       
4552       %rcSet(&syserr);
4553       
4554       %mend etls_loader;
4555       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TREGION"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;

NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TREGION"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
148                                                        The SAS System                          09:30 Wednesday, December 2, 2020

MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TREGION"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
149                                                        The SAS System                          09:30 Wednesday, December 2, 2020

      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TREGION"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TREGION (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TREGION"n (COMPRESS = YES);
MPRINT(ETLS_LOADER):   attrib "COUNTRY"n length = $3 format = $3. label = 'Country Key';
MPRINT(ETLS_LOADER):   attrib "REGION"n length = $3 format = $3. label = 'Region (State, Province, County)';
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTSH"n length = $20 format = $20. label = 'Short description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TREGION has 0 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TREGION"n(COMPRESS = YES) data = SAPRWP.'/BI0/TREGION'n () force ;
MPRINT(ETLS_LOADER):   run;

NOTE: Appending SAPRWP.'/BI0/TREGION'n to PODSLIB1.RWP_TREGION.
NOTE: There were 4755 observations read from the data set SAPRWP.'/BI0/TREGION'n.
NOTE: 4755 observations added.
NOTE: The data set PODSLIB1.RWP_TREGION has 4755 observations and 4 variables.
NOTE: Compressing data set PODSLIB1.RWP_TREGION decreased size by 30.95 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.79 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_LOADER):  ;
4556       
4557       %let etls_recCheckExist = 0;
4558       %let etls_recnt = 0;
4559       %macro etls_recordCheck;
4560          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TREGION"n, DATA)) or
4561                %sysfunc(exist(PODSLIB1."RWP_TREGION"n, VIEW)));
4562       
4563          %if (&etls_recCheckExist) %then
4564          %do;
4565             %local etls_syntaxcheck;
4566             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
150                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4567             /* Turn off syntaxcheck option to perform following steps  */
4568             options nosyntaxcheck;
4569       
4570             proc contents data = PODSLIB1."RWP_TREGION"n out = work.etls_contents(keep = nobs) noprint;
4571             run;
4572       
4573             data _null_;
4574                set work.etls_contents (obs = 1);
4575                call symput("etls_recnt", left(put(nobs,32.)));
4576             run;
4577       
4578             proc datasets lib = work nolist nowarn memtype = (data view);
4579                delete etls_contents;
4580             quit;
4581       
4582             /* Reset syntaxcheck option to previous setting  */
4583             options &etls_syntaxcheck;
4584          %end;
4585       %mend etls_recordCheck;
4586       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TREGION"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 4 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
4587       
4588       
4589       
4590       /** Step end Table Loader **/
4591       
4592       /*==========================================================================*
151                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4593        * Step:            Table Loader                          A57BXQB4.BV00013K *
4594        * Transform:       Table Loader (Version 2.1)                              *
4595        * Description:                                                             *
4596        *                                                                          *
4597        * Source Table:    _BIC_TZYAKINLIK - -                   A57BXQB4.BE0001TX *
4598        *                   SAPrwp."/BIC/TZYAKINLIK"n                              *
4599        * Target Table:    RWP_TZYAKINLIK -                      A57BXQB4.BE0001TY *
4600        *                   PODSLIB1."RWP_TZYAKINLIK"n                             *
4601        *==========================================================================*/
4602       
4603       %let transformID = %quote(A57BXQB4.BV00013K);
4604       %let trans_rc = 0;
4605       %let etls_stepStartTime = %sysfunc(datetime(), datetime20.);
4606       
4607       %let SYSLAST = %nrquote(SAPrwp."/BIC/TZYAKINLIK"n);
4608       
4609       %global etls_sql_pushDown;
4610       %let etls_sql_pushDown = -1;
4611       option DBIDIRECTEXEC;
4612       
4613       %global etls_tableExist;
4614       %global etls_numIndex;
4615       %global etls_lastTable;
4616       %let etls_tableExist = -1;
4617       %let etls_numIndex = -1;
4618       %let etls_lastTable = &SYSLAST;
4619       
4620       /*---- Define load data macro  ----*/
4621       
4622       /* --------------------------------------------------------------
4623          Load Technique Selection: Replace - EntireTable
4624          Constraint and index action selections: 'ASIS','ASIS','ASIS','ASIS'
4625          Additional options selections...
4626             Set unmapped to missing on updates: false
4627          -------------------------------------------------------------- */
4628       %macro etls_loader;
4629       
4630          %let etls_tableOptions = ;
4631       
4632          /* Determine if the target table exists  */
4633          %let etls_tableExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZYAKINLIK"n, DATA)) or
4634                %sysfunc(exist(PODSLIB1."RWP_TZYAKINLIK"n, VIEW)));
4635       
4636          %if &etls_tableExist %then
4637          %do;/* table exists  */
4638             %let etls_hasPreExistingConstraint=0;
4639       
4640             proc datasets lib = work nolist nowarn memtype = (data view);
4641                delete etls_commands etls_commands_F;
4642             quit;
4643       
4644             %let etls_otherTablesReferToThisTable=0;
4645       
4646             %macro etls_CIContents(table=,workTableOut=,inDSOptions=);
4647                %put NOTE: Building table listing Constraints and Indexes for: &table;
4648                proc datasets lib=work nolist; delete &workTableOut; quit;
4649                proc contents data=&table&inDSOptions out2=&workTableOut noprint; run;
4650       
152                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4651                data &workTableOut;
4652                   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
4653                   name = '';
4654                   type = '';
4655                   icown = '';
4656                   idxUnique = '';
4657                   idxNoMiss = '';
4658                   recreate = '';
4659                   set &workTableOut;
4660                   ref = '';
4661                   type=upcase(type);
4662                   if type eq 'REFERENTIAL' then
4663                   do;
4664                      put "WARNING%QUOTE(:) Target table is referenced by constraints in"
4665                           " another table: " ref;
4666                      call symput('etls_otherTablesReferToThisTable','1');
4667                      delete;
4668                   end;
4669                   if type='INDEX' and ICOwn eq 'YES' then delete;
4670                run;
4671                %rcSet(&syserr);
4672       
4673             %mend etls_CIContents;
4674       
4675             %etls_CIContents(table=PODSLIB1."RWP_TZYAKINLIK"n, workTableOut=etls_commands, inDSOptions=);
4676       
4677             %if &etls_otherTablesReferToThisTable %then
4678                %put WARNING%QUOTE(:) Replacing entire table will fail. Consider an alternate load technique or revising
4678     ! constraints.;
4679             %else
4680             %do; /* okay - remove foreign keys  */
4681       
4682                data etls_commands_F;
4683                   set etls_commands;
4684                   if upcase(type)="FOREIGN KEY" then
4685                   do;
4686                      command='ic delete '||trim(name)||';';
4687                      output etls_commands_F;
4688                   end;
4689                run;
4690       
4691                %put %str(NOTE: Removing foreign keys before dropping table...);
4692                data _null_;
4693                   set etls_commands_F end=eof;
4694                   if _n_=1 then
4695                      call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZYAKINLIK"n;');
4696                   call execute(command);
4697                   if eof then call execute('; quit;');
4698                run;
4699                %rcSet(&syserr);
4700       
4701          %end; /* okay - remove foreign keys  */
4702       
4703          proc datasets lib = work nolist nowarn memtype = (data view);
4704             delete etls_commands etls_commands_F;
4705          quit;
4706       
4707          /*---- Drop a table  ----*/
153                                                        The SAS System                          09:30 Wednesday, December 2, 2020

4708          %put %str(NOTE: Dropping table ...);
4709          proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
4710             delete "RWP_TZYAKINLIK"n;
4711          quit;
4712       
4713          %rcSet(&syserr);
4714       
4715          %let etls_tableExist = 0;
4716       
4717       %end; /* table exists  */
4718       
4719       /*---- Create a new table  ----*/
4720       %if (&etls_tableExist eq 0) %then
4721       %do;  /* if table does not exist  */
4722       
4723          %put %str(NOTE: Creating table ...);
4724       
4725          data PODSLIB1."RWP_TZYAKINLIK"n;
4726             attrib "_BIC_ZYAKINLIK"n length = $2
4727                format = $2.;
4728             attrib "LANGU"n length = $1
4729                format = $1.
4730                label = 'Language Key';
4731             attrib "TXTLG"n length = $60
4732                format = $60.
4733                label = 'Long description';
4734             call missing(of _all_);
4735             stop;
4736          run;
4737       
4738          %rcSet(&syserr);
4739       
4740       %end;  /* if table does not exist  */
4741       
4742       /*---- Append  ----*/
4743       %put %str(NOTE: Appending data ...);
4744       
4745       proc append base = PODSLIB1."RWP_TZYAKINLIK"n
4746          data = &etls_lastTable (&etls_tableOptions)  force ;
4747        run;
4748       
4749       %rcSet(&syserr);
4750       
4751       %mend etls_loader;
4752       %etls_loader;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Building table listing Constraints and Indexes for: PODSLIB1."RWP_TZYAKINLIK"n
MPRINT(ETLS_CICONTENTS):   proc datasets lib=work nolist;
MPRINT(ETLS_CICONTENTS):   delete etls_commands;
MPRINT(ETLS_CICONTENTS):   quit;
154                                                        The SAS System                          09:30 Wednesday, December 2, 2020


NOTE: The file WORK.ETLS_COMMANDS (memtype=DATA) was not found, but appears on a DELETE statement.
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_CICONTENTS):   proc contents data=PODSLIB1."RWP_TZYAKINLIK"n out2=etls_commands noprint;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 0 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):   data etls_commands;
MPRINT(ETLS_CICONTENTS):   length name $60 type $20 icown idxUnique idxNoMiss $3 recreate $600;
MPRINT(ETLS_CICONTENTS):   name = '';
MPRINT(ETLS_CICONTENTS):   type = '';
MPRINT(ETLS_CICONTENTS):   icown = '';
MPRINT(ETLS_CICONTENTS):   idxUnique = '';
MPRINT(ETLS_CICONTENTS):   idxNoMiss = '';
MPRINT(ETLS_CICONTENTS):   recreate = '';
MPRINT(ETLS_CICONTENTS):   set etls_commands;
MPRINT(ETLS_CICONTENTS):   ref = '';
MPRINT(ETLS_CICONTENTS):   type=upcase(type);
MPRINT(ETLS_CICONTENTS):   if type eq 'REFERENTIAL' then do;
MPRINT(ETLS_CICONTENTS):   put "WARNING: Target table is referenced by constraints in" " another table: " ref;
MPRINT(ETLS_CICONTENTS):   call symput('etls_otherTablesReferToThisTable','1');
MPRINT(ETLS_CICONTENTS):   delete;
MPRINT(ETLS_CICONTENTS):   end;
MPRINT(ETLS_CICONTENTS):   if type='INDEX' and ICOwn eq 'YES' then delete;
MPRINT(ETLS_CICONTENTS):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS has 0 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_CICONTENTS):  ;
MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   data etls_commands_F;
MPRINT(ETLS_LOADER):   set etls_commands;
MPRINT(ETLS_LOADER):   if upcase(type)="FOREIGN KEY" then do;
MPRINT(ETLS_LOADER):   command='ic delete '||trim(name)||';';
MPRINT(ETLS_LOADER):   output etls_commands_F;
MPRINT(ETLS_LOADER):   end;
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS.
NOTE: The data set WORK.ETLS_COMMANDS_F has 0 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
155                                                        The SAS System                          09:30 Wednesday, December 2, 2020


NOTE: Removing foreign keys before dropping table...
MPRINT(ETLS_LOADER):   data _null_;
MPRINT(ETLS_LOADER):   set etls_commands_F end=eof;
MPRINT(ETLS_LOADER):   if _n_=1 then call execute('proc datasets nolist lib=PODSLIB1;modify "RWP_TZYAKINLIK"n;');
MPRINT(ETLS_LOADER):   call execute(command);
MPRINT(ETLS_LOADER):   if eof then call execute('; quit;');
MPRINT(ETLS_LOADER):   run;

NOTE: There were 0 observations read from the data set WORK.ETLS_COMMANDS_F.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
MPRINT(ETLS_LOADER):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete etls_commands etls_commands_F;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting WORK.ETLS_COMMANDS (memtype=DATA).
NOTE: Deleting WORK.ETLS_COMMANDS_F (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Dropping table ...
MPRINT(ETLS_LOADER):   proc datasets lib = PODSLIB1 nolist nowarn memtype = (data view);
MPRINT(ETLS_LOADER):   delete "RWP_TZYAKINLIK"n;
MPRINT(ETLS_LOADER):   quit;

NOTE: Deleting PODSLIB1.RWP_TZYAKINLIK (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Creating table ...
MPRINT(ETLS_LOADER):   data PODSLIB1."RWP_TZYAKINLIK"n;
MPRINT(ETLS_LOADER):   attrib "_BIC_ZYAKINLIK"n length = $2 format = $2.;
MPRINT(ETLS_LOADER):   attrib "LANGU"n length = $1 format = $1. label = 'Language Key';
MPRINT(ETLS_LOADER):   attrib "TXTLG"n length = $60 format = $60. label = 'Long description';
MPRINT(ETLS_LOADER):   call missing(of _all_);
MPRINT(ETLS_LOADER):   stop;
MPRINT(ETLS_LOADER):   run;

NOTE: The data set PODSLIB1.RWP_TZYAKINLIK has 0 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
NOTE: Appending data ...
MPRINT(ETLS_LOADER):   proc append base = PODSLIB1."RWP_TZYAKINLIK"n data = SAPRWP.'/BIC/TZYAKINLIK'n () force ;
MPRINT(ETLS_LOADER):   run;
156                                                        The SAS System                          09:30 Wednesday, December 2, 2020


NOTE: Appending SAPRWP.'/BIC/TZYAKINLIK'n to PODSLIB1.RWP_TZYAKINLIK.
NOTE: There were 12 observations read from the data set SAPRWP.'/BIC/TZYAKINLIK'n.
NOTE: 12 observations added.
NOTE: The data set PODSLIB1.RWP_TZYAKINLIK has 12 observations and 3 variables.
NOTE: Compressing data set PODSLIB1.RWP_TZYAKINLIK decreased size by 68.65 percent.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.87 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_LOADER):  ;
4753       
4754       %let etls_recCheckExist = 0;
4755       %let etls_recnt = 0;
4756       %macro etls_recordCheck;
4757          %let etls_recCheckExist = %eval(%sysfunc(exist(PODSLIB1."RWP_TZYAKINLIK"n, DATA)) or
4758                %sysfunc(exist(PODSLIB1."RWP_TZYAKINLIK"n, VIEW)));
4759       
4760          %if (&etls_recCheckExist) %then
4761          %do;
4762             %local etls_syntaxcheck;
4763             %let etls_syntaxcheck = %sysfunc(getoption(syntaxcheck));
4764             /* Turn off syntaxcheck option to perform following steps  */
4765             options nosyntaxcheck;
4766       
4767             proc contents data = PODSLIB1."RWP_TZYAKINLIK"n out = work.etls_contents(keep = nobs) noprint;
4768             run;
4769       
4770             data _null_;
4771                set work.etls_contents (obs = 1);
4772                call symput("etls_recnt", left(put(nobs,32.)));
4773             run;
4774       
4775             proc datasets lib = work nolist nowarn memtype = (data view);
4776                delete etls_contents;
4777             quit;
4778       
4779             /* Reset syntaxcheck option to previous setting  */
4780             options &etls_syntaxcheck;
4781          %end;
4782       %mend etls_recordCheck;
4783       %etls_recordCheck;
MPRINT(ETLS_RECORDCHECK):   options nosyntaxcheck;
MPRINT(ETLS_RECORDCHECK):   proc contents data = PODSLIB1."RWP_TZYAKINLIK"n out = work.etls_contents(keep = nobs) noprint;
MPRINT(ETLS_RECORDCHECK):   run;

NOTE: The data set WORK.ETLS_CONTENTS has 3 observations and 1 variables.
NOTE: PROCEDURE CONTENTS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   data _null_;
MPRINT(ETLS_RECORDCHECK):   set work.etls_contents (obs = 1);
MPRINT(ETLS_RECORDCHECK):   call symput("etls_recnt", left(put(nobs,32.)));
MPRINT(ETLS_RECORDCHECK):   run;

157                                                        The SAS System                          09:30 Wednesday, December 2, 2020

NOTE: There were 1 observations read from the data set WORK.ETLS_CONTENTS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

MPRINT(ETLS_RECORDCHECK):   proc datasets lib = work nolist nowarn memtype = (data view);
MPRINT(ETLS_RECORDCHECK):   delete etls_contents;
MPRINT(ETLS_RECORDCHECK):   quit;

NOTE: Deleting WORK.ETLS_CONTENTS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

MPRINT(ETLS_RECORDCHECK):   options SYNTAXCHECK;
4784       
4785       
4786       
4787       /** Step end Table Loader **/
4788       
4789       %let etls_endTime = %sysfunc(datetime(),datetime.);
4790       

ERROR: Errors printed on page 6.

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           9:41.41
      cpu time            1:07.20
      


